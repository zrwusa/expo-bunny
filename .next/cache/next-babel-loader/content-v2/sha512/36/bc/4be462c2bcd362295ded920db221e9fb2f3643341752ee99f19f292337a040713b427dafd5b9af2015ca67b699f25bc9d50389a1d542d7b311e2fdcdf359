{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import*as React from'react';import{useEffect,useRef}from'react';import{Text,View}from\"../UI\";import{Card,Col,Row}from\"../../containers\";import{useBunnyKit}from\"../../hooks/bunny-kit\";import{makeStyles}from\"./styles\";import{AbstractGraph,BinaryTree,BinaryTreeNode,Coordinate,DirectedGraph,getDirectionVector,SinglyLinkedListNode,Stack,UndirectedGraph,uuidV4}from\"../../utils\";import{TreeNode}from\"../../types\";import Svg,{Circle,Defs,G,Line,Marker,Path,Rect,Text as SVGText,TSpan}from'react-native-svg';import ScrollView from\"react-native-web/dist/exports/ScrollView\";export var VividAlgorithm=function VividAlgorithm(props){var data=props.data,referenceData=props.referenceData,relatedNodeKey=props.relatedNodeKey,relatedRouteKey=props.relatedRouteKey,_props$isDebug=props.isDebug,isDebug=_props$isDebug===void 0?false:_props$isDebug;var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp,colors=_useBunnyKit.colors,ms=_useBunnyKit.ms;var styles=makeStyles(sizeLabor,themeLabor);var relatedNode;var relatedBinaryNode;var relatedMatrixCell;if(relatedNodeKey){relatedNode=data==null?void 0:data[relatedNodeKey];relatedBinaryNode=data==null?void 0:data[relatedNodeKey];relatedMatrixCell=data==null?void 0:data[relatedNodeKey];}var relatedMatrixRoutes;if(relatedRouteKey){relatedMatrixRoutes=data==null?void 0:data[relatedRouteKey];}var VividNumber=function VividNumber(_ref){var data=_ref.data;return React.createElement(Row,null,React.createElement(Col,{size:6},React.createElement(Text,null,data.toString())));};var getPointsByDelta=function getPointsByDelta(src,dest,cutDelta){if(cutDelta===undefined)cutDelta=0;var PI=Math.PI;var angle=Math.atan2(dest.y-src.y,dest.x-src.x);var theta=angle*(180/Math.PI);var newSrc=new Coordinate(src.y,src.x);var newDest=new Coordinate(dest.y,dest.x);if(angle<=0.5*PI){newSrc.x=src.x+Math.cos(angle)*cutDelta;newSrc.y=src.y+Math.sin(angle)*cutDelta;newDest.x=dest.x-Math.cos(angle)*cutDelta;newDest.y=dest.y-Math.sin(angle)*cutDelta;}else if(angle>0.5*PI&&angle<=PI){angle=PI-angle;newSrc.x=src.x-Math.cos(angle)*cutDelta;newSrc.y=src.y+Math.sin(angle)*cutDelta;newDest.x=dest.x+Math.cos(angle)*cutDelta;newDest.y=dest.y-Math.sin(angle)*cutDelta;}src=newSrc;dest=newDest;return{src:src,dest:dest};};var LineWithArrow=function LineWithArrow(_ref2){var from=_ref2.from,to=_ref2.to,weight=_ref2.weight,delta=_ref2.delta;if(delta===undefined)delta=0;var _getPointsByDelta=getPointsByDelta(from,to,delta),src=_getPointsByDelta.src,dest=_getPointsByDelta.dest;return React.createElement(G,null,React.createElement(Defs,null,React.createElement(Marker,{id:\"Triangle\",viewBox:\"0 0 10 10\",refX:\"0\",refY:\"5\",markerWidth:\"4\",markerHeight:\"3\",orient:\"auto\"},React.createElement(Path,{d:\"M 0 0 L 10 5 L 0 10 z\",fill:arrowColor,stroke:arrowColor}))),React.createElement(Path,{d:\"M \"+src.x+\" \"+src.y+\" L \"+dest.x+\" \"+dest.y,fill:arrowColor,stroke:arrowColor,strokeWidth:\"2\",markerEnd:\"url(#Triangle)\"}),weight!==undefined&&weight!==null?React.createElement(SVGText,{strokeWidth:wp(1),fontSize:ms.fs.xs,fill:colors.text,fontWeight:100,stroke:colors.text,x:src.x+(dest.x-src.x)/2+(src.x>dest.x?wp(10):wp(-10)),y:src.y+(dest.y-src.y)/2+(src.y>dest.y?wp(3):wp(-3)),textAnchor:\"middle\"},weight):null);};var VividString=function VividString(_ref3){var data=_ref3.data;return React.createElement(Row,null,React.createElement(Col,{size:6},React.createElement(Text,null,data)));};var TwoWayScrollSVG=function TwoWayScrollSVG(_ref4){var children=_ref4.children,autoScroll=_ref4.autoScroll;var horizontalScrollView=useRef(null);if(autoScroll){useEffect(function(){var _horizontalScrollView;horizontalScrollView==null?void 0:(_horizontalScrollView=horizontalScrollView.current)==null?void 0:_horizontalScrollView.scrollTo({x:(treePanelWidth-wp(375))/2,y:0,animated:false});},[]);}return React.createElement(ScrollView,{nestedScrollEnabled:true,style:{height:wp(375)}},React.createElement(ScrollView,{style:{width:wp(375)},horizontal:true,ref:horizontalScrollView},React.createElement(Svg,{width:treePanelWidth,height:treePanelHeight},React.createElement(G,{fill:colors.background,strokeWidth:strokeWidth,stroke:colors.border},children))));};var VividTree=function VividTree(_ref5){var data=_ref5.data;return React.createElement(TwoWayScrollSVG,{autoScroll:true},React.createElement(VividTreeRecursive,{node:data,level:1,index:0,familyLength:1,parentX:0,parentY:0,maxHeight:data.getHeight()}));};var VividBinaryTree=function VividBinaryTree(_ref6){var node=_ref6.node,maxHeight=_ref6.maxHeight;return React.createElement(TwoWayScrollSVG,{autoScroll:true},node?React.createElement(VividBinaryTreeRecursive,{node:node,level:1,index:0,familyLength:1,maxHeight:maxHeight}):null);};var VividGraph=function VividGraph(_ref7){var data=_ref7.data;return React.createElement(TwoWayScrollSVG,{autoScroll:false},data?React.createElement(VividGraphDrawer,{graph:data}):null);};var matrixPanelWidth=wp(360,false);var matrixRectStrokeWidth=wp(1,false);var arrowCut=0.3;var arrowColor=colors.accent;var VividMatrix=function VividMatrix(_ref8){var _data$;var data=_ref8.data;var rowCount=data==null?void 0:data.length;var colCount=data==null?void 0:(_data$=data[0])==null?void 0:_data$.length;if(colCount<1){return null;}var rectSize=(matrixPanelWidth-(colCount+1)*matrixRectStrokeWidth)/colCount;var matrixHeight=rectSize*rowCount;return React.createElement(Svg,{width:matrixPanelWidth,height:matrixHeight},React.createElement(G,null,data.map(function(row,i){return row.map(function(col,j){var _relatedMatrixCell,_relatedMatrixCell2;var colKey=i+'-'+j.toString();var isActive=((_relatedMatrixCell=relatedMatrixCell)==null?void 0:_relatedMatrixCell.y)===i&&((_relatedMatrixCell2=relatedMatrixCell)==null?void 0:_relatedMatrixCell2.x)===j;return React.createElement(Rect,{key:colKey,x:j*rectSize,y:i*rectSize,width:rectSize,height:rectSize,stroke:colors.border,strokeDasharray:rectSize+\",\"+rectSize*2+\",\"+rectSize,strokeWidth:matrixRectStrokeWidth,fill:isActive?colors.primary:colors.backgroundA});});}),data.map(function(row,i){var rowKey=i.toString();return row.map(function(col,j){var _relatedMatrixCell3,_relatedMatrixCell4;var colKey='text-'+i+'-'+j.toString();var isActive=((_relatedMatrixCell3=relatedMatrixCell)==null?void 0:_relatedMatrixCell3.y)===i&&((_relatedMatrixCell4=relatedMatrixCell)==null?void 0:_relatedMatrixCell4.x)===j;return React.createElement(SVGText,{key:colKey,strokeWidth:wp(1),fontSize:ms.fs.m,fill:isActive?colors.buttonText:colors.text,fontWeight:100,x:(j+0.5)*rectSize,y:(i+0.5)*rectSize,textAnchor:\"middle\"},data[i][j].toString());});}),relatedMatrixRoutes?relatedMatrixRoutes.map(function(route,routeIndex){return route.map(function(cell,cellIndex){var _relatedMatrixRoutes,_relatedMatrixRoutes$;var from=cell;var to=(_relatedMatrixRoutes=relatedMatrixRoutes)==null?void 0:(_relatedMatrixRoutes$=_relatedMatrixRoutes[routeIndex])==null?void 0:_relatedMatrixRoutes$[cellIndex+1];var deviationVector=getDirectionVector(from,to);if(from&&to){var src=new Coordinate((from.y+0.5+deviationVector.y*arrowCut)*rectSize,(from.x+0.5+deviationVector.x*arrowCut)*rectSize);var dest=new Coordinate((to.y+0.5-deviationVector.y*arrowCut)*rectSize,(to.x+0.5-deviationVector.x*arrowCut)*rectSize);return React.createElement(LineWithArrow,{key:src.y+','+src.x+dest.y+dest.x,from:src,to:dest});}else{return null;}});}):null));};var treePanelWidth=wp(20000);var treePanelHeight=wp(20000);var strokeWidth=wp(2);var levelOffset=wp(60);var circleR=wp(20);var nodeSpace=wp(40);var fontSize=wp(12);var fontOffsetY=fontSize/3;var VividTreeRecursive=function VividTreeRecursive(_ref9){var _relatedNode;var node=_ref9.node,_ref9$level=_ref9.level,level=_ref9$level===void 0?1:_ref9$level,_ref9$index=_ref9.index,index=_ref9$index===void 0?0:_ref9$index,_ref9$familyLength=_ref9.familyLength,familyLength=_ref9$familyLength===void 0?1:_ref9$familyLength,parentX=_ref9.parentX,parentY=_ref9.parentY,maxHeight=_ref9.maxHeight;if(!node){return null;}var space=0;var offsetX=0;var offsetY=0;var levelNodeSpace=nodeSpace*Math.pow(2,(maxHeight||5)-level);if(level===1){space=treePanelWidth/2;offsetX=space-circleR;offsetY=(level-1)*levelOffset+circleR+strokeWidth;}else{offsetX=parentX-familyLength/2*levelNodeSpace+(index+0.5)*levelNodeSpace;offsetY=(level-1)*levelOffset+circleR+strokeWidth;}var isActive=node.id===((_relatedNode=relatedNode)==null?void 0:_relatedNode.id);return React.createElement(G,{key:node.id},level>1?React.createElement(Line,{x1:parentX,y1:parentY,x2:offsetX,y2:offsetY}):null,node.children?node.children.map(function(child,index,family){return React.createElement(VividTreeRecursive,{key:child.id,node:child,level:level+1,index:index,familyLength:family.length,parentX:offsetX,parentY:offsetY,maxHeight:maxHeight});}):null,React.createElement(Circle,{r:circleR,cx:offsetX,cy:offsetY,fill:isActive?colors.primary:colors.background}),React.createElement(SVGText,{strokeWidth:wp(1),fill:isActive?colors.buttonText:colors.text,stroke:isActive?colors.buttonText:colors.text,fontSize:fontSize,fontWeight:100,x:offsetX,y:offsetY+fontOffsetY,textAnchor:\"middle\"},node.name||node.id));};var VividBinaryTreeRecursive=function VividBinaryTreeRecursive(_ref10){var _relatedBinaryNode;var node=_ref10.node,_ref10$level=_ref10.level,level=_ref10$level===void 0?1:_ref10$level,_ref10$index=_ref10.index,index=_ref10$index===void 0?0:_ref10$index,_ref10$familyLength=_ref10.familyLength,familyLength=_ref10$familyLength===void 0?1:_ref10$familyLength,parentX=_ref10.parentX,parentY=_ref10.parentY,maxHeight=_ref10.maxHeight;if(!node){return null;}var space=0;var offsetX;var offsetY;var levelNodeSpace=nodeSpace*Math.pow(2,(maxHeight||5)-level);if(level===1){space=treePanelWidth/2;offsetX=space-circleR;offsetY=(level-1)*levelOffset+circleR+strokeWidth;}else{offsetX=parentX-(index<1?levelNodeSpace:-levelNodeSpace);offsetY=(level-1)*levelOffset+circleR+strokeWidth;}var isActive=node.id===((_relatedBinaryNode=relatedBinaryNode)==null?void 0:_relatedBinaryNode.id);return React.createElement(G,{key:node.id},level>1?React.createElement(Line,{x1:parentX,y1:parentY,x2:offsetX,y2:offsetY}):null,node.left?React.createElement(VividBinaryTreeRecursive,{node:node.left,level:level+1,index:0,familyLength:2,parentX:offsetX,parentY:offsetY,maxHeight:maxHeight}):null,node.right?React.createElement(VividBinaryTreeRecursive,{node:node.right,level:level+1,index:1,familyLength:2,parentX:offsetX,parentY:offsetY,maxHeight:maxHeight}):null,React.createElement(Circle,{r:circleR,cx:offsetX,cy:offsetY,fill:isActive?colors.primary:colors.background}),React.createElement(SVGText,{fill:\"none\",stroke:isActive?colors.buttonText:colors.text,fontSize:fontSize,fontWeight:1,x:offsetX,y:offsetY+fontOffsetY,textAnchor:\"middle\"},React.createElement(TSpan,{x:offsetX,y:offsetY+fontOffsetY},node.id),React.createElement(TSpan,{x:offsetX,y:offsetY+fontOffsetY+fontSize+wp(2)},node.count),React.createElement(TSpan,{x:offsetX,y:offsetY+fontOffsetY+2*fontSize+wp(4)},node.allLesserSum)));};var VividGraphDrawer=function VividGraphDrawer(_ref11){var graph=_ref11.graph;var vertexDistance=wp(80);var vertices=graph.vertexSet();var vertexCount=vertices.size;var edges=graph.edgeSet();var coordsMap=new Map();var rowCount=Math.ceil(Math.sqrt(vertexCount));var i=0;vertices.forEach(function(vertex,id){var rowIndex=Math.floor(i/rowCount);var colIndex=Math.floor(i%rowCount);var y=rowIndex*vertexDistance+circleR;var x=(rowIndex%2===0?colIndex+1:colIndex)*vertexDistance+circleR;coordsMap.set(vertex,new Coordinate(y,x));i++;});return React.createElement(G,null,_toConsumableArray(vertices).map(function(_ref12){var _ref13=_slicedToArray(_ref12,2),id=_ref13[0],vertex=_ref13[1];var coordinate=coordsMap.get(vertex);return coordinate?React.createElement(G,{key:vertex.id},React.createElement(Circle,{key:vertex.id,r:circleR,cx:coordinate.x,cy:coordinate.y,fill:colors.primary}),React.createElement(SVGText,{key:vertex.id+'id',fill:\"none\",stroke:colors.text,fontSize:fontSize,fontWeight:1,x:coordinate.x,y:coordinate.y+fontOffsetY,textAnchor:\"middle\"},React.createElement(TSpan,{x:coordinate.x,y:coordinate.y+fontOffsetY},vertex.id))):null;}),edges.map(function(edge){if(graph instanceof UndirectedGraph){var ends=graph.getEndsOfEdge(edge);if(ends&&ends.length>1){var v1Coordinate=coordsMap.get(ends[0]);var v2Coordinate=coordsMap.get(ends[1]);if(v1Coordinate&&v2Coordinate){var _getPointsByDelta2=getPointsByDelta(v1Coordinate,v2Coordinate,circleR),src=_getPointsByDelta2.src,dest=_getPointsByDelta2.dest;return React.createElement(G,{key:edge.hashCode},React.createElement(Line,{x1:src.x,y1:src.y,x2:dest.x,y2:dest.y}));}}}else if(graph instanceof DirectedGraph){var _src=graph.getEdgeSrc(edge);var _dest=graph.getEdgeDest(edge);if(_src&&_dest){var srcCod=coordsMap.get(_src);var destCod=coordsMap.get(_dest);var _edge=graph.getEdge(_src,_dest);if(srcCod&&destCod){return React.createElement(LineWithArrow,{key:_edge.hashCode,from:srcCod,to:destCod,weight:_edge==null?void 0:_edge.weight,delta:circleR});}}}}));};var VividArray=function VividArray(_ref14){var data=_ref14.data;return React.createElement(View,null,data[0]instanceof Array?React.createElement(VividMatrix,{data:data}):data.map(function(item){switch(typeof item){case'number':return React.createElement(View,{style:styles.arrayItem,key:uuidV4()},React.createElement(Text,null,item));case'string':return React.createElement(View,{style:styles.arrayItem,key:uuidV4()},React.createElement(Text,null,item));default:return React.createElement(View,{style:styles.arrayItem,key:uuidV4()},React.createElement(Text,null,JSON.stringify(item)));}}));};var VividObject=function VividObject(_ref15){var data=_ref15.data;return React.createElement(Row,null,Object.keys(data).map(function(key){return React.createElement(View,{style:styles.arrayItem,key:key},React.createElement(Text,null,key),React.createElement(Text,null,data[key]));}));};var VividLinkedListNode=function VividLinkedListNode(_ref16){var data=_ref16.data;return React.createElement(Row,null,React.createElement(View,{style:styles.arrayItem,key:data.index},React.createElement(Text,null,data.index),React.createElement(Text,null,data.value)));};var VividBinaryTreeNode=function VividBinaryTreeNode(_ref17){var data=_ref17.data;return React.createElement(Row,null,React.createElement(View,{style:styles.arrayItem,key:data.id},React.createElement(Text,null,data.id)));};var VividBinarySearchTreeNode=function VividBinarySearchTreeNode(_ref18){var data=_ref18.data;return React.createElement(Row,null,React.createElement(View,{style:styles.arrayItem,key:data.id},React.createElement(Text,null,data.id)));};var renderVariable=function renderVariable(item){if(!item)return null;switch(typeof item){case'number':return React.createElement(VividNumber,{data:item});case'string':return React.createElement(VividString,{data:item});case'object':if(item instanceof TreeNode){return React.createElement(VividTree,{data:item});}else if(item instanceof AbstractGraph){return React.createElement(VividGraph,{data:item});}else if(item instanceof BinaryTreeNode){return React.createElement(VividBinaryTreeNode,{data:item});}else if(item instanceof BinaryTree){return React.createElement(VividBinaryTree,{node:item.root,maxHeight:item.getHeight()});}else if(item instanceof SinglyLinkedListNode){return React.createElement(VividLinkedListNode,{data:item});}else if(item instanceof Map){return React.createElement(VividArray,{data:Array.from(item)});}else if(item instanceof Stack){return React.createElement(VividArray,{data:item.toArray()});}else if(item instanceof Array){return React.createElement(VividArray,{data:item});}else{return React.createElement(VividObject,{data:item});}}};return React.createElement(View,null,referenceData?renderVariable(referenceData):null,data?Object.keys(data).map(function(datumKey){var item=data[datumKey];return datumKey!==relatedRouteKey&&datumKey!==relatedNodeKey?React.createElement(Card,{title:datumKey,key:datumKey},renderVariable(item)):null;}):null);};","map":null,"metadata":{},"sourceType":"module"}