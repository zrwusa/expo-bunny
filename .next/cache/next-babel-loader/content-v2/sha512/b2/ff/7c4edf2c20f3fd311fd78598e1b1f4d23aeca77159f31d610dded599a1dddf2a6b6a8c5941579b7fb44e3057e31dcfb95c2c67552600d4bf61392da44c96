{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import Platform from\"react-native-web/dist/exports/Platform\";import*as Notifications from'expo-notifications';import Constants from'expo-constants';import{collectBizLogicResult}from\"../store/actions\";import{bizLogicSuccess}from\"../helpers\";import store from\"../store/store\";export var registerForPushNotificationsAsync=function registerForPushNotificationsAsync(copywriting){var token,_await$Notifications$,existingStatus,finalStatus,_await$Notifications$2,status;return _regeneratorRuntime.async(function registerForPushNotificationsAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!Constants.isDevice){_context.next=20;break;}_context.next=3;return _regeneratorRuntime.awrap(Notifications.getPermissionsAsync());case 3:_await$Notifications$=_context.sent;existingStatus=_await$Notifications$.status;finalStatus=existingStatus;if(!(existingStatus!=='granted')){_context.next=12;break;}_context.next=9;return _regeneratorRuntime.awrap(Notifications.requestPermissionsAsync());case 9:_await$Notifications$2=_context.sent;status=_await$Notifications$2.status;finalStatus=status;case 12:if(!(finalStatus!=='granted')){_context.next=15;break;}store.dispatch(collectBizLogicResult(bizLogicSuccess(undefined,copywriting.failedToGetToken)));return _context.abrupt(\"return\");case 15:_context.next=17;return _regeneratorRuntime.awrap(Notifications.getExpoPushTokenAsync());case 17:token=_context.sent.data;_context.next=22;break;case 20:store.dispatch(collectBizLogicResult(bizLogicSuccess(undefined,copywriting.mustUsePhysicalDevice)));return _context.abrupt(\"return\");case 22:if(!(Platform.OS==='android')){_context.next=25;break;}_context.next=25;return _regeneratorRuntime.awrap(Notifications.setNotificationChannelAsync('default',{name:'default',importance:Notifications.AndroidImportance.MAX,vibrationPattern:[0,250,250,250],lightColor:'#FF231F7C'}));case 25:return _context.abrupt(\"return\",token);case 26:case\"end\":return _context.stop();}}},null,null,null,Promise);};export var schedulePushNotification=function schedulePushNotification(){return _regeneratorRuntime.async(function schedulePushNotification$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(Notifications.scheduleNotificationAsync({content:{title:'You\\'ve got mail! ðŸ“¬',body:'Here is the notification body',sound:'default',data:{data:'goes here'}},trigger:{seconds:2}}));case 2:case\"end\":return _context2.stop();}}},null,null,null,Promise);};export var defaultNotification={'request':{'trigger':{'type':'push'},'identifier':'XXXxXXXx-XXXx-XXXx-XXXx-XXXxXXXxXXXx','content':{'body':'body','sound':'default','launchImageName':'','subtitle':null,'title':null,'data':{},'categoryIdentifier':'','attachments':[],'threadIdentifier':''}},'date':new Date().getMilliseconds()};","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/utils/expo-notification.ts"],"names":["registerForPushNotificationsAsync","Constants","existingStatus","Notifications","finalStatus","status","store","collectBizLogicResult","bizLogicSuccess","copywriting","token","Platform","name","importance","vibrationPattern","lightColor","schedulePushNotification","content","title","body","sound","data","trigger","seconds","defaultNotification"],"mappings":"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","sourcesContent":["import {Platform} from 'react-native';\nimport * as Notifications from 'expo-notifications';\nimport {Notification} from 'expo-notifications';\nimport Constants from 'expo-constants';\nimport {collectBizLogicResult} from '../store/actions';\nimport {bizLogicSuccess} from '../helpers';\nimport store from '../store/store';\n\nexport type Copywriting = {\n    failedToGetToken: string,\n    mustUsePhysicalDevice: string\n}\n\nexport const registerForPushNotificationsAsync = async (copywriting: Copywriting) => {\n    let token;\n    if (Constants.isDevice) {\n        const {status: existingStatus} = await Notifications.getPermissionsAsync();\n        let finalStatus = existingStatus;\n        if (existingStatus !== 'granted') {\n            const {status} = await Notifications.requestPermissionsAsync();\n            finalStatus = status;\n        }\n        if (finalStatus !== 'granted') {\n            store.dispatch(collectBizLogicResult(bizLogicSuccess(undefined, copywriting.failedToGetToken)));\n            return;\n        }\n        token = (await Notifications.getExpoPushTokenAsync()).data;\n    } else {\n        store.dispatch(collectBizLogicResult(bizLogicSuccess(undefined, copywriting.mustUsePhysicalDevice)));\n        return;\n    }\n\n    if (Platform.OS === 'android') {\n        await Notifications.setNotificationChannelAsync('default', {\n            name: 'default',\n            importance: Notifications.AndroidImportance.MAX,\n            vibrationPattern: [0, 250, 250, 250],\n            lightColor: '#FF231F7C',\n        });\n    }\n\n    return token;\n};\n\n\nexport const schedulePushNotification = async () => {\n    await Notifications.scheduleNotificationAsync({\n        content: {\n            title: 'You\\'ve got mail! ðŸ“¬',\n            body: 'Here is the notification body',\n            sound: 'default',\n            data: {data: 'goes here'},\n        },\n        trigger: {seconds: 2},\n    });\n};\n\nexport const defaultNotification: Notification = {\n    'request': {\n        'trigger': {\n            'type': 'push',\n        },\n        'identifier': 'XXXxXXXx-XXXx-XXXx-XXXx-XXXxXXXxXXXx',\n        'content': {\n            'body': 'body',\n            'sound': 'default',\n            'launchImageName': '',\n            'subtitle': null,\n            'title': null,\n            'data': {},\n            'categoryIdentifier': '',\n            'attachments': [],\n            'threadIdentifier': '',\n        }\n    },\n    'date': new Date().getMilliseconds()\n};\n\n// const demoNotification: Notification = {\n//     \"request\": {\n//         \"trigger\": {\n//             \"type\": \"push\",\n//             \"payload\": {\n//                 \"experienceId\": \"@zrwusa/expo-react-bunny\",\n//                 \"body\": {\n//                     \"amount\": 0.06234018,\n//                     \"type\": 1,\n//                     \"amount_str\": \"0.06234018\",\n//                     \"id\": 151386336,\n//                     \"price_str\": \"47487.83\",\n//                     \"price\": 47487.83,\n//                     \"microtimestamp\": \"1613382537145000\",\n//                     \"buy_order_id\": 1329346815680513,\n//                     \"timestamp\": \"1613382537\",\n//                     \"sell_order_id\": 1329346815950849\n//                 },\n//                 \"aps\": {\n//                     \"thread-id\": \"\",\n//                     \"category\": \"\",\n//                     \"alert\": {\"subtitle\": \"\", \"title\": \"\", \"launch-image\": \"\", \"body\": \"Price is 47488,Alert: <47488.41 ,Re Try Times: 3\"},\n//                     \"sound\": \"default\"\n//                 }\n//             }\n//         },\n//         \"identifier\": \"FF91ED9E-0978-47C9-8736-F388EBB53016\",\n//         \"content\": {\n//             \"body\": \"Price is 47488,Alert: <47488.41 ,Re Try Times: 3\",\n//             \"sound\": \"default\",\n//             \"launchImageName\": \"\",\n//             \"badge\": null,\n//             \"subtitle\": null,\n//             \"title\": null,\n//             \"data\": {\n//                 \"sell_order_id\": 1329346815950849,\n//                 \"timestamp\": \"1613382537\",\n//                 \"buy_order_id\": 1329346815680513,\n//                 \"microtimestamp\": \"1613382537145000\",\n//                 \"price\": 47487.83,\n//                 \"price_str\": \"47487.83\",\n//                 \"id\": 151386336,\n//                 \"amount_str\": \"0.06234018\",\n//                 \"type\": 1,\n//                 \"amount\": 0.06234018\n//             },\n//             \"summaryArgument\": null,\n//             \"categoryIdentifier\": \"\",\n//             \"attachments\": [],\n//             \"threadIdentifier\": \"\",\n//             \"targetContentIdentifier\": undefined,\n//             \"summaryArgumentCount\": 0\n//         }\n//     }, \"date\": 1613382542.0082803\n// };\n"]},"metadata":{},"sourceType":"module"}