{"ast":null,"code":"\"use strict\";var _interopRequireDefault2=require(\"@babel/runtime/helpers/interopRequireDefault\");var _extends2=_interopRequireDefault2(require(\"@babel/runtime/helpers/extends\"));var _construct2=_interopRequireDefault2(require(\"@babel/runtime/helpers/construct\"));var _s=$RefreshSig$();function _createForOfIteratorHelperLoose(o,allowArrayLike){var it;if(typeof Symbol===\"undefined\"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}it=o[Symbol.iterator]();return it.next.bind(it);}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var _interopRequireWildcard=require(\"@babel/runtime/helpers/interopRequireWildcard\");var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.useRouter=useRouter;exports.makePublicRouterInstance=makePublicRouterInstance;exports.createRouter=exports.withRouter=exports.default=void 0;var _react=_interopRequireDefault(require(\"react\"));var _router2=_interopRequireWildcard(require(\"../next-server/lib/router/router\"));exports.Router=_router2.default;exports.NextRouter=_router2.NextRouter;var _routerContext=require(\"../next-server/lib/router-context\");var _withRouter=_interopRequireDefault(require(\"./with-router\"));exports.withRouter=_withRouter.default;var singletonRouter={router:null,readyCallbacks:[],ready:function ready(cb){if(this.router)return cb();if(true){this.readyCallbacks.push(cb);}}};var urlPropertyFields=['pathname','route','query','asPath','components','isFallback','basePath','locale','locales','defaultLocale','isReady','isPreview','isLocaleDomain'];var routerEvents=['routeChangeStart','beforeHistoryChange','routeChangeComplete','routeChangeError','hashChangeStart','hashChangeComplete'];var coreMethodFields=['push','replace','reload','back','prefetch','beforePopState'];Object.defineProperty(singletonRouter,'events',{get:function get(){return _router2.default.events;}});urlPropertyFields.forEach(function(field){Object.defineProperty(singletonRouter,field,{get:function get(){var router=getRouter();return router[field];}});});coreMethodFields.forEach(function(field){;singletonRouter[field]=function(){var router=getRouter();return router[field].apply(router,arguments);};});routerEvents.forEach(function(event){singletonRouter.ready(function(){_router2.default.events.on(event,function(){var eventField=\"on\"+event.charAt(0).toUpperCase()+event.substring(1);var _singletonRouter=singletonRouter;if(_singletonRouter[eventField]){try{_singletonRouter[eventField].apply(_singletonRouter,arguments);}catch(err){console.error(\"Error when running the Router event: \"+eventField);console.error(err.message+\"\\n\"+err.stack);}}});});});function getRouter(){if(!singletonRouter.router){var message='No router instance found.\\n'+'You should only use \"next/router\" inside the client side of your app.\\n';throw new Error(message);}return singletonRouter.router;}var _default=singletonRouter;exports.default=_default;function useRouter(){_s();return _react.default.useContext(_routerContext.RouterContext);}_s(useRouter,\"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");var createRouter=function createRouter(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}singletonRouter.router=(0,_construct2.default)(_router2.default,args);singletonRouter.readyCallbacks.forEach(function(cb){return cb();});singletonRouter.readyCallbacks=[];return singletonRouter.router;};exports.createRouter=createRouter;function makePublicRouterInstance(router){var _router=router;var instance={};for(var _iterator=_createForOfIteratorHelperLoose(urlPropertyFields),_step;!(_step=_iterator()).done;){var property=_step.value;if(typeof _router[property]==='object'){instance[property]=(0,_extends2.default)(Array.isArray(_router[property])?[]:{},_router[property]);continue;}instance[property]=_router[property];}instance.events=_router2.default.events;coreMethodFields.forEach(function(field){instance[field]=function(){return _router[field].apply(_router,arguments);};});return instance;}","map":{"version":3,"sources":["../../client/router.ts"],"names":["singletonRouter","router","readyCallbacks","ready","cb","urlPropertyFields","routerEvents","coreMethodFields","Object","get","Router","field","getRouter","event","eventField","_singletonRouter","console","err","message","React","RouterContext","createRouter","_router","instance","Array"],"mappings":"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","sourcesContent":["/* global window */\nimport React from 'react'\nimport Router, { NextRouter } from '../next-server/lib/router/router'\nimport { RouterContext } from '../next-server/lib/router-context'\n\ntype ClassArguments<T> = T extends new (...args: infer U) => any ? U : any\n\ntype RouterArgs = ClassArguments<typeof Router>\n\ntype SingletonRouterBase = {\n  router: Router | null\n  readyCallbacks: Array<() => any>\n  ready(cb: () => any): void\n}\n\nexport { Router, NextRouter }\n\nexport type SingletonRouter = SingletonRouterBase & NextRouter\n\nconst singletonRouter: SingletonRouterBase = {\n  router: null, // holds the actual router instance\n  readyCallbacks: [],\n  ready(cb: () => void) {\n    if (this.router) return cb()\n    if (typeof window !== 'undefined') {\n      this.readyCallbacks.push(cb)\n    }\n  },\n}\n\n// Create public properties and methods of the router in the singletonRouter\nconst urlPropertyFields = [\n  'pathname',\n  'route',\n  'query',\n  'asPath',\n  'components',\n  'isFallback',\n  'basePath',\n  'locale',\n  'locales',\n  'defaultLocale',\n  'isReady',\n  'isPreview',\n  'isLocaleDomain',\n]\nconst routerEvents = [\n  'routeChangeStart',\n  'beforeHistoryChange',\n  'routeChangeComplete',\n  'routeChangeError',\n  'hashChangeStart',\n  'hashChangeComplete',\n]\nconst coreMethodFields = [\n  'push',\n  'replace',\n  'reload',\n  'back',\n  'prefetch',\n  'beforePopState',\n]\n\n// Events is a static property on the router, the router doesn't have to be initialized to use it\nObject.defineProperty(singletonRouter, 'events', {\n  get() {\n    return Router.events\n  },\n})\n\nurlPropertyFields.forEach((field: string) => {\n  // Here we need to use Object.defineProperty because, we need to return\n  // the property assigned to the actual router\n  // The value might get changed as we change routes and this is the\n  // proper way to access it\n  Object.defineProperty(singletonRouter, field, {\n    get() {\n      const router = getRouter() as any\n      return router[field] as string\n    },\n  })\n})\n\ncoreMethodFields.forEach((field: string) => {\n  // We don't really know the types here, so we add them later instead\n  ;(singletonRouter as any)[field] = (...args: any[]) => {\n    const router = getRouter() as any\n    return router[field](...args)\n  }\n})\n\nrouterEvents.forEach((event: string) => {\n  singletonRouter.ready(() => {\n    Router.events.on(event, (...args) => {\n      const eventField = `on${event.charAt(0).toUpperCase()}${event.substring(\n        1\n      )}`\n      const _singletonRouter = singletonRouter as any\n      if (_singletonRouter[eventField]) {\n        try {\n          _singletonRouter[eventField](...args)\n        } catch (err) {\n          console.error(`Error when running the Router event: ${eventField}`)\n          console.error(`${err.message}\\n${err.stack}`)\n        }\n      }\n    })\n  })\n})\n\nfunction getRouter(): Router {\n  if (!singletonRouter.router) {\n    const message =\n      'No router instance found.\\n' +\n      'You should only use \"next/router\" inside the client side of your app.\\n'\n    throw new Error(message)\n  }\n  return singletonRouter.router\n}\n\n// Export the singletonRouter and this is the public API.\nexport default singletonRouter as SingletonRouter\n\n// Reexport the withRoute HOC\nexport { default as withRouter } from './with-router'\n\nexport function useRouter(): NextRouter {\n  return React.useContext(RouterContext)\n}\n\n// INTERNAL APIS\n// -------------\n// (do not use following exports inside the app)\n\n// Create a router and assign it as the singleton instance.\n// This is used in client side when we are initilizing the app.\n// This should **not** use inside the server.\nexport const createRouter = (...args: RouterArgs): Router => {\n  singletonRouter.router = new Router(...args)\n  singletonRouter.readyCallbacks.forEach((cb) => cb())\n  singletonRouter.readyCallbacks = []\n\n  return singletonRouter.router\n}\n\n// This function is used to create the `withRouter` router instance\nexport function makePublicRouterInstance(router: Router): NextRouter {\n  const _router = router as any\n  const instance = {} as any\n\n  for (const property of urlPropertyFields) {\n    if (typeof _router[property] === 'object') {\n      instance[property] = Object.assign(\n        Array.isArray(_router[property]) ? [] : {},\n        _router[property]\n      ) // makes sure query is not stateful\n      continue\n    }\n\n    instance[property] = _router[property]\n  }\n\n  // Events is a static property on the router, the router doesn't have to be initialized to use it\n  instance.events = Router.events\n\n  coreMethodFields.forEach((field) => {\n    instance[field] = (...args: any[]) => {\n      return _router[field](...args)\n    }\n  })\n\n  return instance\n}\n"]},"metadata":{},"sourceType":"script"}