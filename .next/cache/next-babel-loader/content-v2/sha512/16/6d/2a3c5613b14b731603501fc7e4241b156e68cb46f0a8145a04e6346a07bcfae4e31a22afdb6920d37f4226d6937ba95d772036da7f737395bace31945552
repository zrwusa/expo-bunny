{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import{makeStyles}from\"./styles\";import{withBunnyKit}from\"../../hooks/bunny-kit\";var ReadMoreInner=function(_React$Component){_inherits(ReadMoreInner,_React$Component);var _super=_createSuper(ReadMoreInner);function ReadMoreInner(){var _this;_classCallCheck(this,ReadMoreInner);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this._isMounted=false;_this._text=null;_this.state={measured:false,shouldShowReadMore:false,showAllText:false};_this._handlePressReadMore=function(){_this.setState({showAllText:true});};_this._handlePressReadLess=function(){_this.setState({showAllText:false});};return _this;}_createClass(ReadMoreInner,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var fullHeight,limitedHeight;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:this._isMounted=true;_context.next=3;return _regeneratorRuntime.awrap(nextFrameAsync());case 3:if(this._isMounted){_context.next=5;break;}return _context.abrupt(\"return\");case 5:if(!this._text){_context.next=18;break;}_context.next=8;return _regeneratorRuntime.awrap(measureHeightAsync(this._text));case 8:fullHeight=_context.sent;this.setState({measured:true});_context.next=12;return _regeneratorRuntime.awrap(nextFrameAsync());case 12:if(this._isMounted){_context.next=14;break;}return _context.abrupt(\"return\");case 14:_context.next=16;return _regeneratorRuntime.awrap(measureHeightAsync(this._text));case 16:limitedHeight=_context.sent;if(fullHeight>limitedHeight){this.setState({shouldShowReadMore:true},function(){_this2.props.onReady&&_this2.props.onReady();});}else{this.props.onReady&&this.props.onReady();}case 18:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,measured=_this$state.measured,showAllText=_this$state.showAllText;var numberOfLines=this.props.numberOfLines;return React.createElement(View,null,React.createElement(Text,{numberOfLines:measured&&!showAllText?numberOfLines:0,style:[this.props.textStyle],ref:function ref(text){_this3._text=text;}},this.props.children),React.createElement(View,{style:{alignItems:'flex-end'}},this._maybeRenderReadMore()));}},{key:\"_maybeRenderReadMore\",value:function _maybeRenderReadMore(){var bunnyKit=this.props.bunnyKit;var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);var _this$state2=this.state,shouldShowReadMore=_this$state2.shouldShowReadMore,showAllText=_this$state2.showAllText;if(shouldShowReadMore&&!showAllText){if(this.props.renderTruncatedFooter){return this.props.renderTruncatedFooter(this._handlePressReadMore);}return React.createElement(Text,{style:styles.button,onPress:this._handlePressReadMore},\"more\");}else if(shouldShowReadMore&&showAllText){if(this.props.renderRevealedFooter){return this.props.renderRevealedFooter(this._handlePressReadLess);}return React.createElement(Text,{style:styles.button,onPress:this._handlePressReadLess},\"hide\");}}}]);return ReadMoreInner;}(React.Component);export var ReadMore=withBunnyKit(ReadMoreInner);function measureHeightAsync(component){return new Promise(function(resolve){component.measure(function(x,y,w,h){resolve(h);});});}function nextFrameAsync(){return new Promise(function(resolve){return requestAnimationFrame(function(){return resolve(true);});});}","map":null,"metadata":{},"sourceType":"module"}