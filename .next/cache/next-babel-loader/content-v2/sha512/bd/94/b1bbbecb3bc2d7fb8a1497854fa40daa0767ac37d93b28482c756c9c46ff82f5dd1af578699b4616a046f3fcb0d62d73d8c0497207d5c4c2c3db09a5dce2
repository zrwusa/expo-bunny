{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectDestructuringEmpty from\"@babel/runtime/helpers/objectDestructuringEmpty\";var _jsxFileName=\"/Users/revone/projects/expo-react-bunny/src/screens/DemoCryptoCurrency/Home/Home.tsx\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import*as React from'react';import{useEffect,useState}from'react';import{Text,View}from\"../../../components/UI\";import{shortenTFunctionKey}from\"../../../providers/i18n-labor\";import{makeContainerStyles}from\"../../../containers\";import{VictoryAxis,VictoryChart,VictoryLine,VictoryTooltip,VictoryVoronoiContainer}from\"../../../components/Victory/Victory\";import nomicsAPI from\"../../../helpers/nomics-api\";import{makeStyles}from\"./styles\";import{addDays}from\"../../../utils\";import{useDispatch,useSelector}from'react-redux';import axios from'axios';import{collectBizLogicResult,collectSysError,getCurrentPrice}from\"../../../store/actions\";import{bizLogicError,getSharedStyles}from\"../../../helpers\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import{Tab}from\"../../../components\";import{useBunnyKit}from\"../../../hooks/bunny-kit\";var source;function CryptoCurrencyHomeScreen(){var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp,t=_useBunnyKit.t,ms=_useBunnyKit.ms;var types=['BTC','ETH'];var dateRanges=['1d','1w','1m','1y'];var st=shortenTFunctionKey(t,'screens.CryptoCurrencyHome');var dispatch=useDispatch();var victory=themeLabor.theme.victory;var _makeContainerStyles=makeContainerStyles(sizeLabor,themeLabor),Screen=_makeContainerStyles.Screen,Box=_makeContainerStyles.Box;var _getSharedStyles=getSharedStyles(sizeLabor,themeLabor),sharedStyles=_getSharedStyles.sharedStyles;_objectDestructuringEmpty(sharedStyles);var styles=makeStyles(sizeLabor,themeLabor);var _useState=useState([{x:new Date('1990-01-01'),y:5}]),_useState2=_slicedToArray(_useState,2),btcData=_useState2[0],setBtcData=_useState2[1];var _useSelector=useSelector(function(rootState){return rootState.demoCryptoCurrencyState;}),currentPrice=_useSelector.currentPrice;var _useState3=useState('BTC'),_useState4=_slicedToArray(_useState3,2),type=_useState4[0],setType=_useState4[1];var _useState5=useState('1d'),_useState6=_slicedToArray(_useState5,2),dateRange=_useState6[0],setDateRange=_useState6[1];var getHistoricalPrices=function getHistoricalPrices(type,dateRange){var start,end,_await$nomicsAPI$get,data,_data$,timestamps,prices,btcDataMapped;return _regeneratorRuntime.async(function getHistoricalPrices$(_context){while(1){switch(_context.prev=_context.next){case 0:start='';end=new Date().toISOString();_context.t0=dateRange;_context.next=_context.t0==='1d'?5:_context.t0==='1w'?7:_context.t0==='1m'?9:_context.t0==='1y'?11:13;break;case 5:start=addDays(new Date(),-1).toISOString();return _context.abrupt(\"break\",15);case 7:start=addDays(new Date(),-7).toISOString();return _context.abrupt(\"break\",15);case 9:start=addDays(new Date(),-30).toISOString();return _context.abrupt(\"break\",15);case 11:start=addDays(new Date(),-365).toISOString();return _context.abrupt(\"break\",15);case 13:start=addDays(new Date(),-1).toISOString();return _context.abrupt(\"break\",15);case 15:source=axios.CancelToken.source();_context.prev=16;_context.next=19;return _regeneratorRuntime.awrap(nomicsAPI.get('v1/currencies/sparkline',{cancelToken:source.token,params:{ids:type,start:start,end:end}}));case 19:_await$nomicsAPI$get=_context.sent;data=_await$nomicsAPI$get.data.data;_data$=data[0],timestamps=_data$.timestamps,prices=_data$.prices;btcDataMapped=timestamps.map(function(item,index){return{x:new Date(item),y:parseFloat(parseFloat(prices[index]).toFixed(2))};});setBtcData(btcDataMapped);_context.next=29;break;case 26:_context.prev=26;_context.t1=_context[\"catch\"](16);dispatch(collectBizLogicResult(bizLogicError(_context.t1.message,false)));case 29:case\"end\":return _context.stop();}}},null,null,[[16,26]],Promise);};useEffect(function(){try{dispatch(getCurrentPrice());}catch(e){dispatch(collectSysError(e));}getHistoricalPrices(type,dateRange).then();return function(){source.cancel(t('sys.canceledRequest'));};},[]);return React.createElement(ScrollView,{__self:this,__source:{fileName:_jsxFileName,lineNumber:108,columnNumber:9}},React.createElement(View,{style:[Screen,Box],__self:this,__source:{fileName:_jsxFileName,lineNumber:109,columnNumber:13}},React.createElement(Text,{__self:this,__source:{fileName:_jsxFileName,lineNumber:110,columnNumber:17}},currentPrice),React.createElement(Tab,{items:types,value:type,onChange:function _callee(item){return _regeneratorRuntime.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setType(item);_context2.next=3;return _regeneratorRuntime.awrap(getHistoricalPrices(item,dateRange));case 3:case\"end\":return _context2.stop();}}},null,null,null,Promise);},__self:this,__source:{fileName:_jsxFileName,lineNumber:111,columnNumber:17}}),React.createElement(Tab,{items:dateRanges,value:dateRange,onChange:function _callee2(item){return _regeneratorRuntime.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setDateRange(item);_context3.next=3;return _regeneratorRuntime.awrap(getHistoricalPrices(type,item));case 3:case\"end\":return _context3.stop();}}},null,null,null,Promise);},__self:this,__source:{fileName:_jsxFileName,lineNumber:117,columnNumber:17}}),React.createElement(VictoryChart,{theme:victory,padding:{top:wp(40),left:wp(4),bottom:wp(30),right:wp(20)},domainPadding:{y:wp(15)},containerComponent:React.createElement(VictoryVoronoiContainer,{voronoiDimension:\"x\",labels:function labels(_ref){var datum=_ref.datum;return\"x:\"+datum.x.toLocaleDateString()+\" \\n y: \"+datum.y;},labelComponent:React.createElement(VictoryTooltip,{constrainToVisibleArea:true,cornerRadius:ms.br.s,__self:this,__source:{fileName:_jsxFileName,lineNumber:135,columnNumber:33}}),__self:this,__source:{fileName:_jsxFileName,lineNumber:131,columnNumber:25}}),scale:{x:'time'},__self:this,__source:{fileName:_jsxFileName,lineNumber:123,columnNumber:17}},React.createElement(VictoryAxis,{crossAxis:true,style:{grid:{stroke:'none'}},__self:this,__source:{fileName:_jsxFileName,lineNumber:147,columnNumber:21}}),React.createElement(VictoryAxis,{dependentAxis:true,tickFormat:function tickFormat(){return\"\";},style:{grid:{stroke:'none'}},__self:this,__source:{fileName:_jsxFileName,lineNumber:152,columnNumber:21}}),React.createElement(VictoryLine,{interpolation:\"natural\",style:{},data:btcData,__self:this,__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:21}}))));}export default CryptoCurrencyHomeScreen;","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/screens/DemoCryptoCurrency/Home/Home.tsx"],"names":["sizeLabor","themeLabor","wp","t","ms","useBunnyKit","types","dateRanges","st","shortenTFunctionKey","dispatch","useDispatch","victory","Screen","Box","makeContainerStyles","sharedStyles","getSharedStyles","styles","makeStyles","btcData","setBtcData","useState","x","y","currentPrice","useSelector","rootState","type","setType","dateRange","setDateRange","getHistoricalPrices","start","end","addDays","source","axios","data","cancelToken","params","ids","timestamps","prices","btcDataMapped","parseFloat","collectBizLogicResult","bizLogicError","useEffect","getCurrentPrice","collectSysError","top","left","bottom","right","datum","grid","stroke"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {useEffect, useState} from 'react';\nimport {Text, View} from '../../../components/UI';\nimport {RouteProp} from '@react-navigation/native';\nimport {DemoCryptoCurrencyTabStackParam, RootStackParam, RootState} from '../../../types';\nimport {shortenTFunctionKey} from '../../../providers/i18n-labor';\nimport {makeContainerStyles} from '../../../containers';\nimport {\n    VictoryAxis,\n    VictoryChart,\n    VictoryLine,\n    VictoryTooltip,\n    VictoryVoronoiContainer\n} from '../../../components/Victory/Victory';\nimport nomicsAPI from '../../../helpers/nomics-api';\nimport {makeStyles} from './styles';\nimport {addDays} from '../../../utils';\nimport {useDispatch, useSelector} from 'react-redux';\nimport axios, {CancelTokenSource} from 'axios';\nimport {collectBizLogicResult, collectSysError, getCurrentPrice} from '../../../store/actions';\nimport {bizLogicError, getSharedStyles} from '../../../helpers';\nimport {ScrollView} from 'react-native';\nimport {StackNavigationProp} from '@react-navigation/stack';\nimport {Tab} from '../../../components';\nimport {useBunnyKit} from '../../../hooks/bunny-kit';\n\ntype CryptoCurrencyHomeRouteProp = RouteProp<DemoCryptoCurrencyTabStackParam, 'CryptoCurrencyHome'>;\ntype CryptoCurrencyHomeNavigationProp = StackNavigationProp<RootStackParam, 'DemoCryptoCurrency'>;\n\nexport interface CryptoCurrencyHomeProps {\n    route: CryptoCurrencyHomeRouteProp,\n    navigation: CryptoCurrencyHomeNavigationProp\n}\n\nlet source: CancelTokenSource;\n\nfunction CryptoCurrencyHomeScreen() {\n    const {sizeLabor, themeLabor, wp, t, ms} = useBunnyKit();\n    const types = ['BTC', 'ETH'];\n    const dateRanges = ['1d', '1w', '1m', '1y'];\n    const st = shortenTFunctionKey(t, 'screens.CryptoCurrencyHome');\n    const dispatch = useDispatch();\n    const {victory} = themeLabor.theme;\n    const {Screen, Box} = makeContainerStyles(sizeLabor, themeLabor);\n    const {sharedStyles} = getSharedStyles(sizeLabor, themeLabor);\n    const {} = sharedStyles;\n    const styles = makeStyles(sizeLabor, themeLabor);\n    const [btcData, setBtcData] = useState([\n        {x: new Date('1990-01-01'), y: 5}\n    ]);\n    const {currentPrice} = useSelector((rootState: RootState) => rootState.demoCryptoCurrencyState);\n    const [type, setType] = useState('BTC');\n    const [dateRange, setDateRange] = useState('1d');\n    const getHistoricalPrices = async (type: string, dateRange: string) => {\n        let start = '';\n        let end = new Date().toISOString();\n        switch (dateRange) {\n            case '1d':\n                start = addDays(new Date(), -1).toISOString();\n                break;\n            case '1w':\n                start = addDays(new Date(), -7).toISOString();\n                break;\n            case '1m':\n                start = addDays(new Date(), -30).toISOString();\n                break;\n            case '1y':\n                start = addDays(new Date(), -365).toISOString();\n                break;\n            default:\n                start = addDays(new Date(), -1).toISOString();\n                break;\n        }\n        source = axios.CancelToken.source();\n        try {\n            const {data: {data}} = await nomicsAPI.get('v1/currencies/sparkline', {\n                cancelToken: source.token,\n                params: {\n                    ids: type,\n                    start,\n                    end\n                }\n            });\n\n            const {timestamps, prices} = data[0];\n\n            const btcDataMapped = timestamps.map((item: string, index: number) => {\n                return {x: new Date(item), y: parseFloat(parseFloat(prices[index]).toFixed(2))};\n            });\n            setBtcData(btcDataMapped);\n        } catch (e: any) {\n            dispatch(collectBizLogicResult(bizLogicError(e.message, false)));\n        }\n    };\n    useEffect(() => {\n        try {\n            dispatch(getCurrentPrice());\n        } catch (e: any) {\n            dispatch(collectSysError(e));\n        }\n        getHistoricalPrices(type, dateRange).then();\n        return () => {\n            source.cancel(t('sys.canceledRequest'));\n        };\n    }, []);\n\n    return (\n        <ScrollView>\n            <View style={[Screen, Box]}>\n                <Text>{currentPrice}</Text>\n                <Tab items={types}\n                     value={type}\n                     onChange={async (item) => {\n                         setType(item);\n                         await getHistoricalPrices(item, dateRange);\n                     }}/>\n                <Tab items={dateRanges}\n                     value={dateRange}\n                     onChange={async (item) => {\n                         setDateRange(item);\n                         await getHistoricalPrices(type, item);\n                     }}/>\n                <VictoryChart\n                    theme={victory}\n                    padding={{top: wp(40), left: wp(4), bottom: wp(30), right: wp(20)}}\n                    // animate={{\n                    //     duration: 1000,\n                    // }}\n                    domainPadding={{y: wp(15)}}\n                    containerComponent={\n                        <VictoryVoronoiContainer\n                            voronoiDimension=\"x\"\n                            labels={({datum}: { datum: { x: Date, y: number } }) => `x:${datum.x.toLocaleDateString()} \\n y: ${datum.y}`}\n                            labelComponent={\n                                <VictoryTooltip\n                                    constrainToVisibleArea\n                                    cornerRadius={ms.br.s}\n                                    // flyoutStyle={{\n                                    //     fill: colors.surface\n                                    // }}\n                                />\n                            }\n                        />\n                    }\n                    scale={{x: 'time'}}\n                >\n                    <VictoryAxis crossAxis style={{\n                        // axis: {stroke: colors.accent},\n                        grid: {stroke: 'none'},\n                        // tickLabels: {padding: wp(2), fill: colors.primary}\n                    }}/>\n                    <VictoryAxis dependentAxis tickFormat={() => ``}\n                                 style={{\n                                     grid: {stroke: 'none'},\n                                 }}/>\n                    <VictoryLine\n                        interpolation=\"natural\"\n                        style={{\n                            // data: {stroke: colors.secondary},\n                            // parent: {border: `1px solid ${colors.border}`}\n                        }}\n                        data={btcData}\n                    />\n                </VictoryChart>\n            </View>\n        </ScrollView>\n    );\n}\n\nexport default CryptoCurrencyHomeScreen;\n"]},"metadata":{},"sourceType":"module"}