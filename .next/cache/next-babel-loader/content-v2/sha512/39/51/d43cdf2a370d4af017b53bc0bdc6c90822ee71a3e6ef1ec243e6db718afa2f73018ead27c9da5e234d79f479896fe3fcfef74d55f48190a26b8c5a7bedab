{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import Clipboard from\"react-native-web/dist/exports/Clipboard\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import TouchableWithoutFeedback from\"react-native-web/dist/exports/TouchableWithoutFeedback\";import View from\"react-native-web/dist/exports/View\";import QuickReplies from\"./QuickReplies\";import MessageText from\"./MessageText\";import MessageImage from\"./MessageImage\";import MessageVideo from\"./MessageVideo\";import MessageAudio from\"./MessageAudio\";import Time from\"./Time\";import{isSameDay,isSameUser}from\"./utils\";import MessageSticker from\"./MessageSticker\";import{withBunnyKit}from\"../../hooks/bunny-kit\";import{connectActionSheet}from\"../../../packages/react-native-action-sheet/src\";var makeStyles=function makeStyles(sizeLabor,themeLabor){var wp=sizeLabor.designsBasedOn.iphoneX.wp;var colors=themeLabor.theme.colors;return{left:StyleSheet.create({container:{flex:1,alignItems:'flex-start'},wrapper:{borderRadius:wp(15),backgroundColor:colors.backgroundA,marginRight:wp(60),minHeight:wp(20),justifyContent:'flex-end'},containerToNext:{borderBottomLeftRadius:wp(3)},containerToPrevious:{borderTopLeftRadius:wp(3)},bottom:{flexDirection:'row',justifyContent:'flex-start'}}),right:StyleSheet.create({container:{flex:1,alignItems:'flex-end'},wrapper:{borderRadius:wp(15),backgroundColor:colors.backgroundB,marginLeft:wp(60),minHeight:wp(20),justifyContent:'flex-end'},containerToNext:{borderBottomRightRadius:wp(3)},containerToPrevious:{borderTopRightRadius:wp(3)},bottom:{flexDirection:'row',justifyContent:'flex-end'}}),content:StyleSheet.create({tick:{fontSize:wp(10),backgroundColor:colors.transparent,color:colors.textB},tickView:{flexDirection:'row',marginRight:wp(10)},username:{top:wp(-3),left:0,fontSize:wp(12),backgroundColor:'transparent',color:'#aaa'},usernameView:{flexDirection:'row',marginHorizontal:wp(10)}})};};var DEFAULT_OPTION_TITLES=['Copy Text','Cancel'];var Bubble=function(_React$Component){_inherits(Bubble,_React$Component);var _super=_createSuper(Bubble);function Bubble(){var _this;_classCallCheck(this,Bubble);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.onPress=function(){if(_this.props.onPress){_this.props.onPress(_this.context,_this.props.currentMessage);}};_this.onLongPress=function(){var currentMessage=_this.props.currentMessage;if(_this.props.onLongPress){_this.props.onLongPress(_this.context,_this.props.currentMessage);}else if(currentMessage&&currentMessage.text){var textLongPressOptionTitles=_this.props.textLongPressOptionTitles;var options=textLongPressOptionTitles&&textLongPressOptionTitles.length>0?textLongPressOptionTitles.slice(0,2):DEFAULT_OPTION_TITLES;var cancelButtonIndex=options.length-1;_this.props.showActionSheetWithOptions({options:options,cancelButtonIndex:cancelButtonIndex},function(buttonIndex){switch(buttonIndex){case 0:Clipboard.setString(currentMessage.text);break;default:break;}});}};return _this;}_createClass(Bubble,[{key:\"styledBubbleToNext\",value:function styledBubbleToNext(){var _this$props=this.props,currentMessage=_this$props.currentMessage,nextMessage=_this$props.nextMessage,position=_this$props.position,containerToNextStyle=_this$props.containerToNextStyle,bunnyKit=_this$props.bunnyKit;if(currentMessage&&nextMessage&&position&&isSameUser(currentMessage,nextMessage)&&isSameDay(currentMessage,nextMessage)){var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);return[styles[position].containerToNext,containerToNextStyle&&containerToNextStyle[position]];}return null;}},{key:\"styledBubbleToPrevious\",value:function styledBubbleToPrevious(){var _this$props2=this.props,currentMessage=_this$props2.currentMessage,previousMessage=_this$props2.previousMessage,position=_this$props2.position,containerToPreviousStyle=_this$props2.containerToPreviousStyle,bunnyKit=_this$props2.bunnyKit;if(currentMessage&&previousMessage&&position&&isSameUser(currentMessage,previousMessage)&&isSameDay(currentMessage,previousMessage)){var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);return[styles[position].containerToPrevious,containerToPreviousStyle&&containerToPreviousStyle[position]];}return null;}},{key:\"renderQuickReplies\",value:function renderQuickReplies(){var _this$props3=this.props,currentMessage=_this$props3.currentMessage,nextMessage=_this$props3.nextMessage;if(currentMessage&&currentMessage.quickReplies){var _this$props4=this.props,onQuickReply=_this$props4.onQuickReply,quickRepliesColor=_this$props4.quickRepliesColor,sendText=_this$props4.sendText,keepReplies=_this$props4.keepReplies,renderQuickReplySend=_this$props4.renderQuickReplySend,quickReplyStyle=_this$props4.quickReplyStyle;var quickRepliesProps={currentMessage:currentMessage,nextMessage:nextMessage,onQuickReply:onQuickReply,quickRepliesColor:quickRepliesColor,sendText:sendText,keepReplies:keepReplies,renderQuickReplySend:renderQuickReplySend,quickReplyStyle:quickReplyStyle};if(this.props.renderQuickReplies){return this.props.renderQuickReplies(quickRepliesProps);}return React.createElement(QuickReplies,quickRepliesProps);}return null;}},{key:\"renderMessageText\",value:function renderMessageText(){if(this.props.currentMessage&&this.props.currentMessage.text){var _this$props5=this.props,position=_this$props5.position,phoneNumberOptionTitles=_this$props5.phoneNumberOptionTitles,_currentMessage=_this$props5.currentMessage,textContainerStyle=_this$props5.textContainerStyle,textStyle=_this$props5.textStyle,linkStyle=_this$props5.linkStyle,customTextStyle=_this$props5.customTextStyle,textProps=_this$props5.textProps,parsePatterns=_this$props5.parsePatterns,onMessageLoad=_this$props5.onMessageLoad,onMessageLoadStart=_this$props5.onMessageLoadStart,onMessageLoadEnd=_this$props5.onMessageLoadEnd,onMessageReadyForDisplay=_this$props5.onMessageReadyForDisplay,onMessageLoadError=_this$props5.onMessageLoadError,isDebug=_this$props5.isDebug;var messageTextProps={position:position,phoneNumberOptionTitles:phoneNumberOptionTitles,currentMessage:_currentMessage,textContainerStyle:textContainerStyle,textStyle:textStyle,linkStyle:linkStyle,customTextStyle:customTextStyle,textProps:textProps,parsePatterns:parsePatterns,onMessageLoad:onMessageLoad,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,onMessageReadyForDisplay:onMessageReadyForDisplay,onMessageLoadError:onMessageLoadError,isDebug:isDebug};if(this.props.renderMessageText){return this.props.renderMessageText(messageTextProps);}return React.createElement(MessageText,messageTextProps);}return null;}},{key:\"renderMessageImage\",value:function renderMessageImage(){if(this.props.currentMessage&&this.props.currentMessage.image){var _this$props6=this.props,messages=_this$props6.messages,_currentMessage2=_this$props6.currentMessage,imageContainerStyle=_this$props6.imageContainerStyle,imageStyle=_this$props6.imageStyle,imageProps=_this$props6.imageProps,lightBoxProps=_this$props6.lightBoxProps,onMessageLoad=_this$props6.onMessageLoad,onMessageLoadStart=_this$props6.onMessageLoadStart,onMessageLoadEnd=_this$props6.onMessageLoadEnd,onMessageReadyForDisplay=_this$props6.onMessageReadyForDisplay,onMessageLoadError=_this$props6.onMessageLoadError,isDebug=_this$props6.isDebug;var messageImageProps={messages:messages,currentMessage:_currentMessage2,imageContainerStyle:imageContainerStyle,imageStyle:imageStyle,imageProps:imageProps,lightBoxProps:lightBoxProps,onMessageLoad:onMessageLoad,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,onMessageReadyForDisplay:onMessageReadyForDisplay,onMessageLoadError:onMessageLoadError,isDebug:isDebug};if(this.props.renderMessageImage){return this.props.renderMessageImage(messageImageProps);}return React.createElement(MessageImage,messageImageProps);}return null;}},{key:\"renderMessageSticker\",value:function renderMessageSticker(){if(this.props.currentMessage&&this.props.currentMessage.sticker){var _this$props7=this.props,_currentMessage3=_this$props7.currentMessage,stickerContainerStyle=_this$props7.stickerContainerStyle,stickerStyle=_this$props7.stickerStyle,stickerProps=_this$props7.stickerProps,onMessageLoad=_this$props7.onMessageLoad,onMessageLoadStart=_this$props7.onMessageLoadStart,onMessageLoadEnd=_this$props7.onMessageLoadEnd,onMessageReadyForDisplay=_this$props7.onMessageReadyForDisplay,onMessageLoadError=_this$props7.onMessageLoadError,isDebug=_this$props7.isDebug;var messageStickerProps={currentMessage:_currentMessage3,stickerContainerStyle:stickerContainerStyle,stickerStyle:stickerStyle,stickerProps:stickerProps,onMessageLoad:onMessageLoad,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,onMessageReadyForDisplay:onMessageReadyForDisplay,onMessageLoadError:onMessageLoadError,isDebug:isDebug};if(this.props.renderMessageSticker){return this.props.renderMessageSticker(messageStickerProps);}return React.createElement(MessageSticker,messageStickerProps);}return null;}},{key:\"renderMessageVideo\",value:function renderMessageVideo(){if(this.props.currentMessage&&this.props.currentMessage.video){var _this$props8=this.props,_currentMessage4=_this$props8.currentMessage,videoContainerStyle=_this$props8.videoContainerStyle,videoStyle=_this$props8.videoStyle,videoProps=_this$props8.videoProps,onMessageLoad=_this$props8.onMessageLoad,onMessageLoadStart=_this$props8.onMessageLoadStart,onMessageLoadEnd=_this$props8.onMessageLoadEnd,onMessageReadyForDisplay=_this$props8.onMessageReadyForDisplay,onMessageLoadError=_this$props8.onMessageLoadError,isDebug=_this$props8.isDebug;var messageVideoProps={currentMessage:_currentMessage4,videoContainerStyle:videoContainerStyle,videoStyle:videoStyle,videoProps:videoProps,onMessageLoad:onMessageLoad,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,onMessageReadyForDisplay:onMessageReadyForDisplay,onMessageLoadError:onMessageLoadError,isDebug:isDebug};if(this.props.renderMessageVideo){return this.props.renderMessageVideo(messageVideoProps);}return React.createElement(MessageVideo,messageVideoProps);}return null;}},{key:\"renderMessageAudio\",value:function renderMessageAudio(){if(this.props.currentMessage&&this.props.currentMessage.audio){var _this$props9=this.props,_currentMessage5=_this$props9.currentMessage,audioContainerStyle=_this$props9.audioContainerStyle,audioStyle=_this$props9.audioStyle,audioProps=_this$props9.audioProps,onMessageLoad=_this$props9.onMessageLoad,onMessageLoadStart=_this$props9.onMessageLoadStart,onMessageLoadEnd=_this$props9.onMessageLoadEnd,onMessageReadyForDisplay=_this$props9.onMessageReadyForDisplay,onMessageLoadError=_this$props9.onMessageLoadError,isDebug=_this$props9.isDebug,position=_this$props9.position,audioProgressStyle=_this$props9.audioProgressStyle,audioPlayButtonStyle=_this$props9.audioPlayButtonStyle,audioProgressColor=_this$props9.audioProgressColor,audioRemainTimeStyle=_this$props9.audioRemainTimeStyle,audioPlayButtonIconStyle=_this$props9.audioPlayButtonIconStyle;var messageAudioProps={currentMessage:_currentMessage5,audioContainerStyle:audioContainerStyle,audioStyle:audioStyle,audioProps:audioProps,onMessageLoad:onMessageLoad,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,onMessageReadyForDisplay:onMessageReadyForDisplay,onMessageLoadError:onMessageLoadError,isDebug:isDebug,position:position,audioProgressStyle:audioProgressStyle,audioPlayButtonStyle:audioPlayButtonStyle,audioProgressColor:audioProgressColor,audioRemainTimeStyle:audioRemainTimeStyle,audioPlayButtonIconStyle:audioPlayButtonIconStyle};if(this.props.renderMessageAudio){return this.props.renderMessageAudio(messageAudioProps);}return React.createElement(MessageAudio,messageAudioProps);}return null;}},{key:\"renderTicks\",value:function renderTicks(){var _this$props10=this.props,currentMessage=_this$props10.currentMessage,renderTicks=_this$props10.renderTicks,user=_this$props10.user,bunnyKit=_this$props10.bunnyKit;if(renderTicks&&currentMessage){return renderTicks(currentMessage);}if(currentMessage&&user&&currentMessage.user&&currentMessage.user._id!==user._id){return null;}if(currentMessage&&(currentMessage.sent||currentMessage.received||currentMessage.pending)){var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);var wp=sizeLabor.designsBasedOn.iphoneX.wp;return React.createElement(View,{style:styles.content.tickView},!!currentMessage.sent&&React.createElement(Text,{style:[styles.content.tick,this.props.tickStyle]},\"\\u2713\"),!!currentMessage.received&&React.createElement(Text,{style:[styles.content.tick,this.props.tickStyle]},\"\\u2713\"),!!currentMessage.pending&&React.createElement(ActivityIndicator,{color:'white',size:wp(10)}));}return null;}},{key:\"renderTime\",value:function renderTime(){if(this.props.currentMessage&&this.props.currentMessage.createdAt){var _this$props11=this.props,position=_this$props11.position,_currentMessage6=_this$props11.currentMessage,timeContainerStyle=_this$props11.timeContainerStyle,timeFormat=_this$props11.timeFormat,timeTextStyle=_this$props11.timeTextStyle;var _timeProps={position:position,currentMessage:_currentMessage6,timeContainerStyle:timeContainerStyle,timeFormat:timeFormat,timeTextStyle:timeTextStyle};if(this.props.renderTime){return this.props.renderTime(_timeProps);}return React.createElement(Time,_timeProps);}return null;}},{key:\"renderUsername\",value:function renderUsername(){var _this$props12=this.props,currentMessage=_this$props12.currentMessage,user=_this$props12.user,bunnyKit=_this$props12.bunnyKit;if(this.props.renderUsernameOnMessage&&currentMessage){if(user&&currentMessage.user._id===user._id){return null;}var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);return React.createElement(View,{style:styles.content.usernameView},React.createElement(Text,{style:[styles.content.username,this.props.usernameStyle]},\"~ \",currentMessage.user.name));}return null;}},{key:\"renderCustomView\",value:function renderCustomView(){if(this.props.renderCustomView){return this.props.renderCustomView(this.props);}return null;}},{key:\"renderBubbleContent\",value:function renderBubbleContent(){return this.props.isCustomViewBottom?React.createElement(View,null,this.renderMessageImage(),this.renderMessageSticker(),this.renderMessageVideo(),this.renderMessageAudio(),this.renderMessageText(),this.renderCustomView()):React.createElement(View,null,this.renderCustomView(),this.renderMessageImage(),this.renderMessageSticker(),this.renderMessageVideo(),this.renderMessageAudio(),this.renderMessageText());}},{key:\"render\",value:function render(){var _this$props13=this.props,position=_this$props13.position,bubbleContainerStyle=_this$props13.bubbleContainerStyle,bubbleWrapperStyle=_this$props13.bubbleWrapperStyle,bottomContainerStyle=_this$props13.bottomContainerStyle,bunnyKit=_this$props13.bunnyKit;var sizeLabor=bunnyKit.sizeLabor,themeLabor=bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);return React.createElement(View,{style:[styles[position].container,bubbleContainerStyle&&bubbleContainerStyle[position]]},React.createElement(View,{style:[styles[position].wrapper,this.styledBubbleToNext(),this.styledBubbleToPrevious(),bubbleWrapperStyle&&bubbleWrapperStyle[position]]},React.createElement(TouchableWithoutFeedback,_extends({onPress:this.onPress,onLongPress:this.onLongPress,accessibilityTraits:\"text\"},this.props.touchableProps),React.createElement(View,null,this.renderBubbleContent(),React.createElement(View,{style:[styles[position].bottom,bottomContainerStyle&&bottomContainerStyle[position]]},this.renderUsername(),this.renderTime(),this.renderTicks())))),this.renderQuickReplies());}}]);return Bubble;}(React.Component);Bubble.defaultProps={messages:[],touchableProps:{},onPress:undefined,onLongPress:undefined,renderMessageImage:undefined,renderMessageSticker:undefined,renderMessageVideo:undefined,renderMessageAudio:undefined,renderMessageText:undefined,renderCustomView:undefined,renderUsername:undefined,renderTicks:undefined,renderTime:undefined,renderQuickReplies:undefined,onQuickReply:undefined,onMessageLoad:undefined,onMessageLoadStart:undefined,onMessageLoadEnd:undefined,onMessageLoadError:undefined,position:'left',textLongPressOptionTitles:DEFAULT_OPTION_TITLES,currentMessage:undefined,nextMessage:undefined,previousMessage:undefined,bubbleContainerStyle:{},bubbleWrapperStyle:{},bottomContainerStyle:{},tickStyle:{},usernameStyle:{},containerToNextStyle:{},containerToPreviousStyle:{}};export default withBunnyKit(connectActionSheet(Bubble));","map":null,"metadata":{},"sourceType":"module"}