{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import*as React from'react';import{useEffect,useMemo,useState}from'react';import{ThemeLaborContext}from\"./ThemeLaborContext\";import AsyncStorage from'@react-native-async-storage/async-storage';import BunnyConstants,{EThemes}from\"../../constants/constants\";import{collectBizLogicResult,collectSysError}from\"../../store/actions\";import{useColorScheme}from'react-native-appearance';import{useDispatch}from'react-redux';import{Preparing}from\"../../components/Preparing\";import{Provider as PaperProvider}from'react-native-paper';import{getThemes}from\"./theme\";import _ from'lodash';import Dimensions from\"react-native-web/dist/exports/Dimensions\";import{bizLogicError}from\"../../helpers\";export var ThemeLaborProvider=function ThemeLaborProvider(props){var children=props.children;var dispatch=useDispatch();var sysColorSchemeName=useColorScheme();var _useState=useState(getThemes()),_useState2=_slicedToArray(_useState,2),themes=_useState2[0],setThemes=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isReady=_useState4[0],setIsReady=_useState4[1];var _useState5=useState(EThemes.light),_useState6=_slicedToArray(_useState5,2),themeName=_useState6[0],setThemeName=_useState6[1];var _useState7=useState(themes[themeName]),_useState8=_slicedToArray(_useState7,2),theme=_useState8[0],setTheme=_useState8[1];var changeTheme=function changeTheme(themeName){return _regeneratorRuntime.async(function changeTheme$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!Object.keys(EThemes).includes(themeName)){_context.next=7;break;}_context.next=3;return _regeneratorRuntime.awrap(AsyncStorage.setItem(BunnyConstants.THEME_NAME_PERSISTENCE_KEY,themeName));case 3:setThemeName(themeName);setTheme(themes[themeName]);_context.next=8;break;case 7:dispatch(collectBizLogicResult(bizLogicError(\"No \"+themeName+\" \",true)));case 8:case\"end\":return _context.stop();}}},null,null,null,Promise);};useEffect(function(){var bootstrapAsync=function bootstrapAsync(){var themeNameSaved,_themeName;return _regeneratorRuntime.async(function bootstrapAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(BunnyConstants.THEME_NAME_PERSISTENCE_KEY));case 3:themeNameSaved=_context2.sent;if(themeNameSaved){_themeName=themeNameSaved;}else if(sysColorSchemeName){_themeName=sysColorSchemeName===EThemes.dark?EThemes.dark:EThemes.light;}else{_themeName=EThemes.light;}_context2.next=7;return _regeneratorRuntime.awrap(changeTheme(_themeName));case 7:_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);dispatch(collectSysError(_context2.t0));case 12:case\"end\":return _context2.stop();}}},null,null,[[0,9]],Promise);};bootstrapAsync().then(function(){setIsReady(true);});},[]);useEffect(function(){setTheme(themes[themeName]);},[themes]);useEffect(function(){var onDimensionsChange=_.throttle(function(){setThemes(getThemes());},BunnyConstants.throttleWait);Dimensions.addEventListener('change',onDimensionsChange);return function(){return Dimensions.removeEventListener('change',onDimensionsChange);};});var themeLaborMemorized=useMemo(function(){return{theme:theme,currentThemeName:themeName,themes:themes,changeTheme:changeTheme,sysColorSchemeName:sysColorSchemeName};},[theme,changeTheme,themeName,sysColorSchemeName]);return isReady?React.createElement(ThemeLaborContext.Provider,{value:themeLaborMemorized},React.createElement(PaperProvider,{theme:themeLaborMemorized.theme},children)):React.createElement(Preparing,{text:\"Theme Provider loading\"});};","map":null,"metadata":{},"sourceType":"module"}