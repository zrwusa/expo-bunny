{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{InButtonText,LinearGradientButton,Text,TextInputIcon,View}from\"../../components/UI\";import*as React from'react';import{useState}from'react';import{useDispatch}from'react-redux';import{shortenTFunctionKey}from\"../../providers/i18n-labor\";import{InputCard,makeContainerStyles,Row}from\"../../containers\";import{useAuthLabor}from\"../../providers/auth-labor\";import{LinearGradientIcon}from\"../../components/LinearGradientIcon\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import{collectBizLogicResult,collectSysError}from\"../../store/actions\";import{makeStyles}from\"./styles\";import{LoginVector}from\"../../components/LoginVector\";import{FirebasePhoneLogin}from\"../../components/FirebasePhoneLogin\";import{Tab}from\"../../components/Tab\";import{ForgotPassword}from\"../../components/ForgotPassword\";import{navToReference}from\"../../helpers\";import{useBunnyKit}from\"../../hooks/bunny-kit\";export function LoginScreen(_ref){var route=_ref.route,navigation=_ref.navigation,isBunnyAuth=_ref.isBunnyAuth;var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp,t=_useBunnyKit.t,ms=_useBunnyKit.ms;var st=shortenTFunctionKey(t,'screens.Auth');var containerStyles=makeContainerStyles(sizeLabor,themeLabor);var styles=makeStyles(sizeLabor,themeLabor);var _useAuthLabor=useAuthLabor(),authFunctions=_useAuthLabor.authFunctions;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var dispatch=useDispatch();var firebaseLoginMethods=['email','phone'];var _useState5=useState('email'),_useState6=_slicedToArray(_useState5,2),loginMethod=_useState6[0],setLoginMethod=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isForgot=_useState8[0],setIsForgot=_useState8[1];var firebaseEmailLogin=function firebaseEmailLogin(){var result;return _regeneratorRuntime.async(function firebaseEmailLogin$(_context){while(1){switch(_context.prev=_context.next){case 0:Keyboard.dismiss();_context.prev=1;_context.next=4;return _regeneratorRuntime.awrap(authFunctions.firebaseEmailLogin(email,password,true));case 4:result=_context.sent;if(result.success){navToReference(route,navigation);}else{dispatch(collectBizLogicResult(result));}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch(collectSysError(_context.t0));case 11:case\"end\":return _context.stop();}}},null,null,[[1,8]],Promise);};var bunnyLogin=function bunnyLogin(){var result;return _regeneratorRuntime.async(function bunnyLogin$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:Keyboard.dismiss();_context2.prev=1;_context2.next=4;return _regeneratorRuntime.awrap(authFunctions.bunnyLogin({username:email,password:password}));case 4:result=_context2.sent;if(result.success){navToReference(route,navigation);}else{dispatch(collectBizLogicResult(result));}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(collectSysError(_context2.t0));case 11:case\"end\":return _context2.stop();}}},null,null,[[1,8]],Promise);};var handleLogin=function handleLogin(){return _regeneratorRuntime.async(function handleLogin$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!isBunnyAuth){_context3.next=5;break;}_context3.next=3;return _regeneratorRuntime.awrap(bunnyLogin());case 3:_context3.next=7;break;case 5:_context3.next=7;return _regeneratorRuntime.awrap(firebaseEmailLogin());case 7:case\"end\":return _context3.stop();}}},null,null,null,Promise);};return React.createElement(View,{style:[containerStyles.Screen]},React.createElement(ScrollView,{style:styles.loginOrSignUpContainer},React.createElement(Tab,{items:firebaseLoginMethods,value:loginMethod,onChange:function onChange(item){setLoginMethod(item);}}),loginMethod==='email'&&!isForgot?React.createElement(View,null,React.createElement(InputCard,{title:st(\"email\")},React.createElement(TextInputIcon,{placeholder:t(\"placeholders.email\"),textContentType:\"emailAddress\",value:email,onChangeText:function onChangeText(value){setEmail(value);},renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"mail\",size:wp(20)});}})),React.createElement(InputCard,{title:st(\"password\")},React.createElement(TextInputIcon,{placeholder:t(\"placeholders.password\"),textContentType:\"password\",value:password,onChangeText:function onChangeText(value){setPassword(value);},secureTextEntry:true,renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"lock\",size:wp(22)});}})),React.createElement(Row,{style:{marginTop:ms.sp.l,justifyContent:'flex-end'}},React.createElement(TouchableOpacity,{onPress:function onPress(){setIsForgot(true);}},React.createElement(Text,null,\"Forgot password?\"))),React.createElement(Row,{style:{marginTop:ms.sp.l}},React.createElement(LinearGradientButton,{onPress:handleLogin},React.createElement(InButtonText,null,st(\"login\"))))):null,loginMethod==='phone'?React.createElement(FirebasePhoneLogin,{route:route,navigation:navigation}):null,loginMethod==='email'&&isForgot?React.createElement(ForgotPassword,{route:route,navigation:navigation,onSent:function onSent(){setIsForgot(false);},onCancel:function onCancel(){setIsForgot(false);},email:email}):null,React.createElement(LoginVector,{route:route,navigation:navigation})));}","map":null,"metadata":{},"sourceType":"module"}