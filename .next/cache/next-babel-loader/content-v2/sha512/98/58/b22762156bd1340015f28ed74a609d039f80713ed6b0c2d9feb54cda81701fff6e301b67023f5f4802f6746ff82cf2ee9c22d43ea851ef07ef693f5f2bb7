{"ast":null,"code":"var _s=$RefreshSig$();import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _this=this,_jsxFileName=\"/Users/revone/projects/expo-react-bunny/src/components/FirebasePhoneLogin/FirebasePhoneLogin.tsx\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import View from\"react-native-web/dist/exports/View\";import*as React from'react';import{InputCard,Row}from\"../../containers\";import{InButtonText,LinearGradientButton,Text,TextInputIcon}from\"../UI\";import{LinearGradientIcon}from\"../LinearGradientIcon\";import*as FirebaseRecaptcha from'expo-firebase-recaptcha';import{FIREBASE_CONFIG}from\"../../firebase\";import{shortenTFunctionKey}from\"../../providers/i18n-labor\";import{makeStyles}from\"./styles\";import{useAuthLabor}from\"../../providers/auth-labor\";import{useDispatch}from'react-redux';import{collectBizLogicResult}from\"../../store/actions\";import{navToReference}from\"../../helpers\";import{useBunnyKit}from\"../../hooks/bunny-kit\";export var FirebasePhoneLogin=function FirebasePhoneLogin(_ref){_s();var route=_ref.route,navigation=_ref.navigation;var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,t=_useBunnyKit.t,wp=_useBunnyKit.wp;var st=shortenTFunctionKey(t,'screens.Auth');var styles=makeStyles(sizeLabor,themeLabor);var _useAuthLabor=useAuthLabor(),authFunctions=_useAuthLabor.authFunctions;var dispatch=useDispatch();var recaptchaVerifier=React.useRef(null);var verificationCodeTextInput=React.useRef(null);var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),phoneNumber=_React$useState2[0],setPhoneNumber=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),verificationId=_React$useState4[0],setVerificationId=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),verifyError=_React$useState6[0],setVerifyError=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),verifyInProgress=_React$useState8[0],setVerifyInProgress=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),verificationCode=_React$useState10[0],setVerificationCode=_React$useState10[1];var _React$useState11=React.useState(''),_React$useState12=_slicedToArray(_React$useState11,2),confirmError=_React$useState12[0],setConfirmError=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),confirmInProgress=_React$useState14[0],setConfirmInProgress=_React$useState14[1];var isConfigValid=!!FIREBASE_CONFIG.apiKey;var firebaseSendOTP=function firebaseSendOTP(){var result,_verificationCodeText,_verificationId;return _regeneratorRuntime.async(function firebaseSendOTP$(_context){while(1){switch(_context.prev=_context.next){case 0:setVerifyError('');setVerifyInProgress(true);setVerificationId('');_context.prev=3;_context.next=6;return _regeneratorRuntime.awrap(authFunctions.firebaseSendOTP(phoneNumber,recaptchaVerifier.current));case 6:result=_context.sent;if(result.success){_verificationId=result.data.verificationId;setVerifyInProgress(false);setVerificationId(_verificationId);(_verificationCodeText=verificationCodeTextInput.current)==null?void 0:_verificationCodeText.focus();}else{dispatch(collectBizLogicResult(result));}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);setVerifyError(_context.t0.message);setVerifyInProgress(false);case 14:case\"end\":return _context.stop();}}},null,null,[[3,10]],Promise);};var firebaseConfirmOTP=function firebaseConfirmOTP(){var result,_verificationCodeText2;return _regeneratorRuntime.async(function firebaseConfirmOTP$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setConfirmError('');setConfirmInProgress(true);_context2.prev=2;_context2.next=5;return _regeneratorRuntime.awrap(authFunctions.firebaseConfirmOTP(verificationId,verificationCode,true));case 5:result=_context2.sent;if(result.success){setConfirmInProgress(false);setVerificationId('');setVerificationCode('');(_verificationCodeText2=verificationCodeTextInput.current)==null?void 0:_verificationCodeText2.clear();navToReference(route,navigation);}else{dispatch(collectBizLogicResult(result));}_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);setConfirmError(_context2.t0.message);setConfirmInProgress(false);case 13:case\"end\":return _context2.stop();}}},null,null,[[2,9]],Promise);};return React.createElement(View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:12}},React.createElement(View,{style:styles.contentPhone,__self:_this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:9}},React.createElement(InputCard,{title:st(\"enterPhoneNumber\"),__self:_this,__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:13}},React.createElement(TextInputIcon,{autoCompleteType:\"tel\",keyboardType:\"phone-pad\",textContentType:\"telephoneNumber\",placeholder:t(\"placeholders.phone\"),editable:!verificationId,onChangeText:function onChangeText(phoneNumber){return setPhoneNumber(phoneNumber);},renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"phone\",size:wp(20),__self:_this,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:32}});},__self:_this,__source:{fileName:_jsxFileName,lineNumber:88,columnNumber:17}})),React.createElement(Row,{paddingVertical:\"xxl\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:101,columnNumber:13}},React.createElement(LinearGradientButton,{disabled:!phoneNumber,onPress:firebaseSendOTP,__self:_this,__source:{fileName:_jsxFileName,lineNumber:102,columnNumber:17}},React.createElement(InButtonText,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:106,columnNumber:21}},(verificationId?st('resend'):st('send'))+\" \"+st('verificationCode')))),React.createElement(Row,{style:styles.recaptchaVerifierModal,__self:_this,__source:{fileName:_jsxFileName,lineNumber:109,columnNumber:13}},React.createElement(FirebaseRecaptcha.FirebaseRecaptchaVerifierModal,{ref:recaptchaVerifier,firebaseConfig:FIREBASE_CONFIG,__self:_this,__source:{fileName:_jsxFileName,lineNumber:110,columnNumber:17}})),verifyError?React.createElement(Text,{style:styles.error,__self:_this,__source:{fileName:_jsxFileName,lineNumber:115,columnNumber:28}},\"Error: \"+verifyError):null,verifyInProgress&&React.createElement(ActivityIndicator,{style:styles.loader,__self:_this,__source:{fileName:_jsxFileName,lineNumber:116,columnNumber:34}}),verificationId?React.createElement(Text,{style:styles.success,__self:_this,__source:{fileName:_jsxFileName,lineNumber:118,columnNumber:17}},st(\"otpSentSuccess\")):null,React.createElement(InputCard,{title:st(\"enterVerificationCode\"),__self:_this,__source:{fileName:_jsxFileName,lineNumber:120,columnNumber:13}},React.createElement(TextInputIcon,{ref:verificationCodeTextInput,editable:!!verificationId,placeholder:t(\"placeholders.otp\"),onChangeText:function onChangeText(verificationCode){return setVerificationCode(verificationCode);},renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"sort-numerically-outline\",size:wp(20),__self:_this,__source:{fileName:_jsxFileName,lineNumber:127,columnNumber:32}});},__self:_this,__source:{fileName:_jsxFileName,lineNumber:121,columnNumber:17}})),React.createElement(Row,{paddingVertical:\"xxl\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:131,columnNumber:13}},React.createElement(LinearGradientButton,{disabled:!verificationCode,onPress:firebaseConfirmOTP,__self:_this,__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:17}},React.createElement(InButtonText,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:136,columnNumber:21}},st('firebaseConfirmOTP')))),confirmError?React.createElement(Text,{style:styles.error,__self:_this,__source:{fileName:_jsxFileName,lineNumber:139,columnNumber:29}},\"Error: \"+confirmError):null,confirmInProgress?React.createElement(ActivityIndicator,{style:styles.loader,__self:_this,__source:{fileName:_jsxFileName,lineNumber:140,columnNumber:34}}):null),!isConfigValid&&React.createElement(View,{style:styles.overlay,pointerEvents:\"none\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:143,columnNumber:13}},React.createElement(Text,{style:styles.overlayText,__self:_this,__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:17}},\"To get started, set a valid FIREBASE_CONFIG in App.tsx.\")));};_s(FirebasePhoneLogin,\"C5EYGSgHat0jOw/455GTEKVs+KE=\",false,function(){return[useBunnyKit,useAuthLabor,useDispatch];});_c=FirebasePhoneLogin;var _c;$RefreshReg$(_c,\"FirebasePhoneLogin\");","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/components/FirebasePhoneLogin/FirebasePhoneLogin.tsx"],"names":["FirebasePhoneLogin","route","navigation","sizeLabor","themeLabor","t","wp","useBunnyKit","st","shortenTFunctionKey","styles","makeStyles","authFunctions","useAuthLabor","dispatch","useDispatch","recaptchaVerifier","React","verificationCodeTextInput","phoneNumber","setPhoneNumber","verificationId","setVerificationId","verifyError","setVerifyError","verifyInProgress","setVerifyInProgress","verificationCode","setVerificationCode","confirmError","setConfirmError","confirmInProgress","setConfirmInProgress","isConfigValid","FIREBASE_CONFIG","firebaseSendOTP","result","collectBizLogicResult","firebaseConfirmOTP","navToReference"],"mappings":"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","sourcesContent":["import {ActivityIndicator, TextInput, View} from 'react-native';\nimport * as React from 'react';\nimport {InputCard, Row} from '../../containers';\nimport {InButtonText, LinearGradientButton, Text, TextInputIcon} from '../UI';\nimport {LinearGradientIcon} from '../LinearGradientIcon';\nimport * as FirebaseRecaptcha from 'expo-firebase-recaptcha';\nimport {FIREBASE_CONFIG} from '../../firebase';\nimport {shortenTFunctionKey} from '../../providers/i18n-labor';\nimport {makeStyles} from './styles';\nimport {useAuthLabor} from '../../providers/auth-labor';\nimport {RouteProp} from '@react-navigation/native';\nimport {AuthTopStackParam, RootStackParam} from '../../types';\nimport {StackNavigationProp} from '@react-navigation/stack';\nimport {useDispatch} from 'react-redux';\nimport {collectBizLogicResult} from '../../store/actions';\nimport {navToReference} from '../../helpers';\nimport {useBunnyKit} from '../../hooks/bunny-kit';\n\ntype FirebasePhoneLoginRouteProp = RouteProp<AuthTopStackParam, 'Login'>;\ntype FirebasePhoneLoginNavigationProp = StackNavigationProp<RootStackParam, 'Auth'>;\n\nexport interface FirebasePhoneLoginProps {\n    route: FirebasePhoneLoginRouteProp;\n    navigation: FirebasePhoneLoginNavigationProp;\n}\n\nexport const FirebasePhoneLogin = ({route, navigation}: FirebasePhoneLoginProps) => {\n    const {sizeLabor, themeLabor, t, wp} = useBunnyKit();\n    const st = shortenTFunctionKey(t, 'screens.Auth');\n    const styles = makeStyles(sizeLabor, themeLabor);\n    const {authFunctions} = useAuthLabor();\n    const dispatch = useDispatch();\n\n    const recaptchaVerifier = React.useRef<FirebaseRecaptcha.FirebaseRecaptchaVerifierModal>(null);\n    const verificationCodeTextInput = React.useRef<TextInput>(null);\n    const [phoneNumber, setPhoneNumber] = React.useState('');\n    const [verificationId, setVerificationId] = React.useState('');\n    const [verifyError, setVerifyError] = React.useState('');\n    const [verifyInProgress, setVerifyInProgress] = React.useState(false);\n    const [verificationCode, setVerificationCode] = React.useState('');\n    const [confirmError, setConfirmError] = React.useState('');\n    const [confirmInProgress, setConfirmInProgress] = React.useState(false);\n    const isConfigValid = !!FIREBASE_CONFIG.apiKey;\n\n    const firebaseSendOTP = async () => {\n        setVerifyError('');\n        setVerifyInProgress(true);\n        setVerificationId('');\n        try {\n            const result = await authFunctions.firebaseSendOTP(phoneNumber,\n                // @ts-ignore\n                recaptchaVerifier.current);\n            if (result.success) {\n                const {verificationId} = result.data;\n                setVerifyInProgress(false);\n                setVerificationId(verificationId);\n                verificationCodeTextInput.current?.focus();\n            } else {\n                dispatch(collectBizLogicResult(result));\n            }\n        } catch (e: any) {\n            setVerifyError(e.message);\n            setVerifyInProgress(false);\n        }\n    };\n    const firebaseConfirmOTP = async () => {\n        setConfirmError('');\n        setConfirmInProgress(true);\n        try {\n            const result = await authFunctions.firebaseConfirmOTP(verificationId, verificationCode, true);\n            if (result.success) {\n                setConfirmInProgress(false);\n                setVerificationId('');\n                setVerificationCode('');\n                verificationCodeTextInput.current?.clear();\n                navToReference(route, navigation);\n            } else {\n                dispatch(collectBizLogicResult(result));\n            }\n        } catch (e: any) {\n            setConfirmError(e.message);\n            setConfirmInProgress(false);\n        }\n    };\n    return <View>\n        <View style={styles.contentPhone}>\n            <InputCard title={st(`enterPhoneNumber`)}>\n                <TextInputIcon\n                    // autoFocus={isConfigValid}\n                    autoCompleteType=\"tel\"\n                    keyboardType=\"phone-pad\"\n                    textContentType=\"telephoneNumber\"\n                    placeholder={t(`placeholders.phone`)}\n                    editable={!verificationId}\n                    onChangeText={(phoneNumber: string) => setPhoneNumber(phoneNumber)}\n                    renderIcon={() => {\n                        return <LinearGradientIcon name=\"phone\" size={wp(20)}/>;\n                    }}\n                />\n            </InputCard>\n            <Row paddingVertical=\"xxl\">\n                <LinearGradientButton\n                    disabled={!phoneNumber}\n                    onPress={firebaseSendOTP}\n                >\n                    <InButtonText>{`${verificationId ? st('resend') : st('send')} ${st('verificationCode')}`}</InButtonText>\n                </LinearGradientButton>\n            </Row>\n            <Row style={styles.recaptchaVerifierModal}>\n                <FirebaseRecaptcha.FirebaseRecaptchaVerifierModal\n                    ref={recaptchaVerifier}\n                    firebaseConfig={FIREBASE_CONFIG}\n                />\n            </Row>\n            {verifyError ? <Text style={styles.error}>{`Error: ${verifyError}`}</Text> : null}\n            {verifyInProgress && <ActivityIndicator style={styles.loader}/>}\n            {verificationId ? (\n                <Text style={styles.success}>{st(`otpSentSuccess`)}</Text>\n            ) : null}\n            <InputCard title={st(`enterVerificationCode`)}>\n                <TextInputIcon\n                    ref={verificationCodeTextInput}\n                    editable={!!verificationId}\n                    placeholder={t(`placeholders.otp`)}\n                    onChangeText={(verificationCode: string) => setVerificationCode(verificationCode)}\n                    renderIcon={() => {\n                        return <LinearGradientIcon name=\"sort-numerically-outline\" size={wp(20)}/>;\n                    }}\n                />\n            </InputCard>\n            <Row paddingVertical=\"xxl\">\n                <LinearGradientButton\n                    disabled={!verificationCode}\n                    onPress={firebaseConfirmOTP}\n                >\n                    <InButtonText>{st('firebaseConfirmOTP')}</InButtonText>\n                </LinearGradientButton>\n            </Row>\n            {confirmError ? <Text style={styles.error}>{`Error: ${confirmError}`}</Text> : null}\n            {confirmInProgress ? <ActivityIndicator style={styles.loader}/> : null}\n        </View>\n        {!isConfigValid && (\n            <View style={styles.overlay} pointerEvents=\"none\">\n                <Text style={styles.overlayText}>\n                    To get started, set a valid FIREBASE_CONFIG in App.tsx.\n                </Text>\n            </View>\n        )}\n    </View>;\n};\n"]},"metadata":{},"sourceType":"module"}