{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _jsxFileName=\"/Users/revone/projects/expo-react-bunny/src/screens/Auth/Login.tsx\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{InButtonText,LinearGradientButton,Text,TextInputIcon,View}from\"../../components/UI\";import*as React from'react';import{useState}from'react';import{useDispatch}from'react-redux';import{shortenTFunctionKey}from\"../../providers/i18n-labor\";import{InputCard,makeContainerStyles,Row}from\"../../containers\";import{useAuthLabor}from\"../../providers/auth-labor\";import{LinearGradientIcon}from\"../../components/LinearGradientIcon\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import{collectBizLogicResult,collectSysError}from\"../../store/actions\";import{makeStyles}from\"./styles\";import{LoginVector}from\"../../components/LoginVector\";import{FirebasePhoneLogin}from\"../../components/FirebasePhoneLogin\";import{Tab}from\"../../components/Tab\";import{ForgotPassword}from\"../../components/ForgotPassword\";import{navToReference}from\"../../helpers\";import{useBunnyKit}from\"../../hooks/bunny-kit\";export function LoginScreen(_ref){var _this=this;var route=_ref.route,navigation=_ref.navigation,isBunnyAuth=_ref.isBunnyAuth;var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp,t=_useBunnyKit.t,ms=_useBunnyKit.ms;var st=shortenTFunctionKey(t,'screens.Auth');var containerStyles=makeContainerStyles(sizeLabor,themeLabor);var styles=makeStyles(sizeLabor,themeLabor);var _useAuthLabor=useAuthLabor(),authFunctions=_useAuthLabor.authFunctions;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var dispatch=useDispatch();var firebaseLoginMethods=['email','phone'];var _useState5=useState('email'),_useState6=_slicedToArray(_useState5,2),loginMethod=_useState6[0],setLoginMethod=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isForgot=_useState8[0],setIsForgot=_useState8[1];var firebaseEmailLogin=function firebaseEmailLogin(){var result;return _regeneratorRuntime.async(function firebaseEmailLogin$(_context){while(1){switch(_context.prev=_context.next){case 0:Keyboard.dismiss();_context.prev=1;_context.next=4;return _regeneratorRuntime.awrap(authFunctions.firebaseEmailLogin(email,password,true));case 4:result=_context.sent;if(result.success){navToReference(route,navigation);}else{dispatch(collectBizLogicResult(result));}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch(collectSysError(_context.t0));case 11:case\"end\":return _context.stop();}}},null,null,[[1,8]],Promise);};var bunnyLogin=function bunnyLogin(){var result;return _regeneratorRuntime.async(function bunnyLogin$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:Keyboard.dismiss();_context2.prev=1;_context2.next=4;return _regeneratorRuntime.awrap(authFunctions.bunnyLogin({username:email,password:password}));case 4:result=_context2.sent;if(result.success){navToReference(route,navigation);}else{dispatch(collectBizLogicResult(result));}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(collectSysError(_context2.t0));case 11:case\"end\":return _context2.stop();}}},null,null,[[1,8]],Promise);};var handleLogin=function handleLogin(){return _regeneratorRuntime.async(function handleLogin$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!isBunnyAuth){_context3.next=5;break;}_context3.next=3;return _regeneratorRuntime.awrap(bunnyLogin());case 3:_context3.next=7;break;case 5:_context3.next=7;return _regeneratorRuntime.awrap(firebaseEmailLogin());case 7:case\"end\":return _context3.stop();}}},null,null,null,Promise);};return React.createElement(View,{style:[containerStyles.Screen],__self:this,__source:{fileName:_jsxFileName,lineNumber:77,columnNumber:12}},React.createElement(ScrollView,{style:styles.loginOrSignUpContainer,__self:this,__source:{fileName:_jsxFileName,lineNumber:78,columnNumber:9}},React.createElement(Tab,{items:firebaseLoginMethods,value:loginMethod,onChange:function onChange(item){setLoginMethod(item);},__self:this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:13}}),loginMethod==='email'&&!isForgot?React.createElement(View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:84,columnNumber:17}},React.createElement(InputCard,{title:st(\"email\"),__self:this,__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:21}},React.createElement(TextInputIcon,{placeholder:t(\"placeholders.email\"),textContentType:\"emailAddress\",value:email,onChangeText:function onChangeText(value){setEmail(value);},renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"mail\",size:wp(20),__self:_this,__source:{fileName:_jsxFileName,lineNumber:93,columnNumber:51}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:25}})),React.createElement(InputCard,{title:st(\"password\"),__self:this,__source:{fileName:_jsxFileName,lineNumber:96,columnNumber:21}},React.createElement(TextInputIcon,{placeholder:t(\"placeholders.password\"),textContentType:\"password\",value:password,onChangeText:function onChangeText(value){setPassword(value);},secureTextEntry:true,renderIcon:function renderIcon(){return React.createElement(LinearGradientIcon,{name:\"lock\",size:wp(22),__self:_this,__source:{fileName:_jsxFileName,lineNumber:105,columnNumber:51}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:25}})),React.createElement(Row,{style:{marginTop:ms.sp.l,justifyContent:'flex-end'},__self:this,__source:{fileName:_jsxFileName,lineNumber:109,columnNumber:21}},React.createElement(TouchableOpacity,{onPress:function onPress(){setIsForgot(true);},__self:this,__source:{fileName:_jsxFileName,lineNumber:110,columnNumber:25}},React.createElement(Text,{__self:this,__source:{fileName:_jsxFileName,lineNumber:114,columnNumber:27}},\"Forgot password?\"))),React.createElement(Row,{style:{marginTop:ms.sp.l},__self:this,__source:{fileName:_jsxFileName,lineNumber:116,columnNumber:21}},React.createElement(LinearGradientButton,{onPress:handleLogin,__self:this,__source:{fileName:_jsxFileName,lineNumber:117,columnNumber:25}},React.createElement(InButtonText,{__self:this,__source:{fileName:_jsxFileName,lineNumber:118,columnNumber:29}},st(\"login\"))))):null,loginMethod==='phone'?React.createElement(FirebasePhoneLogin,{route:route,navigation:navigation,__self:this,__source:{fileName:_jsxFileName,lineNumber:126,columnNumber:23}}):null,loginMethod==='email'&&isForgot?React.createElement(ForgotPassword,{route:route,navigation:navigation,onSent:function onSent(){setIsForgot(false);},onCancel:function onCancel(){setIsForgot(false);},email:email,__self:this,__source:{fileName:_jsxFileName,lineNumber:131,columnNumber:23}}):null,React.createElement(LoginVector,{route:route,navigation:navigation,__self:this,__source:{fileName:_jsxFileName,lineNumber:143,columnNumber:13}})));}","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/screens/Auth/Login.tsx"],"names":["route","navigation","isBunnyAuth","sizeLabor","themeLabor","wp","t","ms","useBunnyKit","st","shortenTFunctionKey","containerStyles","makeContainerStyles","styles","makeStyles","authFunctions","useAuthLabor","email","setEmail","useState","password","setPassword","dispatch","useDispatch","firebaseLoginMethods","loginMethod","setLoginMethod","isForgot","setIsForgot","firebaseEmailLogin","Keyboard","result","navToReference","collectBizLogicResult","collectSysError","bunnyLogin","username","handleLogin","marginTop","justifyContent","l"],"mappings":"mNAAA,OAAA,YAAA,CAAA,oBAAA,CAAA,IAAA,CAAA,aAAA,CAAA,IAAA,2BACA,MAAO,GAAP,CAAA,KAAA,KAAA,OAAA,CACA,OAAA,QAAA,KAAA,OAAA,CACA,OAAA,WAAA,KAAA,aAAA,CACA,OAAA,mBAAA,kCACA,OAAA,SAAA,CAAA,mBAAA,CAAA,GAAA,wBACA,OAAA,YAAA,kCAIA,OAAA,kBAAA,2C,2MAEA,OAAA,qBAAA,CAAA,eAAA,2BACA,OAAA,UAAA,gBACA,OAAA,WAAA,oCACA,OAAA,kBAAA,2CACA,OAAA,GAAA,4BACA,OAAA,cAAA,uCACA,OAAA,cAAA,qBACA,OAAA,WAAA,6BAWA,MAAO,SAAA,CAAA,WAAA,CAAA,IAAA,CAAmE,CAAA,GAAA,CAAA,KAAA,CAAA,IAAA,CAAA,GAA7CA,CAAAA,KAA6C,CAAA,IAAA,CAA7CA,KAA6C,CAAtCC,UAAsC,CAAA,IAAA,CAAtCA,UAAsC,CAA1BC,WAA0B,CAAA,IAAA,CAA1BA,WAA0B,CACtE,GAAA,CAAA,YAAA,CAA2CM,WAA3C,EAAA,CAAOL,SAAP,CAAA,YAAA,CAAA,SAAA,CAAkBC,UAAlB,CAAA,YAAA,CAAA,UAAA,CAA8BC,EAA9B,CAAA,YAAA,CAAA,EAAA,CAAkCC,CAAlC,CAAA,YAAA,CAAA,CAAA,CAAqCC,EAArC,CAAA,YAAA,CAAA,EAAA,CACA,GAAME,CAAAA,EAAE,CAAGC,mBAAmB,CAAA,CAAA,CAA9B,cAA8B,CAA9B,CACA,GAAMC,CAAAA,eAAe,CAAGC,mBAAmB,CAAA,SAAA,CAA3C,UAA2C,CAA3C,CACA,GAAMC,CAAAA,MAAM,CAAGC,UAAU,CAAA,SAAA,CAAzB,UAAyB,CAAzB,CACA,GAAA,CAAA,aAAA,CAAwBE,YAAxB,EAAA,CAAOD,aAAP,CAAA,aAAA,CAAA,aAAA,CACA,GAAA,CAAA,SAAA,CAA0BI,QAAQ,CAAlC,EAAkC,CAAlC,CAAA,UAAA,CAAA,cAAA,CAAA,SAAA,CAAA,CAAA,CAAA,CAAOF,KAAP,CAAA,UAAA,CAAA,CAAA,CAAA,CAAcC,QAAd,CAAA,UAAA,CAAA,CAAA,CAAA,CACA,GAAA,CAAA,UAAA,CAAgCC,QAAQ,CAAxC,EAAwC,CAAxC,CAAA,UAAA,CAAA,cAAA,CAAA,UAAA,CAAA,CAAA,CAAA,CAAOC,QAAP,CAAA,UAAA,CAAA,CAAA,CAAA,CAAiBC,WAAjB,CAAA,UAAA,CAAA,CAAA,CAAA,CACA,GAAMC,CAAAA,QAAQ,CAAGC,WAAjB,EAAA,CACA,GAAMC,CAAAA,oBAAoB,CAAG,CAAA,OAAA,CAA7B,OAA6B,CAA7B,CACA,GAAA,CAAA,UAAA,CAAsCL,QAAQ,CAA9C,OAA8C,CAA9C,CAAA,UAAA,CAAA,cAAA,CAAA,UAAA,CAAA,CAAA,CAAA,CAAOM,WAAP,CAAA,UAAA,CAAA,CAAA,CAAA,CAAoBC,cAApB,CAAA,UAAA,CAAA,CAAA,CAAA,CACA,GAAA,CAAA,UAAA,CAAgCP,QAAQ,CAAxC,KAAwC,CAAxC,CAAA,UAAA,CAAA,cAAA,CAAA,UAAA,CAAA,CAAA,CAAA,CAAOQ,QAAP,CAAA,UAAA,CAAA,CAAA,CAAA,CAAiBC,WAAjB,CAAA,UAAA,CAAA,CAAA,CAAA,CAEA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAA,CAAA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,mBAAA,CAAA,QAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,OAAA,QAAA,CAAA,IAAA,CAAA,QAAA,CAAA,IAAA,EAAA,IAAA,EAAA,CACvBC,QAAQ,CAARA,OAAAA,GADuB,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAIEf,aAAa,CAAbA,kBAAAA,CAAAA,KAAAA,CAAAA,QAAAA,CAJF,IAIEA,CAJF,CAAA,CAAA,IAAA,EAAA,CAIbgB,MAJa,CAAA,QAAA,CAAA,IAIbA,CACN,GAAIA,MAAM,CAAV,OAAA,CAAoB,CAChBC,cAAc,CAAA,KAAA,CAAdA,UAAc,CAAdA,CADJ,CAAA,IAEO,CACHV,QAAQ,CAACW,qBAAqB,CAA9BX,MAA8B,CAAtB,CAARA,CACH,CATkB,QAAA,CAAA,IAAA,CAAA,EAAA,CAAA,MAAA,IAAA,EAAA,CAAA,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,QAAA,CAAA,EAAA,CAAA,QAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAWnBA,QAAQ,CAACY,eAAe,CAAA,QAAA,CAAxBZ,EAAwB,CAAhB,CAARA,CAXmB,IAAA,GAAA,CAAA,IAAA,KAAA,CAAA,MAAA,CAAA,QAAA,CAAA,IAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,OAAA,CAAA,CAA3B,CAAA,CAeA,GAAMa,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAA,CAAA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,WAAA,CAAA,SAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,OAAA,SAAA,CAAA,IAAA,CAAA,SAAA,CAAA,IAAA,EAAA,IAAA,EAAA,CACfL,QAAQ,CAARA,OAAAA,GADe,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAGU,aAAa,CAAb,UAAA,CAAyB,CAACM,QAAQ,CAAT,KAAA,CAAkBhB,QAAQ,CAARA,QAAlB,CAAzB,CAHV,CAAA,CAAA,IAAA,EAAA,CAGLW,MAHK,CAAA,SAAA,CAAA,IAGLA,CACN,GAAIA,MAAM,CAAV,OAAA,CAAoB,CAChBC,cAAc,CAAA,KAAA,CAAdA,UAAc,CAAdA,CADJ,CAAA,IAEO,CACHV,QAAQ,CAACW,qBAAqB,CAA9BX,MAA8B,CAAtB,CAARA,CACH,CARU,SAAA,CAAA,IAAA,CAAA,EAAA,CAAA,MAAA,IAAA,EAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,SAAA,CAAA,EAAA,CAAA,SAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAUXA,QAAQ,CAACY,eAAe,CAAA,SAAA,CAAxBZ,EAAwB,CAAhB,CAARA,CAVW,IAAA,GAAA,CAAA,IAAA,KAAA,CAAA,MAAA,CAAA,SAAA,CAAA,IAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,OAAA,CAAA,CAAnB,CAAA,CAcA,GAAMe,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,YAAA,CAAA,SAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,OAAA,SAAA,CAAA,IAAA,CAAA,SAAA,CAAA,IAAA,EAAA,IAAA,EAAA,CAAA,GAAA,CAAA,WAAA,CAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CACIF,UADJ,EAAA,CAAA,CAAA,IAAA,EAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,IAAA,EAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CACyBN,kBADzB,EAAA,CAAA,CAAA,IAAA,EAAA,CAAA,IAAA,KAAA,CAAA,MAAA,CAAA,SAAA,CAAA,IAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CAApB,CAAA,CAIA,MAAO,CAAA,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA,CAAM,KAAK,CAAE,CAAClB,eAAe,CAA7B,MAAa,CAAb,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACH,KAAA,CAAA,aAAA,CAAA,UAAA,CAAA,CAAY,KAAK,CAAEE,MAAM,CAAzB,sBAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,CAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,GAAA,CAAA,CAAK,KAAK,CAAV,oBAAA,CAAkC,KAAK,CAAvC,WAAA,CAAsD,QAAQ,CAAE,QAAA,CAAA,QAAA,CAAA,IAAA,CAAU,CACtEa,cAAc,CAAdA,IAAc,CAAdA,CADJ,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CADJ,CAIKD,WAAW,GAAXA,OAAAA,EAA2B,CAA3BA,QAAAA,CAEG,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,SAAA,CAAA,CAAW,KAAK,CAAEhB,EAAE,CAApB,OAAoB,CAApB,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,aAAA,CAAA,CAAe,WAAW,CAAEH,CAAC,CAA7B,oBAA6B,CAA7B,CACe,eAAe,CAD9B,cAAA,CAEe,KAAK,CAFpB,KAAA,CAGe,YAAY,CAAE,QAAA,CAAA,YAAA,CAAA,KAAA,CAAW,CACrBY,QAAQ,CAARA,KAAQ,CAARA,CAJnB,CAAA,CAMe,UAAU,CAAE,QAAA,CAAA,UAAA,EAAM,CACd,MAAO,CAAA,KAAA,CAAA,aAAA,CAAA,kBAAA,CAAA,CAAoB,IAAI,CAAxB,MAAA,CAAgC,IAAI,CAAEb,EAAE,CAAxC,EAAwC,CAAxC,CAAA,MAAA,CAAA,KAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CAAP,CAPnB,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CADJ,CADJ,CAYI,KAAA,CAAA,aAAA,CAAA,SAAA,CAAA,CAAW,KAAK,CAAEI,EAAE,CAApB,UAAoB,CAApB,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,aAAA,CAAA,CAAe,WAAW,CAAEH,CAAC,CAA7B,uBAA6B,CAA7B,CACe,eAAe,CAD9B,UAAA,CAEe,KAAK,CAFpB,QAAA,CAGe,YAAY,CAAE,QAAA,CAAA,YAAA,CAAA,KAAA,CAAW,CACrBe,WAAW,CAAXA,KAAW,CAAXA,CAJnB,CAAA,CAMe,eAAe,CAN9B,IAAA,CAOe,UAAU,CAAE,QAAA,CAAA,UAAA,EAAM,CACd,MAAO,CAAA,KAAA,CAAA,aAAA,CAAA,kBAAA,CAAA,CAAoB,IAAI,CAAxB,MAAA,CAAgC,IAAI,CAAEhB,EAAE,CAAxC,EAAwC,CAAxC,CAAA,MAAA,CAAA,KAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CAAP,CARnB,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CADJ,CAZJ,CAyBI,KAAA,CAAA,aAAA,CAAA,GAAA,CAAA,CAAK,KAAK,CAAE,CAACiC,SAAS,CAAE/B,EAAE,CAAFA,EAAAA,CAAZ,CAAA,CAAqBgC,cAAc,CAAE,UAArC,CAAZ,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,gBAAA,CAAA,CAAkB,OAAO,CACrB,QAAA,CAAA,OAAA,EAAM,CACFX,WAAW,CAAXA,IAAW,CAAXA,CAFR,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CAIE,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CA9BV,kBA8BU,CAJF,CADJ,CAzBJ,CAgCI,KAAA,CAAA,aAAA,CAAA,GAAA,CAAA,CAAK,KAAK,CAAE,CAACU,SAAS,CAAE/B,EAAE,CAAFA,EAAAA,CAAMiC,CAAlB,CAAZ,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,oBAAA,CAAA,CAAsB,OAAO,CAA7B,WAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CACI,KAAA,CAAA,aAAA,CAAA,YAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CAAe/B,EAAE,CApChCgB,OAoCgC,CAAjB,CADJ,CADJ,CAhCJ,CAFHA,CAJL,IAAA,CA+CQ,WAAW,GAAX,OAAA,CACM,KAAA,CAAA,aAAA,CAAA,kBAAA,CAAA,CAAoB,KAAK,CAAzB,KAAA,CAAkC,UAAU,CAA5C,UAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CADN,CA/CR,IAAA,CAoDQ,WAAW,GAAX,OAAA,EAAA,QAAA,CACM,KAAA,CAAA,aAAA,CAAA,cAAA,CAAA,CAAgB,KAAK,CAArB,KAAA,CACgB,UAAU,CAD1B,UAAA,CAEgB,MAAM,CAAE,QAAA,CAAA,MAAA,EAAM,CACVG,WAAW,CAAXA,KAAW,CAAXA,CAHpB,CAAA,CAKgB,QAAQ,CAAE,QAAA,CAAA,QAAA,EAAM,CACZA,WAAW,CAAXA,KAAW,CAAXA,CANpB,CAAA,CAQgB,KAAK,CARrB,KAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CADN,CApDR,IAAA,CAiEI,KAAA,CAAA,aAAA,CAAA,WAAA,CAAA,CAAa,KAAK,CAAlB,KAAA,CAA2B,UAAU,CAArC,UAAA,CAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,QAAA,CAAA,YAAA,CAAA,UAAA,CAAA,GAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA,CAjEJ,CADG,CAAP,CAqEH","sourcesContent":["import {InButtonText, LinearGradientButton, Text, TextInputIcon, View} from '../../components/UI';\nimport * as React from 'react';\nimport {useState} from 'react';\nimport {useDispatch} from 'react-redux';\nimport {shortenTFunctionKey} from '../../providers/i18n-labor';\nimport {InputCard, makeContainerStyles, Row} from '../../containers';\nimport {useAuthLabor} from '../../providers/auth-labor';\nimport {RouteProp} from '@react-navigation/native';\nimport {AuthTopStackParam, RootStackParam} from '../../types';\nimport {StackNavigationProp} from '@react-navigation/stack';\nimport {LinearGradientIcon} from '../../components/LinearGradientIcon';\nimport {Keyboard, ScrollView, TouchableOpacity} from 'react-native';\nimport {collectBizLogicResult, collectSysError} from '../../store/actions';\nimport {makeStyles} from './styles';\nimport {LoginVector} from '../../components/LoginVector';\nimport {FirebasePhoneLogin} from '../../components/FirebasePhoneLogin';\nimport {Tab} from '../../components/Tab';\nimport {ForgotPassword} from '../../components/ForgotPassword';\nimport {navToReference} from '../../helpers';\nimport {useBunnyKit} from '../../hooks/bunny-kit';\n\ntype LoginRouteProp = RouteProp<AuthTopStackParam, 'Login'>;\ntype LoginNavigationProp = StackNavigationProp<RootStackParam, 'Auth'>;\n\nexport interface LoginProps {\n    route: LoginRouteProp;\n    navigation: LoginNavigationProp;\n    isBunnyAuth: boolean;\n}\n\nexport function LoginScreen({route, navigation, isBunnyAuth}: LoginProps) {\n    const {sizeLabor, themeLabor, wp, t, ms} = useBunnyKit();\n    const st = shortenTFunctionKey(t, 'screens.Auth');\n    const containerStyles = makeContainerStyles(sizeLabor, themeLabor);\n    const styles = makeStyles(sizeLabor, themeLabor);\n    const {authFunctions} = useAuthLabor();\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const dispatch = useDispatch();\n    const firebaseLoginMethods = ['email', 'phone'];\n    const [loginMethod, setLoginMethod] = useState('email');\n    const [isForgot, setIsForgot] = useState(false);\n\n    const firebaseEmailLogin = async () => {\n        Keyboard.dismiss();\n        // todo can not use await to catch error,wait for Firebase to resolve this bug\n        try {\n            const result = await authFunctions.firebaseEmailLogin(email, password, true);\n            if (result.success) {\n                navToReference(route, navigation);\n            } else {\n                dispatch(collectBizLogicResult(result));\n            }\n        } catch (e: any) {\n            dispatch(collectSysError(e));\n        }\n    };\n\n    const bunnyLogin = async () => {\n        Keyboard.dismiss();\n        try {\n            const result = await authFunctions.bunnyLogin({username: email, password});\n            if (result.success) {\n                navToReference(route, navigation);\n            } else {\n                dispatch(collectBizLogicResult(result));\n            }\n        } catch (e: any) {\n            dispatch(collectSysError(e));\n        }\n    };\n\n    const handleLogin = async () => {\n        isBunnyAuth ? await bunnyLogin() : await firebaseEmailLogin();\n    };\n\n    return <View style={[containerStyles.Screen]}>\n        <ScrollView style={styles.loginOrSignUpContainer}>\n            <Tab items={firebaseLoginMethods} value={loginMethod} onChange={(item) => {\n                setLoginMethod(item);\n            }}/>\n            {loginMethod === 'email' && !isForgot\n                ?\n                <View>\n                    <InputCard title={st(`email`)}>\n                        <TextInputIcon placeholder={t(`placeholders.email`)}\n                                       textContentType=\"emailAddress\"\n                                       value={email}\n                                       onChangeText={(value) => {\n                                           setEmail(value);\n                                       }}\n                                       renderIcon={() => {\n                                           return <LinearGradientIcon name=\"mail\" size={wp(20)}/>;\n                                       }}/>\n                    </InputCard>\n                    <InputCard title={st(`password`)}>\n                        <TextInputIcon placeholder={t(`placeholders.password`)}\n                                       textContentType=\"password\"\n                                       value={password}\n                                       onChangeText={(value) => {\n                                           setPassword(value);\n                                       }}\n                                       secureTextEntry\n                                       renderIcon={() => {\n                                           return <LinearGradientIcon name=\"lock\" size={wp(22)}/>;\n                                       }}\n                        />\n                    </InputCard>\n                    <Row style={{marginTop: ms.sp.l, justifyContent: 'flex-end'}}>\n                        <TouchableOpacity onPress={\n                            () => {\n                                setIsForgot(true);\n                            }\n                        }><Text>Forgot password?</Text></TouchableOpacity>\n                    </Row>\n                    <Row style={{marginTop: ms.sp.l}}>\n                        <LinearGradientButton onPress={handleLogin}>\n                            <InButtonText>{st(`login`)}</InButtonText>\n                        </LinearGradientButton>\n                    </Row>\n                </View>\n                : null\n            }\n            {\n                loginMethod === 'phone'\n                    ? <FirebasePhoneLogin route={route} navigation={navigation}/>\n                    : null\n            }\n            {\n                loginMethod === 'email' && isForgot\n                    ? <ForgotPassword route={route}\n                                      navigation={navigation}\n                                      onSent={() => {\n                                          setIsForgot(false);\n                                      }}\n                                      onCancel={() => {\n                                          setIsForgot(false);\n                                      }}\n                                      email={email}\n                    />\n                    : null\n            }\n            <LoginVector route={route} navigation={navigation}/>\n        </ScrollView>\n    </View>;\n}\n"]},"metadata":{},"sourceType":"module"}