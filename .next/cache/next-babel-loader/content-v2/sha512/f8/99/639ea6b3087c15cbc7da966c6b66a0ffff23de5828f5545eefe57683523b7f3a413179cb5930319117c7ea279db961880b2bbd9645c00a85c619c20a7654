{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import _regeneratorRuntime from\"@babel/runtime/regenerator\";import*as React from'react';import{useEffect,useState}from'react';import Platform from\"react-native-web/dist/exports/Platform\";import View from\"react-native-web/dist/exports/View\";import{ButtonTO,InButtonText,PickerSelectChevronRight,Text}from\"../../../components/UI\";import{shortenTFunctionKey}from\"../../../providers/i18n-labor\";import{Col,makeContainerStyles,Row}from\"../../../containers\";import*as Notifications from'expo-notifications';import{defaultNotification,registerForPushNotificationsAsync}from\"../../../utils/expo-notification\";import{cancelAlertSettings,collectSysError,getCurrentPrice,saveQuickAlertSettings}from\"../../../store/actions\";import{useDispatch,useSelector}from'react-redux';import{makeStyles}from\"./styles\";import{getSharedStyles}from\"../../../helpers\";import{useBunnyKit}from\"../../../hooks/bunny-kit\";export default function CryptoCurrencyAlertScreen(_ref){var route=_ref.route,navigation=_ref.navigation;var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,t=_useBunnyKit.t;var st=shortenTFunctionKey(t,'screens.CryptoCurrencyAlert');var i18nSysPrefix='sys';var stSys=shortenTFunctionKey(t,i18nSysPrefix);var containerStyles=makeContainerStyles(sizeLabor,themeLabor);var _getSharedStyles=getSharedStyles(sizeLabor,themeLabor),sharedStyles=_getSharedStyles.sharedStyles;var styles=makeStyles(sizeLabor,themeLabor);var dispatch=useDispatch();var _useSelector=useSelector(function(rootState){return rootState.demoCryptoCurrencyState;}),currentPrice=_useSelector.currentPrice,dictionaries=_useSelector.dictionaries;var dicGranularity=dictionaries.granularity;var dicReminderTimes=dictionaries.times;var dicReminderInterval=dictionaries.interval;var notificationReceivedListener={remove:function remove(){}};var notificationRespondedListener={remove:function remove(){}};var _useState=useState(''),_useState2=_slicedToArray(_useState,2),expoPushToken=_useState2[0],setExpoPushToken=_useState2[1];var _useState3=useState(defaultNotification),_useState4=_slicedToArray(_useState3,2),notification=_useState4[0],setNotification=_useState4[1];var _useState5=useState(0.05),_useState6=_slicedToArray(_useState5,2),granularity=_useState6[0],setGranularity=_useState6[1];var _useState7=useState({times:3,interval:'1m'}),_useState8=_slicedToArray(_useState7,2),reminder=_useState8[0],setReminder=_useState8[1];var handleSaveQuickAlertSettings=function handleSaveQuickAlertSettings(){return _regeneratorRuntime.async(function handleSaveQuickAlertSettings$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(saveQuickAlertSettings({token:expoPushToken,granularity:granularity,reminder:reminder}));case 1:case\"end\":return _context.stop();}}},null,null,null,Promise);};var handleCancelAllAlertSettings=function handleCancelAllAlertSettings(){return _regeneratorRuntime.async(function handleCancelAllAlertSettings$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(cancelAlertSettings({token:expoPushToken,cancelAll:true}));case 1:case\"end\":return _context2.stop();}}},null,null,null,Promise);};useEffect(function(){Notifications.setNotificationHandler({handleNotification:function handleNotification(){return _regeneratorRuntime.async(function handleNotification$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",{shouldShowAlert:true,shouldPlaySound:false,shouldSetBadge:false});case 1:case\"end\":return _context3.stop();}}},null,null,null,Promise);}});var initPushNotification=function initPushNotification(){var token;return _regeneratorRuntime.async(function initPushNotification$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(registerForPushNotificationsAsync({failedToGetToken:stSys(\"failedToGetToken\"),mustUsePhysicalDevice:stSys(\"mustUsePhysicalDevice\")}));case 2:token=_context4.sent;if(token){setExpoPushToken(token);}try{dispatch(getCurrentPrice());}catch(e){dispatch(collectSysError(e));}notificationReceivedListener=Notifications.addNotificationReceivedListener(function(notification){setNotification(notification);});notificationRespondedListener=Notifications.addNotificationResponseReceivedListener(function(response){});case 7:case\"end\":return _context4.stop();}}},null,null,null,Promise);};initPushNotification().then();return function(){Notifications.removeNotificationSubscription(notificationReceivedListener);Notifications.removeNotificationSubscription(notificationRespondedListener);};},[]);var granularityLabelPrefix=st(\"granularity\").padEnd(35,\"\\u2004\");var mappedDicGranularity=dicGranularity.map(function(item){item.inputLabel=granularityLabelPrefix+item.label;return item;});var remindTimesLabelPrefix=st(\"remindTimesLabel\").padEnd(35,\"\\u2004\");var mappedDicReminderTimes=dicReminderTimes.map(function(item){item.inputLabel=remindTimesLabelPrefix+item.label;return item;});var remindIntervalLabelPrefix=st(\"remindIntervalLabel\").padEnd(35,\"\\u2004\");var mappedDicReminderInterval=dicReminderInterval.map(function(item){item.inputLabel=remindIntervalLabelPrefix+item.label;return item;});var currentPriceLabelPrefix=st(\"currentPriceLabel\").padEnd(30,\"\\u2004\");return Platform.OS!=='web'?React.createElement(View,{style:containerStyles.Screen},React.createElement(View,{style:styles.container},React.createElement(View,null,notification?React.createElement(View,null,React.createElement(Row,null,React.createElement(Col,{size:1},React.createElement(Text,null,\"Title:\")),React.createElement(Col,{size:4},React.createElement(Text,null,notification.request.content.title,\" \"))),React.createElement(Row,null,React.createElement(Col,{size:1},React.createElement(Text,null,\"Body:\")),React.createElement(Col,{size:4},React.createElement(Text,null,notification.request.content.body,\" \")))):null),React.createElement(View,null,React.createElement(View,{style:styles.box},React.createElement(Text,{style:styles.text},currentPriceLabelPrefix+currentPrice)),React.createElement(PickerSelectChevronRight,{value:granularity,placeholder:{label:'Select '+granularityLabelPrefix,value:0},items:mappedDicGranularity,onValueChange:function onValueChange(itemValue){return setGranularity(itemValue);}}),React.createElement(PickerSelectChevronRight,{value:reminder.times,placeholder:{label:'Select '+remindTimesLabelPrefix,value:0},items:mappedDicReminderTimes,onValueChange:function onValueChange(itemValue){return setReminder(_objectSpread(_objectSpread({},reminder),{},{times:itemValue}));}}),React.createElement(PickerSelectChevronRight,{value:reminder.interval,placeholder:{label:'Select '+remindIntervalLabelPrefix,value:''},items:mappedDicReminderInterval,onValueChange:function onValueChange(itemValue){return setReminder(_objectSpread(_objectSpread({},reminder),{},{interval:itemValue}));}})),React.createElement(Row,{style:styles.bottomBar},React.createElement(Col,{size:1},React.createElement(ButtonTO,{onPress:handleSaveQuickAlertSettings},React.createElement(InButtonText,null,st(\"saveQuickSettings\")))),React.createElement(Col,{size:1,style:{marginLeft:6}},React.createElement(ButtonTO,{onPress:handleCancelAllAlertSettings},React.createElement(InButtonText,null,st(\"cancelAlertSettings\"))))))):React.createElement(Text,null,\"Dummy CryptoCurrencyAlert\");}","map":null,"metadata":{},"sourceType":"module"}