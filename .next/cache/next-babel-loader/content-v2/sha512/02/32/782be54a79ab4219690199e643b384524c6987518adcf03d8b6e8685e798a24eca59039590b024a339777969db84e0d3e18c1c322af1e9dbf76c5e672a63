{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import ChatAvatar from\"./ChatAvatar\";import Bubble from\"./Bubble\";import SystemMessage from\"./SystemMessage\";import Day from\"./Day\";import{isSameUser}from\"./utils\";import{withBunnyKit}from\"../../hooks/bunny-kit\";var makeStyles=function makeStyles(sizeLabor,themeLabor){var wp=sizeLabor.designsBasedOn.iphoneX.wp;return{left:StyleSheet.create({container:{flexDirection:'row',alignItems:'flex-end',justifyContent:'flex-start',marginLeft:wp(8),marginRight:0}}),right:StyleSheet.create({container:{flexDirection:'row',alignItems:'flex-end',justifyContent:'flex-end',marginLeft:0,marginRight:wp(8)}})};};var Message=function(_React$Component){_inherits(Message,_React$Component);var _super=_createSuper(Message);function Message(){_classCallCheck(this,Message);return _super.apply(this,arguments);}_createClass(Message,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps){var next=nextProps.currentMessage;var current=this.props.currentMessage;var _this$props=this.props,previousMessage=_this$props.previousMessage,nextMessage=_this$props.nextMessage;var nextPropsMessage=nextProps.nextMessage;var nextPropsPreviousMessage=nextProps.previousMessage;var shouldUpdate=this.props.shouldUpdateMessage&&this.props.shouldUpdateMessage(this.props,nextProps)||false;return next.sent!==current.sent||next.received!==current.received||next.pending!==current.pending||next.createdAt!==current.createdAt||next.text!==current.text||next.image!==current.image||next.sticker!==current.sticker||next.video!==current.video||next.audio!==current.audio||previousMessage!==nextPropsPreviousMessage||nextMessage!==nextPropsMessage||shouldUpdate;}},{key:\"renderDay\",value:function renderDay(){if(this.props.currentMessage&&this.props.currentMessage.createdAt){var _this$props2=this.props,currentMessage=_this$props2.currentMessage,previousMessage=_this$props2.previousMessage,nextMessage=_this$props2.nextMessage,dayContainerStyle=_this$props2.dayContainerStyle,dayWrapperStyle=_this$props2.dayWrapperStyle,dayTextStyle=_this$props2.dayTextStyle,dayTextProps=_this$props2.dayTextProps,dateFormat=_this$props2.dateFormat,isDebug=_this$props2.isDebug;var dayProps={currentMessage:currentMessage,previousMessage:previousMessage,nextMessage:nextMessage,dayContainerStyle:dayContainerStyle,dayWrapperStyle:dayWrapperStyle,dayTextStyle:dayTextStyle,dayTextProps:dayTextProps,dateFormat:dateFormat};isDebug&&console.log('%c[ chat ]','background: #555; color: #bada55','[level3]Message dayProps',dayProps);if(this.props.renderDay){return this.props.renderDay(dayProps);}return React.createElement(Day,dayProps);}return null;}},{key:\"renderBubble\",value:function renderBubble(){var _this$props3=this.props,audioProps=_this$props3.audioProps,audioStyle=_this$props3.audioStyle,audioContainerStyle=_this$props3.audioContainerStyle,bottomContainerStyle=_this$props3.bottomContainerStyle,bubbleContainerStyle=_this$props3.bubbleContainerStyle,bubbleWrapperStyle=_this$props3.bubbleWrapperStyle,currentMessage=_this$props3.currentMessage,quickRepliesColor=_this$props3.quickRepliesColor,containerToNextStyle=_this$props3.containerToNextStyle,containerToPreviousStyle=_this$props3.containerToPreviousStyle,customTextStyle=_this$props3.customTextStyle,isDebug=_this$props3.isDebug,imageContainerStyle=_this$props3.imageContainerStyle,imageProps=_this$props3.imageProps,imageStyle=_this$props3.imageStyle,isCustomViewBottom=_this$props3.isCustomViewBottom,keepReplies=_this$props3.keepReplies,lightBoxProps=_this$props3.lightBoxProps,linkStyle=_this$props3.linkStyle,messages=_this$props3.messages,nextMessage=_this$props3.nextMessage,onLongPress=_this$props3.onLongPress,onMessageLoad=_this$props3.onMessageLoad,onMessageLoadEnd=_this$props3.onMessageLoadEnd,onMessageLoadError=_this$props3.onMessageLoadError,onMessageLoadStart=_this$props3.onMessageLoadStart,onMessageReadyForDisplay=_this$props3.onMessageReadyForDisplay,onPress=_this$props3.onPress,onQuickReply=_this$props3.onQuickReply,textLongPressOptionTitles=_this$props3.textLongPressOptionTitles,phoneNumberOptionTitles=_this$props3.phoneNumberOptionTitles,parsePatterns=_this$props3.parsePatterns,position=_this$props3.position,previousMessage=_this$props3.previousMessage,quickReplyStyle=_this$props3.quickReplyStyle,renderCustomView=_this$props3.renderCustomView,renderMessageAudio=_this$props3.renderMessageAudio,renderMessageImage=_this$props3.renderMessageImage,renderMessageSticker=_this$props3.renderMessageSticker,renderMessageText=_this$props3.renderMessageText,renderMessageVideo=_this$props3.renderMessageVideo,renderQuickReplies=_this$props3.renderQuickReplies,renderQuickReplySend=_this$props3.renderQuickReplySend,renderTicks=_this$props3.renderTicks,renderTime=_this$props3.renderTime,renderUsernameOnMessage=_this$props3.renderUsernameOnMessage,stickerStyle=_this$props3.stickerStyle,sendText=_this$props3.sendText,stickerContainerStyle=_this$props3.stickerContainerStyle,stickerProps=_this$props3.stickerProps,textContainerStyle=_this$props3.textContainerStyle,textProps=_this$props3.textProps,textStyle=_this$props3.textStyle,tickStyle=_this$props3.tickStyle,timeContainerStyle=_this$props3.timeContainerStyle,timeFormat=_this$props3.timeFormat,timeTextStyle=_this$props3.timeTextStyle,touchableProps=_this$props3.touchableProps,usernameStyle=_this$props3.usernameStyle,user=_this$props3.user,videoProps=_this$props3.videoProps,videoContainerStyle=_this$props3.videoContainerStyle,videoStyle=_this$props3.videoStyle,audioProgressStyle=_this$props3.audioProgressStyle,audioPlayButtonStyle=_this$props3.audioPlayButtonStyle,audioProgressColor=_this$props3.audioProgressColor,audioRemainTimeStyle=_this$props3.audioRemainTimeStyle,audioPlayButtonIconStyle=_this$props3.audioPlayButtonIconStyle;var bubbleProps={audioProps:audioProps,audioStyle:audioStyle,audioContainerStyle:audioContainerStyle,bottomContainerStyle:bottomContainerStyle,bubbleContainerStyle:bubbleContainerStyle,bubbleWrapperStyle:bubbleWrapperStyle,currentMessage:currentMessage,quickRepliesColor:quickRepliesColor,containerToNextStyle:containerToNextStyle,containerToPreviousStyle:containerToPreviousStyle,customTextStyle:customTextStyle,isDebug:isDebug,imageContainerStyle:imageContainerStyle,imageProps:imageProps,imageStyle:imageStyle,isCustomViewBottom:isCustomViewBottom,keepReplies:keepReplies,lightBoxProps:lightBoxProps,linkStyle:linkStyle,messages:messages,nextMessage:nextMessage,onLongPress:onLongPress,onMessageLoad:onMessageLoad,onMessageLoadEnd:onMessageLoadEnd,onMessageLoadError:onMessageLoadError,onMessageLoadStart:onMessageLoadStart,onMessageReadyForDisplay:onMessageReadyForDisplay,onPress:onPress,onQuickReply:onQuickReply,textLongPressOptionTitles:textLongPressOptionTitles,phoneNumberOptionTitles:phoneNumberOptionTitles,parsePatterns:parsePatterns,position:position,previousMessage:previousMessage,quickReplyStyle:quickReplyStyle,renderCustomView:renderCustomView,renderMessageAudio:renderMessageAudio,renderMessageImage:renderMessageImage,renderMessageSticker:renderMessageSticker,renderMessageText:renderMessageText,renderMessageVideo:renderMessageVideo,renderQuickReplies:renderQuickReplies,renderQuickReplySend:renderQuickReplySend,renderTicks:renderTicks,renderTime:renderTime,renderUsernameOnMessage:renderUsernameOnMessage,stickerStyle:stickerStyle,sendText:sendText,stickerContainerStyle:stickerContainerStyle,stickerProps:stickerProps,textContainerStyle:textContainerStyle,textProps:textProps,textStyle:textStyle,tickStyle:tickStyle,timeContainerStyle:timeContainerStyle,timeFormat:timeFormat,timeTextStyle:timeTextStyle,touchableProps:touchableProps,usernameStyle:usernameStyle,user:user,videoProps:videoProps,videoContainerStyle:videoContainerStyle,videoStyle:videoStyle,audioProgressStyle:audioProgressStyle,audioPlayButtonStyle:audioPlayButtonStyle,audioProgressColor:audioProgressColor,audioRemainTimeStyle:audioRemainTimeStyle,audioPlayButtonIconStyle:audioPlayButtonIconStyle};isDebug&&console.log('%c[ chat ]','background: #555; color: #bada55','[level3]Message bubbleProps',bubbleProps);if(this.props.renderBubble){return this.props.renderBubble(bubbleProps);}return React.createElement(Bubble,bubbleProps);}},{key:\"renderSystemMessage\",value:function renderSystemMessage(){var _this$props4=this.props,currentMessage=_this$props4.currentMessage,systemMessageContainerStyle=_this$props4.systemMessageContainerStyle,systemMessageWrapperStyle=_this$props4.systemMessageWrapperStyle,systemTextStyle=_this$props4.systemTextStyle,isDebug=_this$props4.isDebug;var systemMessageProps={currentMessage:currentMessage,systemMessageContainerStyle:systemMessageContainerStyle,systemMessageWrapperStyle:systemMessageWrapperStyle,systemTextStyle:systemTextStyle};isDebug&&console.log('%c[ chat ]','background: #555; color: #bada55','[level3]Message systemMessageProps',systemMessageProps);if(this.props.renderSystemMessage){return this.props.renderSystemMessage(systemMessageProps);}return React.createElement(SystemMessage,systemMessageProps);}},{key:\"renderAvatar\",value:function renderAvatar(){var _this$props5=this.props,user=_this$props5.user,currentMessage=_this$props5.currentMessage,showUserAvatar=_this$props5.showUserAvatar;if(user&&user._id&&currentMessage&&currentMessage.user&&user._id===currentMessage.user._id&&!showUserAvatar){return null;}if(currentMessage&&currentMessage.user&&currentMessage.user.avatar===null){return null;}var _this$props6=this.props,renderAvatarOnTop=_this$props6.renderAvatarOnTop,showAvatarForEveryMessage=_this$props6.showAvatarForEveryMessage,position=_this$props6.position,previousMessage=_this$props6.previousMessage,nextMessage=_this$props6.nextMessage,avatarContainerStyle=_this$props6.avatarContainerStyle,avatarImageStyle=_this$props6.avatarImageStyle,onPressAvatar=_this$props6.onPressAvatar,onLongPressAvatar=_this$props6.onLongPressAvatar,isDebug=_this$props6.isDebug;var avatarProps={renderAvatarOnTop:renderAvatarOnTop,showAvatarForEveryMessage:showAvatarForEveryMessage,position:position,currentMessage:currentMessage,previousMessage:previousMessage,nextMessage:nextMessage,avatarContainerStyle:avatarContainerStyle,avatarImageStyle:avatarImageStyle,onPressAvatar:onPressAvatar,onLongPressAvatar:onLongPressAvatar};isDebug&&console.log('%c[ chat ]','background: #555; color: #bada55','[level3]Message avatarProps',avatarProps);return React.createElement(ChatAvatar,avatarProps);}},{key:\"render\",value:function render(){var _this$props7=this.props,currentMessage=_this$props7.currentMessage,onMessageLayout=_this$props7.onMessageLayout,nextMessage=_this$props7.nextMessage,position=_this$props7.position,messageContainerStyle=_this$props7.messageContainerStyle;if(currentMessage){var sameUser=isSameUser(currentMessage,nextMessage);var _this$props$bunnyKit=this.props.bunnyKit,sizeLabor=_this$props$bunnyKit.sizeLabor,themeLabor=_this$props$bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);return React.createElement(View,{onLayout:onMessageLayout},this.renderDay(),currentMessage.system?this.renderSystemMessage():React.createElement(View,{style:[styles[position].container,{marginBottom:sameUser?2:10},!this.props.inverted&&{marginBottom:2},messageContainerStyle&&messageContainerStyle[position]]},this.props.position==='left'?this.renderAvatar():null,this.renderBubble(),this.props.position==='right'?this.renderAvatar():null));}return null;}}]);return Message;}(React.Component);Message.defaultProps={messages:[],renderAvatar:undefined,renderBubble:undefined,renderDay:undefined,renderSystemMessage:undefined,position:'left',currentMessage:undefined,nextMessage:undefined,previousMessage:undefined,user:undefined,messageContainerStyle:{},showUserAvatar:false,inverted:true,shouldUpdateMessage:undefined,onMessageLayout:undefined};export default withBunnyKit(Message);","map":null,"metadata":{},"sourceType":"module"}