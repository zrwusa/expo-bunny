{"ast":null,"code":"\"use strict\";var _interopRequireDefault2=require(\"@babel/runtime/helpers/interopRequireDefault\");var _regenerator=_interopRequireDefault2(require(\"@babel/runtime/regenerator\"));var _classCallCheck2=_interopRequireDefault2(require(\"@babel/runtime/helpers/classCallCheck\"));var _createClass2=_interopRequireDefault2(require(\"@babel/runtime/helpers/createClass\"));var _slicedToArray2=_interopRequireDefault2(require(\"@babel/runtime/helpers/slicedToArray\"));var _extends2=_interopRequireDefault2(require(\"@babel/runtime/helpers/extends\"));exports.__esModule=true;exports.getDomainLocale=getDomainLocale;exports.addLocale=addLocale;exports.delLocale=delLocale;exports.hasBasePath=hasBasePath;exports.addBasePath=addBasePath;exports.delBasePath=delBasePath;exports.isLocalURL=isLocalURL;exports.interpolateAs=interpolateAs;exports.resolveHref=resolveHref;exports.default=void 0;var _normalizeTrailingSlash=require(\"../../../client/normalize-trailing-slash\");var _routeLoader=require(\"../../../client/route-loader\");var _denormalizePagePath=require(\"../../server/denormalize-page-path\");var _normalizeLocalePath=require(\"../i18n/normalize-locale-path\");var _mitt=_interopRequireDefault(require(\"../mitt\"));var _utils=require(\"../utils\");var _isDynamic=require(\"./utils/is-dynamic\");var _parseRelativeUrl=require(\"./utils/parse-relative-url\");var _querystring=require(\"./utils/querystring\");var _resolveRewrites=_interopRequireDefault(require(\"./utils/resolve-rewrites\"));var _routeMatcher=require(\"./utils/route-matcher\");var _routeRegex=require(\"./utils/route-regex\");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var detectDomainLocale;if(process.env.__NEXT_I18N_SUPPORT){detectDomainLocale=require(\"../i18n/detect-domain-locale\").detectDomainLocale;}var basePath=process.env.__NEXT_ROUTER_BASEPATH||'';function buildCancellationError(){return(0,_extends2.default)(new Error('Route Cancelled'),{cancelled:true});}function addPathPrefix(path,prefix){return prefix&&path.startsWith('/')?path==='/'?(0,_normalizeTrailingSlash.normalizePathTrailingSlash)(prefix):\"\"+prefix+(pathNoQueryHash(path)==='/'?path.substring(1):path):path;}function getDomainLocale(path,locale,locales,domainLocales){if(process.env.__NEXT_I18N_SUPPORT){locale=locale||(0,_normalizeLocalePath.normalizeLocalePath)(path,locales).detectedLocale;var detectedDomain=detectDomainLocale(domainLocales,undefined,locale);if(detectedDomain){return\"http\"+(detectedDomain.http?'':'s')+\"://\"+detectedDomain.domain+(basePath||'')+(locale===detectedDomain.defaultLocale?'':\"/\"+locale)+path;}return false;}return false;}function addLocale(path,locale,defaultLocale){if(process.env.__NEXT_I18N_SUPPORT){var pathname=pathNoQueryHash(path);var pathLower=pathname.toLowerCase();var localeLower=locale&&locale.toLowerCase();return locale&&locale!==defaultLocale&&!pathLower.startsWith('/'+localeLower+'/')&&pathLower!=='/'+localeLower?addPathPrefix(path,'/'+locale):path;}return path;}function delLocale(path,locale){if(process.env.__NEXT_I18N_SUPPORT){var pathname=pathNoQueryHash(path);var pathLower=pathname.toLowerCase();var localeLower=locale&&locale.toLowerCase();return locale&&(pathLower.startsWith('/'+localeLower+'/')||pathLower==='/'+localeLower)?(pathname.length===locale.length+1?'/':'')+path.substr(locale.length+1):path;}return path;}function pathNoQueryHash(path){var queryIndex=path.indexOf('?');var hashIndex=path.indexOf('#');if(queryIndex>-1||hashIndex>-1){path=path.substring(0,queryIndex>-1?queryIndex:hashIndex);}return path;}function hasBasePath(path){path=pathNoQueryHash(path);return path===basePath||path.startsWith(basePath+'/');}function addBasePath(path){return addPathPrefix(path,basePath);}function delBasePath(path){path=path.slice(basePath.length);if(!path.startsWith('/'))path=\"/\"+path;return path;}function isLocalURL(url){if(url.startsWith('/')||url.startsWith('#'))return true;try{var locationOrigin=(0,_utils.getLocationOrigin)();var resolved=new URL(url,locationOrigin);return resolved.origin===locationOrigin&&hasBasePath(resolved.pathname);}catch(_){return false;}}function interpolateAs(route,asPathname,query){var interpolatedRoute='';var dynamicRegex=(0,_routeRegex.getRouteRegex)(route);var dynamicGroups=dynamicRegex.groups;var dynamicMatches=(asPathname!==route?(0,_routeMatcher.getRouteMatcher)(dynamicRegex)(asPathname):'')||query;interpolatedRoute=route;var params=Object.keys(dynamicGroups);if(!params.every(function(param){var value=dynamicMatches[param]||'';var _dynamicGroups$param=dynamicGroups[param],repeat=_dynamicGroups$param.repeat,optional=_dynamicGroups$param.optional;var replaced=\"[\"+(repeat?'...':'')+param+\"]\";if(optional){replaced=(!value?'/':'')+\"[\"+replaced+\"]\";}if(repeat&&!Array.isArray(value))value=[value];return(optional||param in dynamicMatches)&&(interpolatedRoute=interpolatedRoute.replace(replaced,repeat?value.map(function(segment){return encodeURIComponent(segment);}).join('/'):encodeURIComponent(value))||'/');})){interpolatedRoute='';}return{params:params,result:interpolatedRoute};}function omitParmsFromQuery(query,params){var filteredQuery={};Object.keys(query).forEach(function(key){if(!params.includes(key)){filteredQuery[key]=query[key];}});return filteredQuery;}function resolveHref(currentPath,href,resolveAs){var base;try{base=new URL(currentPath,'http://n');}catch(_){base=new URL('/','http://n');}var urlAsString=typeof href==='string'?href:(0,_utils.formatWithValidation)(href);if(!isLocalURL(urlAsString)){return resolveAs?[urlAsString]:urlAsString;}try{var finalUrl=new URL(urlAsString,base);finalUrl.pathname=(0,_normalizeTrailingSlash.normalizePathTrailingSlash)(finalUrl.pathname);var interpolatedAs='';if((0,_isDynamic.isDynamicRoute)(finalUrl.pathname)&&finalUrl.searchParams&&resolveAs){var query=(0,_querystring.searchParamsToUrlQuery)(finalUrl.searchParams);var _interpolateAs=interpolateAs(finalUrl.pathname,finalUrl.pathname,query),result=_interpolateAs.result,params=_interpolateAs.params;if(result){interpolatedAs=(0,_utils.formatWithValidation)({pathname:result,hash:finalUrl.hash,query:omitParmsFromQuery(query,params)});}}var resolvedHref=finalUrl.origin===base.origin?finalUrl.href.slice(finalUrl.origin.length):finalUrl.href;return resolveAs?[resolvedHref,interpolatedAs||resolvedHref]:resolvedHref;}catch(_){return resolveAs?[urlAsString]:urlAsString;}}function stripOrigin(url){var origin=(0,_utils.getLocationOrigin)();return url.startsWith(origin)?url.substring(origin.length):url;}function prepareUrlAs(router,url,as){var _resolveHref=resolveHref(router.asPath,url,true),_resolveHref2=(0,_slicedToArray2.default)(_resolveHref,2),resolvedHref=_resolveHref2[0],resolvedAs=_resolveHref2[1];var origin=(0,_utils.getLocationOrigin)();var hrefHadOrigin=resolvedHref.startsWith(origin);var asHadOrigin=resolvedAs&&resolvedAs.startsWith(origin);resolvedHref=stripOrigin(resolvedHref);resolvedAs=resolvedAs?stripOrigin(resolvedAs):resolvedAs;var preparedUrl=hrefHadOrigin?resolvedHref:addBasePath(resolvedHref);var preparedAs=as?stripOrigin(resolveHref(router.asPath,as)):resolvedAs||resolvedHref;return{url:preparedUrl,as:asHadOrigin?preparedAs:addBasePath(preparedAs)};}function resolveDynamicRoute(pathname,pages){var cleanPathname=(0,_normalizeTrailingSlash.removePathTrailingSlash)((0,_denormalizePagePath.denormalizePagePath)(pathname));if(cleanPathname==='/404'||cleanPathname==='/_error'){return pathname;}if(!pages.includes(cleanPathname)){pages.some(function(page){if((0,_isDynamic.isDynamicRoute)(page)&&(0,_routeRegex.getRouteRegex)(page).re.test(cleanPathname)){pathname=page;return true;}});}return(0,_normalizeTrailingSlash.removePathTrailingSlash)(pathname);}var manualScrollRestoration=process.env.__NEXT_SCROLL_RESTORATION&&true&&'scrollRestoration'in window.history&&!!function(){try{var v='__next';return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),true;}catch(n){}}();var SSG_DATA_NOT_FOUND=Symbol('SSG_DATA_NOT_FOUND');function fetchRetry(url,attempts){return fetch(url,{credentials:'same-origin'}).then(function(res){if(!res.ok){if(attempts>1&&res.status>=500){return fetchRetry(url,attempts-1);}if(res.status===404){return res.json().then(function(data){if(data.notFound){return{notFound:SSG_DATA_NOT_FOUND};}throw new Error(\"Failed to load static props\");});}throw new Error(\"Failed to load static props\");}return res.json();});}function fetchNextData(dataHref,isServerRender){return fetchRetry(dataHref,isServerRender?3:1).catch(function(err){if(!isServerRender){(0,_routeLoader.markAssetError)(err);}throw err;});}var Router=function(){function Router(_pathname,_query,_as,_ref){var _this=this;var initialProps=_ref.initialProps,pageLoader=_ref.pageLoader,App=_ref.App,wrapApp=_ref.wrapApp,Component=_ref.Component,err=_ref.err,subscription=_ref.subscription,isFallback=_ref.isFallback,locale=_ref.locale,locales=_ref.locales,defaultLocale=_ref.defaultLocale,domainLocales=_ref.domainLocales,isPreview=_ref.isPreview;(0,_classCallCheck2.default)(this,Router);this.route=void 0;this.pathname=void 0;this.query=void 0;this.asPath=void 0;this.basePath=void 0;this.components=void 0;this.sdc={};this.sdr={};this.sub=void 0;this.clc=void 0;this.pageLoader=void 0;this._bps=void 0;this.events=void 0;this._wrapApp=void 0;this.isSsr=void 0;this.isFallback=void 0;this._inFlightRoute=void 0;this._shallow=void 0;this.locale=void 0;this.locales=void 0;this.defaultLocale=void 0;this.domainLocales=void 0;this.isReady=void 0;this.isPreview=void 0;this.isLocaleDomain=void 0;this._idx=0;this.onPopState=function(e){var state=e.state;if(!state){var _pathname2=_this.pathname,query=_this.query;_this.changeState('replaceState',(0,_utils.formatWithValidation)({pathname:addBasePath(_pathname2),query:query}),(0,_utils.getURL)());return;}if(!state.__N){return;}var forcedScroll;var url=state.url,as=state.as,options=state.options,idx=state.idx;if(process.env.__NEXT_SCROLL_RESTORATION){if(manualScrollRestoration){if(_this._idx!==idx){try{sessionStorage.setItem('__next_scroll_'+_this._idx,JSON.stringify({x:self.pageXOffset,y:self.pageYOffset}));}catch(_unused){}try{var v=sessionStorage.getItem('__next_scroll_'+idx);forcedScroll=JSON.parse(v);}catch(_unused2){forcedScroll={x:0,y:0};}}}}_this._idx=idx;var _ref2=(0,_parseRelativeUrl.parseRelativeUrl)(url),pathname=_ref2.pathname;if(_this.isSsr&&as===_this.asPath&&pathname===_this.pathname){return;}if(_this._bps&&!_this._bps(state)){return;}_this.change('replaceState',url,as,(0,_extends2.default)({},options,{shallow:options.shallow&&_this._shallow,locale:options.locale||_this.defaultLocale}),forcedScroll);};this.route=(0,_normalizeTrailingSlash.removePathTrailingSlash)(_pathname);this.components={};if(_pathname!=='/_error'){this.components[this.route]={Component:Component,initial:true,props:initialProps,err:err,__N_SSG:initialProps&&initialProps.__N_SSG,__N_SSP:initialProps&&initialProps.__N_SSP};}this.components['/_app']={Component:App,styleSheets:[]};this.events=Router.events;this.pageLoader=pageLoader;this.pathname=_pathname;this.query=_query;var autoExportDynamic=(0,_isDynamic.isDynamicRoute)(_pathname)&&self.__NEXT_DATA__.autoExport;this.asPath=autoExportDynamic?_pathname:_as;this.basePath=basePath;this.sub=subscription;this.clc=null;this._wrapApp=wrapApp;this.isSsr=true;this.isFallback=isFallback;this.isReady=!!(self.__NEXT_DATA__.gssp||self.__NEXT_DATA__.gip||!autoExportDynamic&&!self.location.search&&!process.env.__NEXT_HAS_REWRITES);this.isPreview=!!isPreview;this.isLocaleDomain=false;if(process.env.__NEXT_I18N_SUPPORT){this.locale=locale;this.locales=locales;this.defaultLocale=defaultLocale;this.domainLocales=domainLocales;this.isLocaleDomain=!!detectDomainLocale(domainLocales,self.location.hostname);}if(true){if(_as.substr(0,2)!=='//'){this.changeState('replaceState',(0,_utils.formatWithValidation)({pathname:addBasePath(_pathname),query:_query}),(0,_utils.getURL)(),{locale:locale});}window.addEventListener('popstate',this.onPopState);if(process.env.__NEXT_SCROLL_RESTORATION){if(manualScrollRestoration){window.history.scrollRestoration='manual';}}}}(0,_createClass2.default)(Router,[{key:\"reload\",value:function reload(){window.location.reload();}},{key:\"back\",value:function back(){window.history.back();}},{key:\"push\",value:function push(url,as){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(process.env.__NEXT_SCROLL_RESTORATION){if(manualScrollRestoration){try{sessionStorage.setItem('__next_scroll_'+this._idx,JSON.stringify({x:self.pageXOffset,y:self.pageYOffset}));}catch(_unused3){}}};var _prepareUrlAs=prepareUrlAs(this,url,as);url=_prepareUrlAs.url;as=_prepareUrlAs.as;return this.change('pushState',url,as,options);}},{key:\"replace\",value:function replace(url,as){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};;var _prepareUrlAs2=prepareUrlAs(this,url,as);url=_prepareUrlAs2.url;as=_prepareUrlAs2.as;return this.change('replaceState',url,as,options);}},{key:\"change\",value:function change(method,url,as,options,forcedScroll){var _options$scroll,shouldResolveHref,localeChange,parsedAs,localePathResult,didNavigate,_this$locales,detectedDomain,asNoBasePath,_options$shallow,shallow,routeProps,cleanedAs,parsed,pathname,query,pages,rewrites,_await,resolvedAs,rewritesResult,route,_parsedAs,asPathname,routeRegex,routeMatch,shouldInterpolate,interpolatedAs,missingParams,_self$__NEXT_DATA__$p,_self$__NEXT_DATA__$p2,routeInfo,_routeInfo,error,props,__N_SSG,__N_SSP,destination,parsedHref,_prepareUrlAs3,newUrl,newAs,notFoundRoute,appComp,isValidShallowRoute;return _regenerator.default.async(function change$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isLocalURL(url)){_context.next=3;break;}window.location.href=url;return _context.abrupt(\"return\",false);case 3:shouldResolveHref=url===as||options._h;if(options._h){this.isReady=true;}options.scroll=!!((_options$scroll=options.scroll)!=null?_options$scroll:true);localeChange=options.locale!==this.locale;if(!process.env.__NEXT_I18N_SUPPORT){_context.next=19;break;}this.locale=options.locale===false?this.defaultLocale:options.locale||this.locale;if(typeof options.locale==='undefined'){options.locale=this.locale;}parsedAs=(0,_parseRelativeUrl.parseRelativeUrl)(hasBasePath(as)?delBasePath(as):as);localePathResult=(0,_normalizeLocalePath.normalizeLocalePath)(parsedAs.pathname,this.locales);if(localePathResult.detectedLocale){this.locale=localePathResult.detectedLocale;parsedAs.pathname=addBasePath(parsedAs.pathname);as=(0,_utils.formatWithValidation)(parsedAs);url=addBasePath((0,_normalizeLocalePath.normalizeLocalePath)(hasBasePath(url)?delBasePath(url):url,this.locales).pathname);}didNavigate=false;if(process.env.__NEXT_I18N_SUPPORT){if(!((_this$locales=this.locales)!=null&&_this$locales.includes(this.locale))){parsedAs.pathname=addLocale(parsedAs.pathname,this.locale);window.location.href=(0,_utils.formatWithValidation)(parsedAs);didNavigate=true;}}detectedDomain=detectDomainLocale(this.domainLocales,undefined,this.locale);if(process.env.__NEXT_I18N_SUPPORT){if(!didNavigate&&detectedDomain&&this.isLocaleDomain&&self.location.hostname!==detectedDomain.domain){asNoBasePath=delBasePath(as);window.location.href=\"http\"+(detectedDomain.http?'':'s')+\"://\"+detectedDomain.domain+addBasePath(\"\"+(this.locale===detectedDomain.defaultLocale?'':\"/\"+this.locale)+(asNoBasePath==='/'?'':asNoBasePath)||'/');didNavigate=true;}}if(!didNavigate){_context.next=19;break;}return _context.abrupt(\"return\",new Promise(function(){}));case 19:if(!options._h){this.isSsr=false;}if(_utils.ST){performance.mark('routeChange');}_options$shallow=options.shallow,shallow=_options$shallow===void 0?false:_options$shallow;routeProps={shallow:shallow};if(this._inFlightRoute){this.abortComponentLoad(this._inFlightRoute,routeProps);}as=addBasePath(addLocale(hasBasePath(as)?delBasePath(as):as,options.locale,this.defaultLocale));cleanedAs=delLocale(hasBasePath(as)?delBasePath(as):as,this.locale);this._inFlightRoute=as;if(!(!options._h&&this.onlyAHashChange(cleanedAs))){_context.next=35;break;}this.asPath=cleanedAs;Router.events.emit('hashChangeStart',as,routeProps);this.changeState(method,url,as,options);this.scrollToHash(cleanedAs);this.notify(this.components[this.route],null);Router.events.emit('hashChangeComplete',as,routeProps);return _context.abrupt(\"return\",true);case 35:parsed=(0,_parseRelativeUrl.parseRelativeUrl)(url);pathname=parsed.pathname,query=parsed.query;_context.prev=37;_context.next=40;return _regenerator.default.awrap(this.pageLoader.getPageList());case 40:pages=_context.sent;_context.next=43;return _regenerator.default.awrap((0,_routeLoader.getClientBuildManifest)());case 43:_await=_context.sent;rewrites=_await.__rewrites;_context.next=51;break;case 47:_context.prev=47;_context.t0=_context[\"catch\"](37);window.location.href=as;return _context.abrupt(\"return\",false);case 51:if(!this.urlIsNew(cleanedAs)&&!localeChange){method='replaceState';}resolvedAs=as;pathname=pathname?(0,_normalizeTrailingSlash.removePathTrailingSlash)(delBasePath(pathname)):pathname;if(shouldResolveHref&&pathname!=='/_error'){if(process.env.__NEXT_HAS_REWRITES&&as.startsWith('/')){rewritesResult=(0,_resolveRewrites.default)(addBasePath(addLocale(cleanedAs,this.locale)),pages,rewrites,query,function(p){return resolveDynamicRoute(p,pages);},this.locales);resolvedAs=rewritesResult.asPath;if(rewritesResult.matchedPage&&rewritesResult.resolvedHref){pathname=rewritesResult.resolvedHref;parsed.pathname=pathname;url=(0,_utils.formatWithValidation)(parsed);}}else{parsed.pathname=resolveDynamicRoute(pathname,pages);if(parsed.pathname!==pathname){pathname=parsed.pathname;url=(0,_utils.formatWithValidation)(parsed);}}}route=(0,_normalizeTrailingSlash.removePathTrailingSlash)(pathname);if(isLocalURL(as)){_context.next=61;break;}if(!false){_context.next=59;break;}throw new Error(\"Invalid href: \\\"\"+url+\"\\\" and as: \\\"\"+as+\"\\\", received relative href and external as\"+\"\\nSee more info: https://nextjs.org/docs/messages/invalid-relative-url-external-as\");case 59:window.location.href=as;return _context.abrupt(\"return\",false);case 61:resolvedAs=delLocale(delBasePath(resolvedAs),this.locale);if(!(0,_isDynamic.isDynamicRoute)(route)){_context.next=77;break;}_parsedAs=(0,_parseRelativeUrl.parseRelativeUrl)(resolvedAs);asPathname=_parsedAs.pathname;routeRegex=(0,_routeRegex.getRouteRegex)(route);routeMatch=(0,_routeMatcher.getRouteMatcher)(routeRegex)(asPathname);shouldInterpolate=route===asPathname;interpolatedAs=shouldInterpolate?interpolateAs(route,asPathname,query):{};if(!(!routeMatch||shouldInterpolate&&!interpolatedAs.result)){_context.next=76;break;}missingParams=Object.keys(routeRegex.groups).filter(function(param){return!query[param];});if(!(missingParams.length>0)){_context.next=74;break;}if(false){console.warn((shouldInterpolate?\"Interpolating href\":\"Mismatching `as` and `href`\")+\" failed to manually provide \"+(\"the params: \"+missingParams.join(', ')+\" in the `href`'s `query`\"));}throw new Error((shouldInterpolate?\"The provided `href` (\"+url+\") value is missing query values (\"+missingParams.join(', ')+\") to be interpolated properly. \":\"The provided `as` value (\"+asPathname+\") is incompatible with the `href` value (\"+route+\"). \")+(\"Read more: https://nextjs.org/docs/messages/\"+(shouldInterpolate?'href-interpolation-failed':'incompatible-href-as')));case 74:_context.next=77;break;case 76:if(shouldInterpolate){as=(0,_utils.formatWithValidation)((0,_extends2.default)({},_parsedAs,{pathname:interpolatedAs.result,query:omitParmsFromQuery(query,interpolatedAs.params)}));}else{(0,_extends2.default)(query,routeMatch);}case 77:Router.events.emit('routeChangeStart',as,routeProps);_context.prev=78;_context.next=81;return _regenerator.default.awrap(this.getRouteInfo(route,pathname,query,as,resolvedAs,routeProps));case 81:routeInfo=_context.sent;_routeInfo=routeInfo,error=_routeInfo.error,props=_routeInfo.props,__N_SSG=_routeInfo.__N_SSG,__N_SSP=_routeInfo.__N_SSP;if(!((__N_SSG||__N_SSP)&&props)){_context.next=108;break;}if(!(props.pageProps&&props.pageProps.__N_REDIRECT)){_context.next=94;break;}destination=props.pageProps.__N_REDIRECT;if(!destination.startsWith('/')){_context.next=92;break;}parsedHref=(0,_parseRelativeUrl.parseRelativeUrl)(destination);parsedHref.pathname=resolveDynamicRoute(parsedHref.pathname,pages);if(!pages.includes(parsedHref.pathname)){_context.next=92;break;}_prepareUrlAs3=prepareUrlAs(this,destination,destination),newUrl=_prepareUrlAs3.url,newAs=_prepareUrlAs3.as;return _context.abrupt(\"return\",this.change(method,newUrl,newAs,options));case 92:window.location.href=destination;return _context.abrupt(\"return\",new Promise(function(){}));case 94:this.isPreview=!!props.__N_PREVIEW;if(!(props.notFound===SSG_DATA_NOT_FOUND)){_context.next=108;break;}_context.prev=96;_context.next=99;return _regenerator.default.awrap(this.fetchComponent('/404'));case 99:notFoundRoute='/404';_context.next=105;break;case 102:_context.prev=102;_context.t1=_context[\"catch\"](96);notFoundRoute='/_error';case 105:_context.next=107;return _regenerator.default.awrap(this.getRouteInfo(notFoundRoute,notFoundRoute,query,as,resolvedAs,{shallow:false}));case 107:routeInfo=_context.sent;case 108:Router.events.emit('beforeHistoryChange',as,routeProps);this.changeState(method,url,as,options);if(false){appComp=this.components['/_app'].Component;window.next.isPrerendered=appComp.getInitialProps===appComp.origGetInitialProps&&!routeInfo.Component.getInitialProps;}isValidShallowRoute=options.shallow&&this.route===route;if(options._h&&pathname==='/_error'&&((_self$__NEXT_DATA__$p=self.__NEXT_DATA__.props)==null?void 0:(_self$__NEXT_DATA__$p2=_self$__NEXT_DATA__$p.pageProps)==null?void 0:_self$__NEXT_DATA__$p2.statusCode)===500&&props!=null&&props.pageProps){props.pageProps.statusCode=500;}_context.next=115;return _regenerator.default.awrap(this.set(route,pathname,query,cleanedAs,routeInfo,forcedScroll||(isValidShallowRoute||!options.scroll?null:{x:0,y:0})).catch(function(e){if(e.cancelled)error=error||e;else throw e;}));case 115:if(!error){_context.next=118;break;}Router.events.emit('routeChangeError',error,cleanedAs,routeProps);throw error;case 118:if(process.env.__NEXT_I18N_SUPPORT){if(this.locale){document.documentElement.lang=this.locale;}}Router.events.emit('routeChangeComplete',as,routeProps);return _context.abrupt(\"return\",true);case 123:_context.prev=123;_context.t2=_context[\"catch\"](78);if(!_context.t2.cancelled){_context.next=127;break;}return _context.abrupt(\"return\",false);case 127:throw _context.t2;case 128:case\"end\":return _context.stop();}}},null,this,[[37,47],[78,123],[96,102]],Promise);}},{key:\"changeState\",value:function changeState(method,url,as){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(false){if(typeof window.history==='undefined'){console.error(\"Warning: window.history is not available.\");return;}if(typeof window.history[method]==='undefined'){console.error(\"Warning: window.history.\"+method+\" is not available\");return;}}if(method!=='pushState'||(0,_utils.getURL)()!==as){this._shallow=options.shallow;window.history[method]({url:url,as:as,options:options,__N:true,idx:this._idx=method!=='pushState'?this._idx:this._idx+1},'',as);}}},{key:\"handleRouteInfoError\",value:function handleRouteInfoError(err,pathname,query,as,routeProps,loadErrorFail){var Component,styleSheets,props,_await$this$fetchComp,routeInfo;return _regenerator.default.async(function handleRouteInfoError$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!err.cancelled){_context2.next=2;break;}throw err;case 2:if(!((0,_routeLoader.isAssetError)(err)||loadErrorFail)){_context2.next=6;break;}Router.events.emit('routeChangeError',err,as,routeProps);window.location.href=as;throw buildCancellationError();case 6:_context2.prev=6;if(!(typeof Component==='undefined'||typeof styleSheets==='undefined')){_context2.next=14;break;};_context2.next=11;return _regenerator.default.awrap(this.fetchComponent('/_error'));case 11:_await$this$fetchComp=_context2.sent;Component=_await$this$fetchComp.page;styleSheets=_await$this$fetchComp.styleSheets;case 14:routeInfo={props:props,Component:Component,styleSheets:styleSheets,err:err,error:err};if(routeInfo.props){_context2.next=26;break;}_context2.prev=16;_context2.next=19;return _regenerator.default.awrap(this.getInitialProps(Component,{err:err,pathname:pathname,query:query}));case 19:routeInfo.props=_context2.sent;_context2.next=26;break;case 22:_context2.prev=22;_context2.t0=_context2[\"catch\"](16);console.error('Error in error page `getInitialProps`: ',_context2.t0);routeInfo.props={};case 26:return _context2.abrupt(\"return\",routeInfo);case 29:_context2.prev=29;_context2.t1=_context2[\"catch\"](6);return _context2.abrupt(\"return\",this.handleRouteInfoError(_context2.t1,pathname,query,as,routeProps,true));case 32:case\"end\":return _context2.stop();}}},null,this,[[6,29],[16,22]],Promise);}},{key:\"getRouteInfo\",value:function getRouteInfo(route,pathname,query,as,resolvedAs,routeProps){var _this2=this;var existingRouteInfo,cachedRouteInfo,routeInfo,Component,__N_SSG,__N_SSP,_require,isValidElementType,dataHref,props;return _regenerator.default.async(function getRouteInfo$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;existingRouteInfo=this.components[route];if(!(routeProps.shallow&&existingRouteInfo&&this.route===route)){_context3.next=4;break;}return _context3.abrupt(\"return\",existingRouteInfo);case 4:cachedRouteInfo=existingRouteInfo&&'initial'in existingRouteInfo?undefined:existingRouteInfo;if(!cachedRouteInfo){_context3.next=9;break;}_context3.t0=cachedRouteInfo;_context3.next=12;break;case 9:_context3.next=11;return _regenerator.default.awrap(this.fetchComponent(route).then(function(res){return{Component:res.page,styleSheets:res.styleSheets,__N_SSG:res.mod.__N_SSG,__N_SSP:res.mod.__N_SSP};}));case 11:_context3.t0=_context3.sent;case 12:routeInfo=_context3.t0;Component=routeInfo.Component,__N_SSG=routeInfo.__N_SSG,__N_SSP=routeInfo.__N_SSP;if(!false){_context3.next=18;break;}_require=require('react-is'),isValidElementType=_require.isValidElementType;if(isValidElementType(Component)){_context3.next=18;break;}throw new Error(\"The default export is not a React Component in page: \\\"\"+pathname+\"\\\"\");case 18:if(__N_SSG||__N_SSP){dataHref=this.pageLoader.getDataHref((0,_utils.formatWithValidation)({pathname:pathname,query:query}),resolvedAs,__N_SSG,this.locale);}_context3.next=21;return _regenerator.default.awrap(this._getData(function(){return __N_SSG?_this2._getStaticData(dataHref):__N_SSP?_this2._getServerData(dataHref):_this2.getInitialProps(Component,{pathname:pathname,query:query,asPath:as,locale:_this2.locale,locales:_this2.locales,defaultLocale:_this2.defaultLocale});}));case 21:props=_context3.sent;routeInfo.props=props;this.components[route]=routeInfo;return _context3.abrupt(\"return\",routeInfo);case 27:_context3.prev=27;_context3.t1=_context3[\"catch\"](0);return _context3.abrupt(\"return\",this.handleRouteInfoError(_context3.t1,pathname,query,as,routeProps));case 30:case\"end\":return _context3.stop();}}},null,this,[[0,27]],Promise);}},{key:\"set\",value:function set(route,pathname,query,as,data,resetScroll){this.isFallback=false;this.route=route;this.pathname=pathname;this.query=query;this.asPath=as;return this.notify(data,resetScroll);}},{key:\"beforePopState\",value:function beforePopState(cb){this._bps=cb;}},{key:\"onlyAHashChange\",value:function onlyAHashChange(as){if(!this.asPath)return false;var _this$asPath$split=this.asPath.split('#'),_this$asPath$split2=(0,_slicedToArray2.default)(_this$asPath$split,2),oldUrlNoHash=_this$asPath$split2[0],oldHash=_this$asPath$split2[1];var _as$split=as.split('#'),_as$split2=(0,_slicedToArray2.default)(_as$split,2),newUrlNoHash=_as$split2[0],newHash=_as$split2[1];if(newHash&&oldUrlNoHash===newUrlNoHash&&oldHash===newHash){return true;}if(oldUrlNoHash!==newUrlNoHash){return false;}return oldHash!==newHash;}},{key:\"scrollToHash\",value:function scrollToHash(as){var _as$split3=as.split('#'),_as$split4=(0,_slicedToArray2.default)(_as$split3,2),hash=_as$split4[1];if(hash===''||hash==='top'){window.scrollTo(0,0);return;}var idEl=document.getElementById(hash);if(idEl){idEl.scrollIntoView();return;}var nameEl=document.getElementsByName(hash)[0];if(nameEl){nameEl.scrollIntoView();}}},{key:\"urlIsNew\",value:function urlIsNew(asPath){return this.asPath!==asPath;}},{key:\"prefetch\",value:function prefetch(url){var _this3=this;var asPath,options,parsed,pathname,parsedAs,localePathResult,pages,resolvedAs,rewrites,_await2,rewritesResult,route,_args4=arguments;return _regenerator.default.async(function prefetch$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:asPath=_args4.length>1&&_args4[1]!==undefined?_args4[1]:url;options=_args4.length>2&&_args4[2]!==undefined?_args4[2]:{};parsed=(0,_parseRelativeUrl.parseRelativeUrl)(url);pathname=parsed.pathname;if(process.env.__NEXT_I18N_SUPPORT){if(options.locale===false){pathname=(0,_normalizeLocalePath.normalizeLocalePath)(pathname,this.locales).pathname;parsed.pathname=pathname;url=(0,_utils.formatWithValidation)(parsed);parsedAs=(0,_parseRelativeUrl.parseRelativeUrl)(asPath);localePathResult=(0,_normalizeLocalePath.normalizeLocalePath)(parsedAs.pathname,this.locales);parsedAs.pathname=localePathResult.pathname;options.locale=localePathResult.detectedLocale||this.defaultLocale;asPath=(0,_utils.formatWithValidation)(parsedAs);}}_context4.next=7;return _regenerator.default.awrap(this.pageLoader.getPageList());case 7:pages=_context4.sent;resolvedAs=asPath;if(!(process.env.__NEXT_HAS_REWRITES&&asPath.startsWith('/'))){_context4.next=19;break;}_context4.next=12;return _regenerator.default.awrap((0,_routeLoader.getClientBuildManifest)());case 12:_await2=_context4.sent;rewrites=_await2.__rewrites;rewritesResult=(0,_resolveRewrites.default)(addBasePath(addLocale(asPath,this.locale)),pages,rewrites,parsed.query,function(p){return resolveDynamicRoute(p,pages);},this.locales);resolvedAs=delLocale(delBasePath(rewritesResult.asPath),this.locale);if(rewritesResult.matchedPage&&rewritesResult.resolvedHref){pathname=rewritesResult.resolvedHref;parsed.pathname=pathname;url=(0,_utils.formatWithValidation)(parsed);}_context4.next=21;break;case 19:parsed.pathname=resolveDynamicRoute(parsed.pathname,pages);if(parsed.pathname!==pathname){pathname=parsed.pathname;url=(0,_utils.formatWithValidation)(parsed);}case 21:route=(0,_normalizeTrailingSlash.removePathTrailingSlash)(pathname);if(!false){_context4.next=24;break;}return _context4.abrupt(\"return\");case 24:_context4.next=26;return _regenerator.default.awrap(Promise.all([this.pageLoader._isSsg(route).then(function(isSsg){return isSsg?_this3._getStaticData(_this3.pageLoader.getDataHref(url,resolvedAs,true,typeof options.locale!=='undefined'?options.locale:_this3.locale)):false;}),this.pageLoader[options.priority?'loadPage':'prefetch'](route)]));case 26:case\"end\":return _context4.stop();}}},null,this,null,Promise);}},{key:\"fetchComponent\",value:function fetchComponent(route){var cancelled,cancel,componentResult,error;return _regenerator.default.async(function fetchComponent$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:cancelled=false;cancel=this.clc=function(){cancelled=true;};_context5.next=4;return _regenerator.default.awrap(this.pageLoader.loadPage(route));case 4:componentResult=_context5.sent;if(!cancelled){_context5.next=9;break;}error=new Error(\"Abort fetching component for route: \\\"\"+route+\"\\\"\");error.cancelled=true;throw error;case 9:if(cancel===this.clc){this.clc=null;}return _context5.abrupt(\"return\",componentResult);case 11:case\"end\":return _context5.stop();}}},null,this,null,Promise);}},{key:\"_getData\",value:function _getData(fn){var _this4=this;var cancelled=false;var cancel=function cancel(){cancelled=true;};this.clc=cancel;return fn().then(function(data){if(cancel===_this4.clc){_this4.clc=null;}if(cancelled){var err=new Error('Loading initial props cancelled');err.cancelled=true;throw err;}return data;});}},{key:\"_getStaticData\",value:function _getStaticData(dataHref){var _this5=this;var _URL=new URL(dataHref,window.location.href),cacheKey=_URL.href;if(true&&!this.isPreview&&this.sdc[cacheKey]){return Promise.resolve(this.sdc[cacheKey]);}return fetchNextData(dataHref,this.isSsr).then(function(data){_this5.sdc[cacheKey]=data;return data;});}},{key:\"_getServerData\",value:function _getServerData(dataHref){var _this6=this;var _URL2=new URL(dataHref,window.location.href),resourceKey=_URL2.href;if(this.sdr[resourceKey]){return this.sdr[resourceKey];}return this.sdr[resourceKey]=fetchNextData(dataHref,this.isSsr).then(function(data){delete _this6.sdr[resourceKey];return data;}).catch(function(err){delete _this6.sdr[resourceKey];throw err;});}},{key:\"getInitialProps\",value:function getInitialProps(Component,ctx){var App=this.components['/_app'].Component;var AppTree=this._wrapApp(App);ctx.AppTree=AppTree;return(0,_utils.loadGetInitialProps)(App,{AppTree:AppTree,Component:Component,router:this,ctx:ctx});}},{key:\"abortComponentLoad\",value:function abortComponentLoad(as,routeProps){if(this.clc){Router.events.emit('routeChangeError',buildCancellationError(),as,routeProps);this.clc();this.clc=null;}}},{key:\"notify\",value:function notify(data,resetScroll){return this.sub(data,this.components['/_app'].Component,resetScroll);}}]);return Router;}();exports.default=Router;Router.events=(0,_mitt.default)();","map":null,"metadata":{},"sourceType":"script"}