{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import*as React from'react';import{useEffect,useState}from'react';import{View}from\"../UI\";import{Col,Row}from\"../../containers\";import{ImageUploader}from\"../ImageUploader\";import{makeStyles}from\"./styles\";import{useFirestore,useFirestoreConnect}from'react-redux-firebase';import{useDispatch,useSelector}from'react-redux';import{collectSysError}from\"../../store/actions\";import{useBunnyKit}from\"../../hooks/bunny-kit\";export function UserAlbumEditor(props){var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp,user=_useBunnyKit.user;var styles=makeStyles(sizeLabor,themeLabor);var dispatch=useDispatch();var firebaseUser=user==null?void 0:user.firebaseUser;var userId='';if(firebaseUser){userId=firebaseUser.uid;}var _props$photoPath=props.photoPath,photoPath=_props$photoPath===void 0?\"usersWithPhotos/\"+userId:_props$photoPath;var firestore=useFirestore();useFirestoreConnect(photoPath);var usersWithPhotos=useSelector(function(state){return state.firestoreState.ordered.usersWithPhotos;});var _imageUploaderError=function _imageUploaderError(e){dispatch(collectSysError(e));};var _removePhoto=function _removePhoto(position,source){return _regeneratorRuntime.async(function _removePhoto$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(firestore.update(photoPath,_defineProperty({},position,{uri:''})));case 2:case\"end\":return _context.stop();}}},null,null,null,Promise);};var _savePhoto=function _savePhoto(position,photoUrl){return _regeneratorRuntime.async(function _savePhoto$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(photoUrl){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:_context2.next=4;return _regeneratorRuntime.awrap(firestore.update(photoPath,_defineProperty({},position,{uri:photoUrl})));case 4:case\"end\":return _context2.stop();}}},null,null,null,Promise);};var _useState=useState(),_useState2=_slicedToArray(_useState,2),sources=_useState2[0],setSources=_useState2[1];useEffect(function(){if(usersWithPhotos&&usersWithPhotos.length>0){setSources(usersWithPhotos[0]);}},[usersWithPhotos]);useEffect(function(){(function _callee(){var doc;return _regeneratorRuntime.async(function _callee$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(firestore.get(photoPath));case 2:doc=_context3.sent;if(doc.exists){_context3.next=6;break;}_context3.next=6;return _regeneratorRuntime.awrap(firestore.set(photoPath,{'0':{uri:''},'1':{uri:''},'2':{uri:''},'3':{uri:''},'4':{uri:''},'5':{uri:''}}));case 6:case\"end\":return _context3.stop();}}},null,null,null,Promise);})();},[]);var userPhotosPath=\"/userPhotos/\"+userId;return React.createElement(View,{style:styles.albumContainer},sources?React.createElement(View,{style:{height:wp(375),width:wp(375)}},React.createElement(Row,{size:2},React.createElement(Col,{size:2},React.createElement(ImageUploader,{source:sources[0],path:userPhotosPath,isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee2(value){return _regeneratorRuntime.async(function _callee2$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(_savePhoto('0',value.uri));case 2:case\"end\":return _context4.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee3(needRemove){return _regeneratorRuntime.async(function _callee3$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return _regeneratorRuntime.awrap(_removePhoto('0',needRemove));case 2:case\"end\":return _context5.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})),React.createElement(Col,{size:1,style:{marginLeft:wp(2)}},React.createElement(Row,{size:1},React.createElement(ImageUploader,{path:userPhotosPath,source:sources[1],isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee4(value){return _regeneratorRuntime.async(function _callee4$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return _regeneratorRuntime.awrap(_savePhoto('1',value.uri));case 2:case\"end\":return _context6.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee5(needRemove){return _regeneratorRuntime.async(function _callee5$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return _regeneratorRuntime.awrap(_removePhoto('1',needRemove));case 2:case\"end\":return _context7.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})),React.createElement(Row,{size:1,style:{marginTop:wp(2)}},React.createElement(ImageUploader,{path:userPhotosPath,source:sources[2],isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee6(value){return _regeneratorRuntime.async(function _callee6$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return _regeneratorRuntime.awrap(_savePhoto('2',value.uri));case 2:case\"end\":return _context8.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee7(needRemove){return _regeneratorRuntime.async(function _callee7$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return _regeneratorRuntime.awrap(_removePhoto('2',needRemove));case 2:case\"end\":return _context9.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})))),React.createElement(Row,{size:1,style:{marginTop:wp(2)}},React.createElement(Col,{size:1},React.createElement(ImageUploader,{path:userPhotosPath,source:sources[3],isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee8(value){return _regeneratorRuntime.async(function _callee8$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return _regeneratorRuntime.awrap(_savePhoto('3',value.uri));case 2:case\"end\":return _context10.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee9(needRemove){return _regeneratorRuntime.async(function _callee9$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return _regeneratorRuntime.awrap(_removePhoto('3',needRemove));case 2:case\"end\":return _context11.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})),React.createElement(Col,{size:1,style:{marginLeft:wp(2)}},React.createElement(ImageUploader,{path:userPhotosPath,source:sources[4],isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee10(value){return _regeneratorRuntime.async(function _callee10$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return _regeneratorRuntime.awrap(_savePhoto('4',value.uri));case 2:case\"end\":return _context12.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee11(needRemove){return _regeneratorRuntime.async(function _callee11$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return _regeneratorRuntime.awrap(_removePhoto('4',needRemove));case 2:case\"end\":return _context13.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})),React.createElement(Col,{size:1,style:{marginLeft:wp(2)}},React.createElement(ImageUploader,{path:userPhotosPath,source:sources[5],isFullFill:true,isDeleteFromServerWhenRemove:true,isDeleteFromServerWhenUpload:true,onValueChanged:function _callee12(value){return _regeneratorRuntime.async(function _callee12$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return _regeneratorRuntime.awrap(_savePhoto('5',value.uri));case 2:case\"end\":return _context14.stop();}}},null,null,null,Promise);},onRemovePhoto:function _callee13(needRemove){return _regeneratorRuntime.async(function _callee13$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:_context15.next=2;return _regeneratorRuntime.awrap(_removePhoto('5',needRemove));case 2:case\"end\":return _context15.stop();}}},null,null,null,Promise);},onError:_imageUploaderError})))):null);}","map":null,"metadata":{},"sourceType":"module"}