{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import Platform from\"react-native-web/dist/exports/Platform\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import{ActionSheetProvider}from\"../../../packages/react-native-action-sheet/src\";import{v4}from'uuid';import{getBottomSpace}from'react-native-iphone-x-helper';import dayjs from'dayjs';import localizedFormat from'dayjs/plugin/localizedFormat';import*as utils from\"./utils\";import Actions from\"./Actions\";import ChatAvatar from\"./ChatAvatar\";import Bubble from\"./Bubble\";import SystemMessage from\"./SystemMessage\";import MessageImage from\"./MessageImage\";import MessageSticker from\"./MessageSticker\";import MessageText from\"./MessageText\";import Composer from\"./Composer\";import Day from\"./Day\";import InputToolbar from\"./InputToolbar\";import LoadEarlier from\"./LoadEarlier\";import Message from\"./Message\";import MessageContainer from\"./MessageContainer\";import Send from\"./Send\";import Time from\"./Time\";import BunnyAvatar from\"./BunnyAvatar\";import{DATE_FORMAT,DEFAULT_PLACEHOLDER,MAX_COMPOSER_HEIGHT,MIN_COMPOSER_HEIGHT,TIME_FORMAT}from\"./Constant\";import{withBunnyKit}from\"../../hooks/bunny-kit\";dayjs.extend(localizedFormat);var BunnyChatInner=function(_React$Component){_inherits(BunnyChatInner,_React$Component);var _super=_createSuper(BunnyChatInner);function BunnyChatInner(props){var _this;_classCallCheck(this,BunnyChatInner);_this=_super.call(this,props);_this._isMounted=false;_this._keyboardHeight=0;_this._bottomOffset=0;_this._maxHeight=undefined;_this._isFirstLayout=true;_this._locale='en';_this.invertibleScrollViewProps=undefined;_this._actionSheetRef=undefined;_this._messageContainerRef=React.createRef();_this._isTextInputWasFocused=false;_this.state={isInitialized:false,composerHeight:_this.props.minComposerHeight,messagesContainerHeight:undefined,typingDisabled:false,text:undefined,messages:undefined};_this.safeAreaSupport=function(bottomOffset){return bottomOffset!=null?bottomOffset:getBottomSpace();};_this.onKeyboardWillShow=function(e){_this.handleTextInputFocusWhenKeyboardShow();if(_this.props.isKeyboardInternallyHandled){_this.setIsTypingDisabled(true);_this.setKeyboardHeight(e.endCoordinates?e.endCoordinates.height:e.end.height);_this.setBottomOffset(_this.safeAreaSupport(_this.props.bottomOffset));var newMessagesContainerHeight=_this.getMessagesContainerHeightWithKeyboard();_this.setState({messagesContainerHeight:newMessagesContainerHeight});}};_this.onKeyboardWillHide=function(_e){_this.handleTextInputFocusWhenKeyboardHide();if(_this.props.isKeyboardInternallyHandled){_this.setIsTypingDisabled(true);_this.setKeyboardHeight(0);_this.setBottomOffset(0);var newMessagesContainerHeight=_this.getBasicMessagesContainerHeight();_this.setState({messagesContainerHeight:newMessagesContainerHeight});}};_this.onKeyboardDidShow=function(e){if(Platform.OS==='android'){_this.onKeyboardWillShow(e);}_this.setIsTypingDisabled(false);};_this.onKeyboardDidHide=function(e){if(Platform.OS==='android'){_this.onKeyboardWillHide(e);}_this.setIsTypingDisabled(false);};_this.onSend=function(){var messages=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var shouldResetInputToolbar=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!Array.isArray(messages)){messages=[messages];}var newMessages=messages.map(function(message){return _objectSpread(_objectSpread({},message),{},{user:_this.props.user,createdAt:new Date(),_id:_this.props.messageIdGenerator&&_this.props.messageIdGenerator()});});if(shouldResetInputToolbar){_this.setIsTypingDisabled(true);_this.resetInputToolbar();}if(_this.props.onSend){_this.props.onSend(newMessages,shouldResetInputToolbar);}if(shouldResetInputToolbar){setTimeout(function(){if(_this.getIsMounted()){_this.setIsTypingDisabled(false);}},100);}};_this.onInputSizeChanged=function(size){var wp=_this.props.bunnyKit.wp;var newComposerHeight=Math.max(_this.props.minComposerHeight,Math.min(_this.props.maxComposerHeight,size.height));var newMessagesContainerHeight=_this.getMessagesContainerHeightWithKeyboard(newComposerHeight);_this.setState({composerHeight:newComposerHeight,messagesContainerHeight:newMessagesContainerHeight});};_this.onInputTextChanged=function(text){if(_this.getIsTypingDisabled()){return;}if(_this.props.onInputTextChanged){_this.props.onInputTextChanged(text);}if(_this.props.text===undefined){_this.setState({text:text});}};_this.onInitialLayoutViewLayout=function(e){var layout=e.nativeEvent.layout;if(layout.height<=0){return;}_this.notifyInputTextReset();_this.setMaxHeight(layout.height);var newComposerHeight=_this.props.minComposerHeight;var newMessagesContainerHeight=_this.getMessagesContainerHeightWithKeyboard(newComposerHeight);var initialText=_this.props.initialText||'';_this.setState({isInitialized:true,text:_this.getTextFromProp(initialText),composerHeight:newComposerHeight,messagesContainerHeight:newMessagesContainerHeight});};_this.onMainViewLayout=function(e){var layout=e.nativeEvent.layout;if(_this.getMaxHeight()!==layout.height||_this.getIsFirstLayout()===true){_this.setMaxHeight(layout.height);_this.setState({messagesContainerHeight:_this._keyboardHeight>0?_this.getMessagesContainerHeightWithKeyboard():_this.getBasicMessagesContainerHeight()});}if(_this.getIsFirstLayout()===true){_this.setIsFirstLayout(false);}};_this.invertibleScrollViewProps={inverted:_this.props.inverted,keyboardShouldPersistTaps:_this.props.keyboardShouldPersistTaps,onKeyboardWillShow:_this.onKeyboardWillShow,onKeyboardWillHide:_this.onKeyboardWillHide,onKeyboardDidShow:_this.onKeyboardDidShow,onKeyboardDidHide:_this.onKeyboardDidHide};return _this;}_createClass(BunnyChatInner,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props=this.props,messages=_this$props.messages,text=_this$props.text;this.setIsMounted(true);this.setMessages(messages||[]);this.setTextFromProp(text);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.setIsMounted(false);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this2=this;var _this$props2=this.props,messages=_this$props2.messages,text=_this$props2.text,inverted=_this$props2.inverted;if(this.props!==prevProps){this.setMessages(messages||[]);}if(inverted===false&&messages&&prevProps.messages&&messages.length!==prevProps.messages.length){setTimeout(function(){return _this2.scrollToBottom(false);},200);}if(text!==prevProps.text){this.setTextFromProp(text);}}},{key:\"setTextFromProp\",value:function setTextFromProp(textProp){if(textProp!==undefined&&textProp!==this.state.text){this.setState({text:textProp});}}},{key:\"getTextFromProp\",value:function getTextFromProp(fallback){if(this.props.text===undefined){return fallback;}return this.props.text;}},{key:\"setMessages\",value:function setMessages(messages){this.setState({messages:messages});}},{key:\"getMessages\",value:function getMessages(){return this.state.messages;}},{key:\"setMaxHeight\",value:function setMaxHeight(height){this._maxHeight=height;}},{key:\"getMaxHeight\",value:function getMaxHeight(){return this._maxHeight;}},{key:\"setKeyboardHeight\",value:function setKeyboardHeight(height){this._keyboardHeight=height;}},{key:\"getKeyboardHeight\",value:function getKeyboardHeight(){if(Platform.OS==='android'&&!this.props.forceGetKeyboardHeight){return 0;}return this._keyboardHeight;}},{key:\"setBottomOffset\",value:function setBottomOffset(value){this._bottomOffset=value;}},{key:\"getBottomOffset\",value:function getBottomOffset(){return this._bottomOffset;}},{key:\"setIsFirstLayout\",value:function setIsFirstLayout(value){this._isFirstLayout=value;}},{key:\"getIsFirstLayout\",value:function getIsFirstLayout(){return this._isFirstLayout;}},{key:\"setIsTypingDisabled\",value:function setIsTypingDisabled(value){this.setState({typingDisabled:value});}},{key:\"getIsTypingDisabled\",value:function getIsTypingDisabled(){return this.state.typingDisabled;}},{key:\"setIsMounted\",value:function setIsMounted(value){this._isMounted=value;}},{key:\"getIsMounted\",value:function getIsMounted(){return this._isMounted;}},{key:\"getMinInputToolbarHeight\",value:function getMinInputToolbarHeight(){return this.props.renderAccessory?this.props.minInputToolbarHeight*2:this.props.minInputToolbarHeight;}},{key:\"calculateInputToolbarHeight\",value:function calculateInputToolbarHeight(composerHeight){return composerHeight+(this.getMinInputToolbarHeight()-this.props.minComposerHeight);}},{key:\"getBasicMessagesContainerHeight\",value:function getBasicMessagesContainerHeight(){var composerHeight=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.state.composerHeight;return this.getMaxHeight()-this.calculateInputToolbarHeight(composerHeight);}},{key:\"getMessagesContainerHeightWithKeyboard\",value:function getMessagesContainerHeightWithKeyboard(){var composerHeight=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.state.composerHeight;return this.getBasicMessagesContainerHeight(composerHeight)-this.getKeyboardHeight()+this.getBottomOffset();}},{key:\"handleTextInputFocusWhenKeyboardHide\",value:function handleTextInputFocusWhenKeyboardHide(){if(!this._isTextInputWasFocused){var _this$textInput;this._isTextInputWasFocused=((_this$textInput=this.textInput)==null?void 0:_this$textInput.isFocused())||false;}}},{key:\"handleTextInputFocusWhenKeyboardShow\",value:function handleTextInputFocusWhenKeyboardShow(){if(this.textInput&&this._isTextInputWasFocused&&!this.textInput.isFocused()){this.textInput.focus();}this._isTextInputWasFocused=false;}},{key:\"scrollToBottom\",value:function scrollToBottom(){var animated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this._messageContainerRef&&this._messageContainerRef.current){var inverted=this.props.inverted;if(!inverted){this._messageContainerRef.current.scrollToEnd({animated:animated});}else{this._messageContainerRef.current.scrollToOffset({offset:0,animated:animated});}}}},{key:\"renderMessages\",value:function renderMessages(){var _this$props3=this.props,audioProps=_this$props3.audioProps,alignTop=_this$props3.alignTop,activityIndicatorSize=_this$props3.activityIndicatorSize,activityIndicatorStyle=_this$props3.activityIndicatorStyle,audioContainerStyle=_this$props3.audioContainerStyle,audioStyle=_this$props3.audioStyle,avatarContainerStyle=_this$props3.avatarContainerStyle,avatarImageStyle=_this$props3.avatarImageStyle,avatarTextStyle=_this$props3.avatarTextStyle,activityIndicatorColor=_this$props3.activityIndicatorColor,bottomContainerStyle=_this$props3.bottomContainerStyle,bubbleContainerStyle=_this$props3.bubbleContainerStyle,bubbleWrapperStyle=_this$props3.bubbleWrapperStyle,customTextStyle=_this$props3.customTextStyle,containerToPreviousStyle=_this$props3.containerToPreviousStyle,containerToNextStyle=_this$props3.containerToNextStyle,dayWrapperStyle=_this$props3.dayWrapperStyle,dayTextStyle=_this$props3.dayTextStyle,dayTextProps=_this$props3.dayTextProps,dayContainerStyle=_this$props3.dayContainerStyle,dateFormat=_this$props3.dateFormat,extraData=_this$props3.extraData,forwardRef=_this$props3.forwardRef,renderFooter=_this$props3.renderFooter,isDebug=_this$props3.isDebug,isTyping=_this$props3.isTyping,isLoadingEarlier=_this$props3.isLoadingEarlier,isCustomViewBottom=_this$props3.isCustomViewBottom,invertibleScrollViewProps=_this$props3.invertibleScrollViewProps,inverted=_this$props3.inverted,infiniteScroll=_this$props3.infiniteScroll,imageStyle=_this$props3.imageStyle,imageProps=_this$props3.imageProps,imageContainerStyle=_this$props3.imageContainerStyle,keepReplies=_this$props3.keepReplies,loadEarlierWrapperStyle=_this$props3.loadEarlierWrapperStyle,loadEarlierTextStyle=_this$props3.loadEarlierTextStyle,loadEarlierContainerStyle=_this$props3.loadEarlierContainerStyle,loadEarlier=_this$props3.loadEarlier,listViewProps=_this$props3.listViewProps,linkStyle=_this$props3.linkStyle,lightBoxProps=_this$props3.lightBoxProps,loadEarlierLabel=_this$props3.loadEarlierLabel,messages=_this$props3.messages,messagesContainerStyle=_this$props3.messagesContainerStyle,nextMessage=_this$props3.nextMessage,onMessageReadyForDisplay=_this$props3.onMessageReadyForDisplay,onQuickReply=_this$props3.onQuickReply,onPressAvatar=_this$props3.onPressAvatar,onPress=_this$props3.onPress,onMessageLayout=_this$props3.onMessageLayout,onLongPressAvatar=_this$props3.onLongPressAvatar,onLongPress=_this$props3.onLongPress,onLoadEarlier=_this$props3.onLoadEarlier,onMessageLoad=_this$props3.onMessageLoad,onMessageLoadError=_this$props3.onMessageLoadError,onMessageLoadStart=_this$props3.onMessageLoadStart,onMessageLoadEnd=_this$props3.onMessageLoadEnd,phoneNumberOptionTitles=_this$props3.phoneNumberOptionTitles,previousMessage=_this$props3.previousMessage,parsePatterns=_this$props3.parsePatterns,quickReplyStyle=_this$props3.quickReplyStyle,quickRepliesColor=_this$props3.quickRepliesColor,renderTicks=_this$props3.renderTicks,renderSystemMessage=_this$props3.renderSystemMessage,renderScrollToBottom=_this$props3.renderScrollToBottom,renderQuickReplySend=_this$props3.renderQuickReplySend,renderQuickReplies=_this$props3.renderQuickReplies,renderMessageVideo=_this$props3.renderMessageVideo,renderMessageText=_this$props3.renderMessageText,renderMessageSticker=_this$props3.renderMessageSticker,renderMessageImage=_this$props3.renderMessageImage,renderMessageAudio=_this$props3.renderMessageAudio,renderMessage=_this$props3.renderMessage,renderLoadEarlier=_this$props3.renderLoadEarlier,renderDay=_this$props3.renderDay,renderCustomView=_this$props3.renderCustomView,renderChatEmpty=_this$props3.renderChatEmpty,renderBubble=_this$props3.renderBubble,renderAvatarOnTop=_this$props3.renderAvatarOnTop,renderAvatar=_this$props3.renderAvatar,renderTime=_this$props3.renderTime,renderUsernameOnMessage=_this$props3.renderUsernameOnMessage,sendText=_this$props3.sendText,stickerStyle=_this$props3.stickerStyle,stickerProps=_this$props3.stickerProps,scrollToBottom=_this$props3.scrollToBottom,scrollToBottomOffset=_this$props3.scrollToBottomOffset,scrollToBottomStyle=_this$props3.scrollToBottomStyle,shouldUpdateMessage=_this$props3.shouldUpdateMessage,showAvatarForEveryMessage=_this$props3.showAvatarForEveryMessage,showUserAvatar=_this$props3.showUserAvatar,stickerContainerStyle=_this$props3.stickerContainerStyle,systemMessageContainerStyle=_this$props3.systemMessageContainerStyle,systemMessageWrapperStyle=_this$props3.systemMessageWrapperStyle,systemTextStyle=_this$props3.systemTextStyle,textStyle=_this$props3.textStyle,textLongPressOptionTitles=_this$props3.textLongPressOptionTitles,timeContainerStyle=_this$props3.timeContainerStyle,textContainerStyle=_this$props3.textContainerStyle,textProps=_this$props3.textProps,tickStyle=_this$props3.tickStyle,timeFormat=_this$props3.timeFormat,timeTextStyle=_this$props3.timeTextStyle,touchableProps=_this$props3.touchableProps,user=_this$props3.user,usernameStyle=_this$props3.usernameStyle,videoContainerStyle=_this$props3.videoContainerStyle,videoProps=_this$props3.videoProps,videoStyle=_this$props3.videoStyle,audioProgressStyle=_this$props3.audioProgressStyle,audioPlayButtonStyle=_this$props3.audioPlayButtonStyle,audioProgressColor=_this$props3.audioProgressColor,audioRemainTimeStyle=_this$props3.audioRemainTimeStyle,audioPlayButtonIconStyle=_this$props3.audioPlayButtonIconStyle;var messageContainerProps={audioProps:audioProps,alignTop:alignTop,activityIndicatorSize:activityIndicatorSize,activityIndicatorStyle:activityIndicatorStyle,audioContainerStyle:audioContainerStyle,audioStyle:audioStyle,avatarContainerStyle:avatarContainerStyle,avatarImageStyle:avatarImageStyle,avatarTextStyle:avatarTextStyle,activityIndicatorColor:activityIndicatorColor,bottomContainerStyle:bottomContainerStyle,bubbleContainerStyle:bubbleContainerStyle,bubbleWrapperStyle:bubbleWrapperStyle,customTextStyle:customTextStyle,containerToPreviousStyle:containerToPreviousStyle,containerToNextStyle:containerToNextStyle,dayWrapperStyle:dayWrapperStyle,dayTextStyle:dayTextStyle,dayTextProps:dayTextProps,dayContainerStyle:dayContainerStyle,dateFormat:dateFormat,extraData:extraData,forwardRef:forwardRef,renderFooter:renderFooter,isDebug:isDebug,isTyping:isTyping,isLoadingEarlier:isLoadingEarlier,isCustomViewBottom:isCustomViewBottom,invertibleScrollViewProps:invertibleScrollViewProps,inverted:inverted,infiniteScroll:infiniteScroll,imageStyle:imageStyle,imageProps:imageProps,imageContainerStyle:imageContainerStyle,keepReplies:keepReplies,loadEarlierWrapperStyle:loadEarlierWrapperStyle,loadEarlierTextStyle:loadEarlierTextStyle,loadEarlierContainerStyle:loadEarlierContainerStyle,loadEarlier:loadEarlier,listViewProps:listViewProps,linkStyle:linkStyle,lightBoxProps:lightBoxProps,loadEarlierLabel:loadEarlierLabel,messages:messages,nextMessage:nextMessage,onMessageReadyForDisplay:onMessageReadyForDisplay,onQuickReply:onQuickReply,onPressAvatar:onPressAvatar,onPress:onPress,onMessageLayout:onMessageLayout,onLongPressAvatar:onLongPressAvatar,onLongPress:onLongPress,onLoadEarlier:onLoadEarlier,onMessageLoad:onMessageLoad,onMessageLoadError:onMessageLoadError,onMessageLoadStart:onMessageLoadStart,onMessageLoadEnd:onMessageLoadEnd,phoneNumberOptionTitles:phoneNumberOptionTitles,previousMessage:previousMessage,parsePatterns:parsePatterns,quickReplyStyle:quickReplyStyle,quickRepliesColor:quickRepliesColor,renderTicks:renderTicks,renderSystemMessage:renderSystemMessage,renderScrollToBottom:renderScrollToBottom,renderQuickReplySend:renderQuickReplySend,renderQuickReplies:renderQuickReplies,renderMessageVideo:renderMessageVideo,renderMessageText:renderMessageText,renderMessageSticker:renderMessageSticker,renderMessageImage:renderMessageImage,renderMessageAudio:renderMessageAudio,renderMessage:renderMessage,renderLoadEarlier:renderLoadEarlier,renderDay:renderDay,renderCustomView:renderCustomView,renderChatEmpty:renderChatEmpty,renderBubble:renderBubble,renderAvatarOnTop:renderAvatarOnTop,renderAvatar:renderAvatar,renderTime:renderTime,renderUsernameOnMessage:renderUsernameOnMessage,sendText:sendText,stickerStyle:stickerStyle,stickerProps:stickerProps,scrollToBottom:scrollToBottom,scrollToBottomOffset:scrollToBottomOffset,scrollToBottomStyle:scrollToBottomStyle,shouldUpdateMessage:shouldUpdateMessage,showAvatarForEveryMessage:showAvatarForEveryMessage,showUserAvatar:showUserAvatar,stickerContainerStyle:stickerContainerStyle,systemMessageContainerStyle:systemMessageContainerStyle,systemMessageWrapperStyle:systemMessageWrapperStyle,systemTextStyle:systemTextStyle,textStyle:textStyle,textLongPressOptionTitles:textLongPressOptionTitles,timeContainerStyle:timeContainerStyle,textContainerStyle:textContainerStyle,textProps:textProps,tickStyle:tickStyle,timeFormat:timeFormat,timeTextStyle:timeTextStyle,touchableProps:touchableProps,user:user,usernameStyle:usernameStyle,videoContainerStyle:videoContainerStyle,videoProps:videoProps,videoStyle:videoStyle,audioProgressStyle:audioProgressStyle,audioPlayButtonStyle:audioPlayButtonStyle,audioProgressColor:audioProgressColor,audioRemainTimeStyle:audioRemainTimeStyle,audioPlayButtonIconStyle:audioPlayButtonIconStyle};var fragment=React.createElement(View,{style:[{height:this.state.messagesContainerHeight},messagesContainerStyle]},React.createElement(MessageContainer,_extends({},messageContainerProps,{invertibleScrollViewProps:this.invertibleScrollViewProps,messages:this.getMessages(),forwardRef:this._messageContainerRef,isTyping:this.props.isTyping})),this.renderChatFooter());return this.props.isKeyboardInternallyHandled?React.createElement(KeyboardAvoidingView,{enabled:true},fragment):fragment;}},{key:\"resetInputToolbar\",value:function resetInputToolbar(){if(this.textInput){this.textInput.clear();}this.notifyInputTextReset();var newComposerHeight=this.props.minComposerHeight;var newMessagesContainerHeight=this.getMessagesContainerHeightWithKeyboard(newComposerHeight);this.setState({text:this.getTextFromProp(''),composerHeight:newComposerHeight,messagesContainerHeight:newMessagesContainerHeight});}},{key:\"focusTextInput\",value:function focusTextInput(){if(this.textInput){this.textInput.focus();}}},{key:\"notifyInputTextReset\",value:function notifyInputTextReset(){if(this.props.onInputTextChanged){this.props.onInputTextChanged('');}}},{key:\"renderInputToolbar\",value:function renderInputToolbar(){var _this3=this;var _this$props4=this.props,actionsConfig=_this$props4.actionsConfig,actionSheet=_this$props4.actionSheet,alwaysShowSend=_this$props4.alwaysShowSend,audioProps=_this$props4.audioProps,bottomOffset=_this$props4.bottomOffset,composerHeight=_this$props4.composerHeight,dateFormat=_this$props4.dateFormat,disableComposer=_this$props4.disableComposer,extraData=_this$props4.extraData,forceGetKeyboardHeight=_this$props4.forceGetKeyboardHeight,imageProps=_this$props4.imageProps,inverted=_this$props4.inverted,isCustomViewBottom=_this$props4.isCustomViewBottom,isKeyboardInternallyHandled=_this$props4.isKeyboardInternallyHandled,isLoadingEarlier=_this$props4.isLoadingEarlier,keyboardShouldPersistTaps=_this$props4.keyboardShouldPersistTaps,lightBoxProps=_this$props4.lightBoxProps,listViewProps=_this$props4.listViewProps,loadEarlier=_this$props4.loadEarlier,locale=_this$props4.locale,maxComposerHeight=_this$props4.maxComposerHeight,maxInputLength=_this$props4.maxInputLength,messageIdGenerator=_this$props4.messageIdGenerator,messages=_this$props4.messages,messagesContainerStyle=_this$props4.messagesContainerStyle,minComposerHeight=_this$props4.minComposerHeight,minInputToolbarHeight=_this$props4.minInputToolbarHeight,onInputSizeChanged=_this$props4.onInputSizeChanged,onInputTextChanged=_this$props4.onInputTextChanged,onLoadEarlier=_this$props4.onLoadEarlier,onLongPress=_this$props4.onLongPress,onLongPressAvatar=_this$props4.onLongPressAvatar,onMessageLoad=_this$props4.onMessageLoad,onMessageLoadEnd=_this$props4.onMessageLoadEnd,onMessageLoadError=_this$props4.onMessageLoadError,onMessageLoadStart=_this$props4.onMessageLoadStart,onMessageReadyForDisplay=_this$props4.onMessageReadyForDisplay,onPressActionButton=_this$props4.onPressActionButton,onPressAvatar=_this$props4.onPressAvatar,onSend=_this$props4.onSend,onTextChanged=_this$props4.onTextChanged,placeholder=_this$props4.placeholder,renderAccessory=_this$props4.renderAccessory,renderActions=_this$props4.renderActions,renderAvatar=_this$props4.renderAvatar,renderAvatarOnTop=_this$props4.renderAvatarOnTop,renderBubble=_this$props4.renderBubble,renderChatEmpty=_this$props4.renderChatEmpty,renderChatFooter=_this$props4.renderChatFooter,renderComposer=_this$props4.renderComposer,renderCustomView=_this$props4.renderCustomView,renderDay=_this$props4.renderDay,renderFooter=_this$props4.renderFooter,renderInputToolbar=_this$props4.renderInputToolbar,renderLoadEarlier=_this$props4.renderLoadEarlier,renderLoading=_this$props4.renderLoading,renderMessage=_this$props4.renderMessage,renderMessageAudio=_this$props4.renderMessageAudio,renderMessageImage=_this$props4.renderMessageImage,renderMessageSticker=_this$props4.renderMessageSticker,renderMessageText=_this$props4.renderMessageText,renderMessageVideo=_this$props4.renderMessageVideo,renderSend=_this$props4.renderSend,renderSystemMessage=_this$props4.renderSystemMessage,renderTime=_this$props4.renderTime,renderUsernameOnMessage=_this$props4.renderUsernameOnMessage,showUserAvatar=_this$props4.showUserAvatar,stickerProps=_this$props4.stickerProps,text=_this$props4.text,textInputProps=_this$props4.textInputProps,timeFormat=_this$props4.timeFormat,user=_this$props4.user,videoProps=_this$props4.videoProps,wrapInSafeArea=_this$props4.wrapInSafeArea;var inputToolbarProps={actionsConfig:actionsConfig,actionSheet:actionSheet,alwaysShowSend:alwaysShowSend,audioProps:audioProps,bottomOffset:bottomOffset,dateFormat:dateFormat,disableComposer:disableComposer,extraData:extraData,forceGetKeyboardHeight:forceGetKeyboardHeight,imageProps:imageProps,inverted:inverted,isCustomViewBottom:isCustomViewBottom,isKeyboardInternallyHandled:isKeyboardInternallyHandled,isLoadingEarlier:isLoadingEarlier,keyboardShouldPersistTaps:keyboardShouldPersistTaps,lightBoxProps:lightBoxProps,listViewProps:listViewProps,loadEarlier:loadEarlier,locale:locale,maxComposerHeight:maxComposerHeight,maxInputLength:maxInputLength,messageIdGenerator:messageIdGenerator,messages:messages,messagesContainerStyle:messagesContainerStyle,minComposerHeight:minComposerHeight,minInputToolbarHeight:minInputToolbarHeight,onInputTextChanged:onInputTextChanged,onLoadEarlier:onLoadEarlier,onLongPress:onLongPress,onLongPressAvatar:onLongPressAvatar,onMessageLoad:onMessageLoad,onMessageLoadEnd:onMessageLoadEnd,onMessageLoadError:onMessageLoadError,onMessageLoadStart:onMessageLoadStart,onMessageReadyForDisplay:onMessageReadyForDisplay,onPressActionButton:onPressActionButton,onPressAvatar:onPressAvatar,placeholder:placeholder,renderAccessory:renderAccessory,renderActions:renderActions,renderAvatar:renderAvatar,renderAvatarOnTop:renderAvatarOnTop,renderBubble:renderBubble,renderChatEmpty:renderChatEmpty,renderChatFooter:renderChatFooter,renderComposer:renderComposer,renderCustomView:renderCustomView,renderDay:renderDay,renderFooter:renderFooter,renderLoadEarlier:renderLoadEarlier,renderLoading:renderLoading,renderMessage:renderMessage,renderMessageAudio:renderMessageAudio,renderMessageImage:renderMessageImage,renderMessageSticker:renderMessageSticker,renderMessageText:renderMessageText,renderMessageVideo:renderMessageVideo,renderSend:renderSend,renderSystemMessage:renderSystemMessage,renderTime:renderTime,renderUsernameOnMessage:renderUsernameOnMessage,showUserAvatar:showUserAvatar,stickerProps:stickerProps,timeFormat:timeFormat,user:user,videoProps:videoProps,wrapInSafeArea:wrapInSafeArea,text:this.getTextFromProp(this.state.text),composerHeight:Math.max(this.props.minComposerHeight,this.state.composerHeight),onSend:this.onSend,onInputSizeChanged:this.onInputSizeChanged,onTextChanged:this.onInputTextChanged,textInputProps:_objectSpread(_objectSpread({},textInputProps),{},{ref:function ref(textInput){return _this3.textInput=textInput;},maxLength:this.getIsTypingDisabled()?0:this.props.maxInputLength})};if(this.props.renderInputToolbar){return this.props.renderInputToolbar(inputToolbarProps);}return React.createElement(InputToolbar,inputToolbarProps);}},{key:\"renderChatFooter\",value:function renderChatFooter(){if(this.props.renderChatFooter){return this.props.renderChatFooter();}return null;}},{key:\"renderLoading\",value:function renderLoading(){if(this.props.renderLoading){return this.props.renderLoading();}return null;}},{key:\"render\",value:function render(){var _this4=this;var _this$props$bunnyKit=this.props.bunnyKit,sizeLabor=_this$props$bunnyKit.sizeLabor,themeLabor=_this$props$bunnyKit.themeLabor;var styles=makeStyles(sizeLabor,themeLabor);if(this.state.isInitialized===true){var wrapInSafeArea=this.props.wrapInSafeArea;var Wrapper=wrapInSafeArea?SafeAreaView:View;return React.createElement(Wrapper,{style:styles.safeArea},React.createElement(ActionSheetProvider,{ref:function ref(component){return _this4._actionSheetRef=component;}},React.createElement(View,{style:styles.container,onLayout:this.onMainViewLayout},this.renderMessages(),this.renderInputToolbar())));}return React.createElement(View,{style:styles.container,onLayout:this.onInitialLayoutViewLayout},this.renderLoading());}}],[{key:\"append\",value:function append(){var currentMessages=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var messages=arguments.length>1?arguments[1]:undefined;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(!Array.isArray(messages)){messages=[messages];}return inverted?messages.concat(currentMessages):currentMessages.concat(messages);}},{key:\"prepend\",value:function prepend(){var currentMessages=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var messages=arguments.length>1?arguments[1]:undefined;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(!Array.isArray(messages)){messages=[messages];}return inverted?currentMessages.concat(messages):messages.concat(currentMessages);}}]);return BunnyChatInner;}(React.Component);BunnyChatInner.defaultProps={messages:[],messagesContainerStyle:undefined,text:undefined,placeholder:DEFAULT_PLACEHOLDER,disableComposer:false,messageIdGenerator:function messageIdGenerator(){return v4();},user:undefined,onSend:function onSend(){},locale:'',timeFormat:TIME_FORMAT,dateFormat:DATE_FORMAT,loadEarlier:false,onLoadEarlier:function onLoadEarlier(){},onMessageLoadStart:function onMessageLoadStart(){},onMessageLoadEnd:function onMessageLoadEnd(){},onMessageReadyForDisplay:function onMessageReadyForDisplay(){},onMessageLoad:function onMessageLoad(){},onMessageLoadError:function onMessageLoadError(e){},isLoadingEarlier:false,renderLoading:undefined,renderLoadEarlier:undefined,renderAvatar:undefined,showUserAvatar:false,actionSheet:undefined,onPressAvatar:undefined,onLongPressAvatar:undefined,renderUsernameOnMessage:false,renderAvatarOnTop:false,renderBubble:undefined,renderSystemMessage:undefined,onLongPress:undefined,renderMessage:undefined,renderMessageText:undefined,renderMessageImage:undefined,renderMessageSticker:undefined,renderMessageVideo:undefined,renderMessageAudio:undefined,imageProps:{},stickerProps:{},videoProps:{},audioProps:{},lightBoxProps:{},textInputProps:{},listViewProps:{},renderCustomView:undefined,isCustomViewBottom:false,renderDay:undefined,renderTime:undefined,renderFooter:undefined,renderChatEmpty:undefined,renderChatFooter:undefined,renderInputToolbar:undefined,renderComposer:undefined,renderActions:undefined,renderSend:undefined,renderAccessory:undefined,isKeyboardInternallyHandled:true,onPressActionButton:undefined,bottomOffset:undefined,minInputToolbarHeight:44,keyboardShouldPersistTaps:Platform.select({ios:'never',android:'always',default:'never'}),onInputTextChanged:undefined,maxInputLength:undefined,forceGetKeyboardHeight:false,inverted:true,extraData:undefined,minComposerHeight:MIN_COMPOSER_HEIGHT,maxComposerHeight:MAX_COMPOSER_HEIGHT,wrapInSafeArea:true,scrollToBottom:true};var makeStyles=function makeStyles(sizeLabor,themeLabor){var wp=sizeLabor.designsBasedOn.iphoneX.wp;return StyleSheet.create({container:{flex:1},safeArea:{flex:1}});};export*from\"./types\";var BunnyChat=withBunnyKit(BunnyChatInner);export{BunnyChat,Actions,ChatAvatar,Bubble,SystemMessage,MessageImage,MessageSticker,MessageText,Composer,Day,InputToolbar,LoadEarlier,Message,MessageContainer,Send,Time,BunnyAvatar,utils};","map":null,"metadata":{},"sourceType":"module"}