{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _this=this,_jsxFileName=\"/Users/revone/projects/expo-react-bunny/src/components/TreeNodePicker/TreeNodePicker.tsx\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{IcoMoon,Text,TextButton,View}from\"../UI\";import{Col,ModalFromRight,Row}from\"../../containers\";import*as React from'react';import{useEffect,useState}from'react';import{useBunnyKit}from\"../../hooks/bunny-kit\";import{getSharedStyles}from\"../../helpers\";import{makeStyles}from\"./styles\";import FlatList from\"react-native-web/dist/exports/FlatList\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import{InlineSelector}from\"../InlineSelector\";import{Searchbar}from'react-native-paper';import{firebase}from\"../../firebase/firebase\";import{useIsMounted}from\"../../hooks/is-mounted\";import{uuidV4}from\"../../utils\";export var TreeNodePicker=function TreeNodePicker(props){var _useBunnyKit=useBunnyKit(),sizeLabor=_useBunnyKit.sizeLabor,themeLabor=_useBunnyKit.themeLabor,wp=_useBunnyKit.wp;var _getSharedStyles=getSharedStyles(sizeLabor,themeLabor),sharedStyles=_getSharedStyles.sharedStyles;var styles=makeStyles(sizeLabor,themeLabor);var isMounted=useIsMounted();var _props$dataMode=props.dataMode,dataMode=_props$dataMode===void 0?'local':_props$dataMode,_onDone=props.onDone,onCancel=props.onCancel,_props$titles=props.titles,titles=_props$titles===void 0?['title0','title1','title2']:_props$titles,initialTreeNode=props.initialTreeNode,_props$data=props.data,data=_props$data===void 0?dataMode==='local'?[]:undefined:_props$data,_props$level=props.level,level=_props$level===void 0?0:_props$level,_props$childrenKeys=props.childrenKeys,childrenKeys=_props$childrenKeys===void 0?['children','children','children']:_props$childrenKeys,_props$collectionPath=props.collectionPaths,collectionPaths=_props$collectionPath===void 0?['collection0','collection1','collection1']:_props$collectionPath,_props$conditions=props.conditions,conditions=_props$conditions===void 0?dataMode==='firestore'?[['','==',''],['category','==','$code']]:undefined:_props$conditions,_props$condition=props.condition,condition=_props$condition===void 0?dataMode==='local'?undefined:['','==','']:_props$condition,_props$leafLevel=props.leafLevel,leafLevel=_props$leafLevel===void 0?1:_props$leafLevel,_props$keyExtractors=props.keyExtractors,keyExtractors=_props$keyExtractors===void 0?['id','id','id']:_props$keyExtractors,currentNodes=props.currentNodes,_props$displayFields=props.displayFields,displayFields=_props$displayFields===void 0?['name','name','name']:_props$displayFields;var _useState=useState(level!==0?currentNodes:new Array(leafLevel)),_useState2=_slicedToArray(_useState,2),currentNodesState=_useState2[0],setCurrentNodesState=_useState2[1];var _useState3=useState(data),_useState4=_slicedToArray(_useState3,2),orgData=_useState4[0],setOrgData=_useState4[1];var _useState5=useState(orgData),_useState6=_slicedToArray(_useState5,2),filterData=_useState6[0],setFilterData=_useState6[1];var _useState7=useState(undefined),_useState8=_slicedToArray(_useState7,2),children=_useState8[0],setChildren=_useState8[1];var childrenLevel=level+1;var _reset=function _reset(){};var title=titles[level];var childrenKey=childrenKeys[level];var collectionPath=collectionPaths[level];var _keyExtractor=keyExtractors[level];var displayField=displayFields[level];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),childrenCondition=_useState10[0],setChildrenCondition=_useState10[1];useEffect(function(){(function _callee(){var collectionRef,snapshot,_data;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(dataMode==='firestore'&&isMounted)){_context.next=15;break;}collectionRef=firebase.firestore().collection(collectionPath);if(!(JSON.stringify(condition)!==JSON.stringify(['','==','']))){_context.next=8;break;}_context.next=5;return _regeneratorRuntime.awrap(collectionRef.where.apply(collectionRef,_toConsumableArray(condition)).get());case 5:snapshot=_context.sent;_context.next=11;break;case 8:_context.next=10;return _regeneratorRuntime.awrap(collectionRef.get());case 10:snapshot=_context.sent;case 11:_data=[];snapshot.forEach(function(doc){_data.push(doc.data());});setOrgData(_data);setFilterData(_data);case 15:case\"end\":return _context.stop();}}},null,null,null,Promise);})();},[]);var treeNodePress=function treeNodePress(treeNode){var newState,_condition,$key,fieldPath,filterOp;return _regeneratorRuntime.async(function treeNodePress$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newState=_toConsumableArray(currentNodesState);newState[level]=treeNode;_context2.t0=dataMode;_context2.next=_context2.t0==='local'?5:_context2.t0==='firestore'?7:14;break;case 5:if(treeNode!=null&&treeNode[childrenKey]){setChildren(treeNode[childrenKey]);setIsShowChildrenModal(true);}else{setChildren(undefined);_onDone==null?void 0:_onDone(newState);}return _context2.abrupt(\"break\",14);case 7:_condition=conditions==null?void 0:conditions[childrenLevel];$key=_condition==null?void 0:_condition[2].split('$')[1];fieldPath=_condition==null?void 0:_condition[0];filterOp=_condition==null?void 0:_condition[1];setCurrentNodesState(newState);if(level===leafLevel){_onDone==null?void 0:_onDone(newState);}else{if(fieldPath&&filterOp&&$key){setChildrenCondition([fieldPath,filterOp,treeNode[$key]]);setChildren([]);setIsShowChildrenModal(true);}}return _context2.abrupt(\"break\",14);case 14:case\"end\":return _context2.stop();}}},null,null,null,Promise);};var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isShowChildrenModal=_useState12[0],setIsShowChildrenModal=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),searchQuery=_useState14[0],setSearchQuery=_useState14[1];var onChangeSearch=function onChangeSearch(searchQuery){setSearchQuery(searchQuery);};useEffect(function(){var filterData=searchQuery.trim()?orgData==null?void 0:orgData.filter(function(item){return item.name.toLowerCase().includes(searchQuery.toLowerCase());}):orgData;setFilterData(filterData);},[searchQuery]);return React.createElement(SafeAreaView,{style:[styles.container],__self:_this,__source:{fileName:_jsxFileName,lineNumber:154,columnNumber:12}},React.createElement(View,{style:styles.header,__self:_this,__source:{fileName:_jsxFileName,lineNumber:155,columnNumber:9}},React.createElement(Row,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:13}},React.createElement(Col,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:157,columnNumber:17}},React.createElement(TextButton,{onPress:function onPress(){onCancel==null?void 0:onCancel();},__self:_this,__source:{fileName:_jsxFileName,lineNumber:158,columnNumber:21}},React.createElement(IcoMoon,{name:\"x\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:160,columnNumber:24}}))),React.createElement(Col,{align:\"center\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:162,columnNumber:17}},React.createElement(Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:162,columnNumber:37}},title)),React.createElement(Col,{align:\"flex-end\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:163,columnNumber:17}},React.createElement(TextButton,{onPress:_reset,__self:_this,__source:{fileName:_jsxFileName,lineNumber:163,columnNumber:39}},React.createElement(Text,{style:sharedStyles.text2,__self:_this,__source:{fileName:_jsxFileName,lineNumber:164,columnNumber:21}},\"Reset\"))))),React.createElement(View,{style:styles.content,__self:_this,__source:{fileName:_jsxFileName,lineNumber:169,columnNumber:9}},React.createElement(View,{style:{flex:1,marginBottom:wp(10)},__self:_this,__source:{fileName:_jsxFileName,lineNumber:170,columnNumber:13}},React.createElement(KeyboardAvoidingView,{style:{flex:1,flexDirection:'column',justifyContent:'center'},behavior:\"padding\",enabled:true,keyboardVerticalOffset:wp(100),__self:_this,__source:{fileName:_jsxFileName,lineNumber:171,columnNumber:17}},React.createElement(FlatList,{style:{flex:1,marginBottom:wp(10)},data:filterData,keyExtractor:function keyExtractor(item){var _item$keyExtractor;return((_item$keyExtractor=item[_keyExtractor])==null?void 0:_item$keyExtractor.toString())||uuidV4();},initialNumToRender:2,windowSize:3,renderItem:function renderItem(_ref){var item=_ref.item;return React.createElement(InlineSelector,{textAlign:\"flex-start\",columns:[0,9,1],onPress:function _callee2(){return _regeneratorRuntime.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(treeNodePress(item));case 2:case\"end\":return _context3.stop();}}},null,null,null,Promise);},renderText:function renderText(){var _item$displayField;return(item==null?void 0:(_item$displayField=item[displayField])==null?void 0:_item$displayField.toString())||'';},isShowChevron:dataMode==='local'?!!item.children:level!==leafLevel,__self:_this,__source:{fileName:_jsxFileName,lineNumber:191,columnNumber:36}});},__self:_this,__source:{fileName:_jsxFileName,lineNumber:180,columnNumber:21}}),React.createElement(Searchbar,{placeholder:\"Search\",onChangeText:onChangeSearch,value:searchQuery,__self:_this,__source:{fileName:_jsxFileName,lineNumber:202,columnNumber:21}})),dataMode==='local'&&children||dataMode==='firestore'&&children?React.createElement(ModalFromRight,{isVisible:isShowChildrenModal,onVisibleChanged:function onVisibleChanged(isVisible){setIsShowChildrenModal(isVisible);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:208,columnNumber:27}},React.createElement(TreeNodePicker,{condition:childrenCondition,data:dataMode==='local'?children:undefined,level:childrenLevel,onDone:function onDone(result){setIsShowChildrenModal(false);_onDone==null?void 0:_onDone(result);},onCancel:function onCancel(){setIsShowChildrenModal(false);},currentNodes:currentNodesState,leafLevel:leafLevel,dataMode:dataMode,titles:titles,collectionPaths:collectionPaths,conditions:conditions,keyExtractors:keyExtractors,initialTreeNode:initialTreeNode,displayFields:displayFields,__self:_this,__source:{fileName:_jsxFileName,lineNumber:213,columnNumber:29}})):null)));};","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/components/TreeNodePicker/TreeNodePicker.tsx"],"names":["TreeNodePicker","sizeLabor","themeLabor","wp","useBunnyKit","sharedStyles","getSharedStyles","styles","makeStyles","isMounted","useIsMounted","dataMode","onDone","onCancel","titles","initialTreeNode","data","level","childrenKeys","collectionPaths","conditions","condition","leafLevel","keyExtractors","currentNodes","displayFields","props","currentNodesState","setCurrentNodesState","useState","orgData","setOrgData","filterData","setFilterData","children","setChildren","childrenLevel","_reset","title","childrenKey","collectionPath","keyExtractor","displayField","childrenCondition","setChildrenCondition","useEffect","collectionRef","firebase","JSON","snapshot","doc","treeNodePress","newState","treeNode","setIsShowChildrenModal","$key","fieldPath","filterOp","isShowChildrenModal","searchQuery","setSearchQuery","onChangeSearch","item","flex","marginBottom","flexDirection","justifyContent","uuidV4"],"mappings":"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","sourcesContent":["import {IcoMoon, Text, TextButton, View} from '../UI';\nimport {Col, ModalFromRight, Row} from '../../containers';\nimport * as React from 'react';\nimport {useEffect, useState} from 'react';\nimport {useBunnyKit} from '../../hooks/bunny-kit';\nimport {getSharedStyles} from '../../helpers';\nimport {makeStyles} from './styles';\nimport {FlatList, KeyboardAvoidingView, SafeAreaView} from 'react-native';\nimport {InlineSelector} from '../InlineSelector';\nimport {Searchbar} from 'react-native-paper';\nimport {firebase} from '../../firebase/firebase';\nimport {FieldPath, WhereFilterOp} from '@firebase/firestore-types';\nimport {useIsMounted} from '../../hooks/is-mounted';\nimport {uuidV4} from '../../utils';\nimport {TreeNodePickerNode} from '../../types';\n\ndeclare const ChildrenKey: unique symbol;\n\n\nexport type WhereArguments = [string | FieldPath, WhereFilterOp, any];\n\nexport type TreeNodePickerProps = {\n    dataMode: 'local' | 'firestore',\n    onDone?: (result?: TreeNodePickerNode[]) => void,\n    onCancel?: () => void,\n    initialTreeNode?: TreeNodePickerNode,\n    titles: string[],\n    childrenKeys?: string[],\n    data?: TreeNodePickerNode[],\n    level?: number,\n    collectionPaths?: string[],\n    conditions?: WhereArguments [],\n    condition?: WhereArguments,\n    leafLevel?: number,\n    keyExtractors: string[],\n    currentNodes?: TreeNodePickerNode[],\n    displayFields?: string[],\n}\nexport const TreeNodePicker = (props: TreeNodePickerProps) => {\n    const {sizeLabor, themeLabor, wp} = useBunnyKit();\n    const {sharedStyles} = getSharedStyles(sizeLabor, themeLabor);\n    const styles = makeStyles(sizeLabor, themeLabor);\n    const isMounted = useIsMounted();\n    const {\n        dataMode = 'local',\n        onDone,\n        onCancel,\n        titles = ['title0', 'title1', 'title2'],\n        initialTreeNode,\n        data = dataMode === 'local' ? [] as TreeNodePickerNode[] : undefined,\n        level = 0,\n        childrenKeys = ['children', 'children', 'children'],\n        collectionPaths = ['collection0', 'collection1', 'collection1'],\n        conditions = dataMode === 'firestore' ? [['', '==', ''], ['category', '==', '$code']] : undefined,\n        condition = dataMode === 'local' ? undefined : ['', '==', ''],\n        leafLevel = 1,\n        keyExtractors = ['id', 'id', 'id'],\n        currentNodes,\n        displayFields = ['name', 'name', 'name']\n    } = props;\n\n\n    const [currentNodesState, setCurrentNodesState] = useState<TreeNodePickerNode[]>(level !== 0 ? currentNodes as TreeNodePickerNode[] : new Array<TreeNodePickerNode>(leafLevel));\n    const [orgData, setOrgData] = useState(data);\n    const [filterData, setFilterData] = useState(orgData);\n    const [children, setChildren] = useState<TreeNodePickerNode[] | undefined>(undefined);\n    const childrenLevel = level + 1;\n\n    const _reset = () => {\n\n    };\n\n    const title = titles[level];\n    const childrenKey = childrenKeys[level];\n    const collectionPath = collectionPaths[level];\n    const keyExtractor = keyExtractors[level];\n    const displayField = displayFields[level];\n    const [childrenCondition, setChildrenCondition] = useState<WhereArguments>();\n    useEffect(() => {\n        (async () => {\n            if (dataMode === 'firestore' && isMounted) {\n                const collectionRef = firebase\n                    .firestore()\n                    .collection(collectionPath);\n                let snapshot;\n                if (JSON.stringify(condition) !== JSON.stringify(['', '==', ''])) {\n                    snapshot = await collectionRef\n                        .where(...condition as WhereArguments)\n                        .get();\n                } else {\n                    snapshot = await collectionRef\n                        .get();\n                }\n                let data: TreeNodePickerNode[] = [];\n                snapshot.forEach((doc) => {\n                    data.push(doc.data() as TreeNodePickerNode);\n                });\n                setOrgData(data);\n                setFilterData(data);\n            }\n        })();\n\n    }, []);\n\n    const treeNodePress = async (treeNode: TreeNodePickerNode) => {\n        // TODO when child selected,this should not be called\n        const newState: TreeNodePickerNode[] = [...currentNodesState];\n        newState[level] = treeNode;\n        switch (dataMode) {\n            case 'local':\n                if (treeNode?.[childrenKey]) {\n                    setChildren(treeNode[childrenKey]);\n                    setIsShowChildrenModal(true);\n                } else {\n                    setChildren(undefined);\n                    onDone?.(newState);\n                }\n                break;\n            case 'firestore':\n                const condition = conditions?.[childrenLevel];\n                const $key = condition?.[2].split('$')[1];\n                const fieldPath = condition?.[0];\n                const filterOp = condition?.[1];\n\n                setCurrentNodesState(newState);\n                if (level === leafLevel) {\n                    onDone?.(newState);\n                } else {\n                    if (fieldPath && filterOp && $key) {\n\n                        setChildrenCondition([fieldPath, filterOp, treeNode[$key]]);\n                        setChildren([]);\n                        setIsShowChildrenModal(true);\n                    }\n                }\n                break;\n        }\n    };\n\n    const [isShowChildrenModal, setIsShowChildrenModal] = useState(false);\n    const [searchQuery, setSearchQuery] = useState('');\n\n    const onChangeSearch = (searchQuery: string) => {\n        setSearchQuery(searchQuery);\n    };\n\n    useEffect(() => {\n        const filterData = searchQuery.trim()\n            ? orgData?.filter(item => item.name.toLowerCase().includes(searchQuery.toLowerCase()))\n            : orgData;\n        setFilterData(filterData);\n    }, [searchQuery]);\n\n    return <SafeAreaView style={[styles.container]}>\n        <View style={styles.header}>\n            <Row>\n                <Col>\n                    <TextButton onPress={() => {\n                        onCancel?.();\n                    }}><IcoMoon name=\"x\"/></TextButton>\n                </Col>\n                <Col align=\"center\"><Text>{title}</Text></Col>\n                <Col align=\"flex-end\"><TextButton onPress={_reset}>\n                    <Text style={sharedStyles.text2}>Reset</Text>\n                </TextButton>\n                </Col>\n            </Row>\n        </View>\n        <View style={styles.content}>\n            <View style={{flex: 1, marginBottom: wp(10)}}>\n                <KeyboardAvoidingView\n                    style={{\n                        flex: 1,\n                        flexDirection: 'column',\n                        justifyContent: 'center',\n                    }}\n                    behavior=\"padding\" enabled\n                    keyboardVerticalOffset={wp(100)}>\n\n                    <FlatList\n                        style={{flex: 1, marginBottom: wp(10)}}\n                        data={filterData}\n                        // TODO\n                        keyExtractor={item => {\n                            // @ts-ignore\n                            return item[keyExtractor]?.toString() || uuidV4();\n                        }}\n                        initialNumToRender={2}\n                        windowSize={3}\n                        renderItem={({item}) => {\n                            return <InlineSelector\n                                textAlign=\"flex-start\"\n                                columns={[0, 9, 1]}\n                                onPress={async () => {\n                                    await treeNodePress(item);\n                                }}\n                                renderText={() => item?.[displayField]?.toString() || ''}\n                                isShowChevron={dataMode === 'local' ? !!item.children : level !== leafLevel}\n                            />;\n                        }}\n                    />\n                    <Searchbar placeholder=\"Search\"\n                               onChangeText={onChangeSearch}\n                               value={searchQuery}/>\n                </KeyboardAvoidingView>\n                {\n                    (dataMode === 'local' && children) || (dataMode === 'firestore' && children)\n                        ? <ModalFromRight\n                            isVisible={isShowChildrenModal}\n                            onVisibleChanged={isVisible => {\n                                setIsShowChildrenModal(isVisible);\n                            }}>\n                            <TreeNodePicker\n                                condition={childrenCondition}\n                                data={dataMode === 'local' ? children : undefined}\n                                level={childrenLevel}\n\n                                onDone={(result) => {\n                                    setIsShowChildrenModal(false);\n                                    onDone?.(result);\n                                }}\n                                onCancel={() => {\n                                    setIsShowChildrenModal(false);\n                                }}\n\n                                currentNodes={currentNodesState}\n                                leafLevel={leafLevel}\n                                dataMode={dataMode}\n                                titles={titles}\n                                collectionPaths={collectionPaths}\n                                conditions={conditions}\n                                keyExtractors={keyExtractors}\n                                initialTreeNode={initialTreeNode}\n                                displayFields={displayFields}\n                            />\n                        </ModalFromRight>\n                        : null\n                }\n            </View>\n        </View>\n        {/*<View style={[styles.footer]}>*/}\n        {/*    <ButtonTO onPress={() => {*/}\n        {/*        onDone?.(treeNode)*/}\n        {/*    }}><InButtonText>Done</InButtonText></ButtonTO>*/}\n        {/*</View>*/}\n    </SafeAreaView>;\n};\n"]},"metadata":{},"sourceType":"module"}