{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{EBizLogicMsg,EDemoMap}from\"../../constants\";import{bunnyAPI}from\"../../helpers/bunny-api\";import{collectSysError,requestFailed,requesting,requestSuccess}from\"./sys\";import{collectBizLogicResult}from\"./biz-logic-result\";import{bizLogicError}from\"../../helpers\";export var restoreNearbyFilms=function restoreNearbyFilms(payload){return{type:EDemoMap.RESTORE_NEARBY_FILMS,payload:payload};};export var getNearbyFilms=function getNearbyFilms(reqParams){return function _callee(dispatch){var result,config,_await$bunnyAPI$reque,data;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={method:'GET',url:'/api/nearby-films',params:reqParams};_context.prev=1;result=dispatch(requesting(config));_context.next=5;return _regeneratorRuntime.awrap(bunnyAPI.request(config));case 5:_await$bunnyAPI$reque=_context.sent;data=_await$bunnyAPI$reque.data.data;if(data){result=dispatch(restoreNearbyFilms(data));result=dispatch(requestSuccess(config));}else{result=dispatch(collectBizLogicResult(bizLogicError(EBizLogicMsg.NO_NEARBY_FILMS)));}return _context.abrupt(\"return\",result);case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);result=dispatch(collectSysError(_context.t0));result=dispatch(requestFailed(config));return _context.abrupt(\"return\",result);case 16:case\"end\":return _context.stop();}}},null,null,[[1,11]],Promise);};};export var restoreRegion=function restoreRegion(payload){return{type:EDemoMap.RESTORE_REGION,payload:payload};};","map":{"version":3,"sources":["/Users/revone/projects/expo-react-bunny/src/store/actions/demo-map.ts"],"names":["restoreNearbyFilms","type","EDemoMap","payload","getNearbyFilms","config","method","url","params","reqParams","result","dispatch","requesting","data","bunnyAPI","requestSuccess","collectBizLogicResult","bizLogicError","EBizLogicMsg","collectSysError","requestFailed","restoreRegion"],"mappings":"4DAEA,OAAA,YAAA,CAAA,QAAA,uBAeA,OAAA,QAAA,+BACA,OAAA,eAAA,CAAA,aAAA,CAAA,UAAA,CAAA,cAAA,aACA,OAAA,qBAAA,0BACA,OAAA,aAAA,qBAEA,MAAO,IAAMA,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAA,OAAA,CAAqD,CACnF,MAAO,CACHC,IAAI,CAAEC,QAAQ,CADX,oBAAA,CAEHC,OAAO,CAAPA,OAFG,CAAP,CADG,CAAA,CAOP,MAAO,IAAMC,CAAAA,cAAyG,CAAG,QAA5GA,CAAAA,cAA4G,CAAA,SAAA,CAAwC,CAC7J,MAAO,SAAA,CAAA,OAAA,CAAA,QAAA,CAAA,CAAA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,qBAAA,CAAA,IAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAAA,QAAA,CAAA,QAAA,CAAA,QAAA,CAAA,CAAA,MAAA,CAAA,CAAA,CAAA,OAAA,QAAA,CAAA,IAAA,CAAA,QAAA,CAAA,IAAA,EAAA,IAAA,EAAA,CAEGC,MAFH,CAE2B,CAACC,MAAM,CAAP,KAAA,CAAgBC,GAAG,CAAnB,mBAAA,CAA0CC,MAAM,CAAEC,SAAlD,CAAxBJ,CAFH,QAAA,CAAA,IAAA,CAAA,CAAA,CAICK,MAAM,CAAGC,QAAQ,CAACC,UAAU,CAA5BF,MAA4B,CAAX,CAAjBA,CAJD,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,mBAAA,CAAA,KAAA,CAK8BI,QAAQ,CAARA,OAAAA,CAL9B,MAK8BA,CAL9B,CAAA,CAAA,IAAA,EAAA,CAAA,qBAAA,CAAA,QAAA,CAAA,IAAA,CAKeD,IALf,CAAA,qBAAA,CAAA,IAAA,CAAA,IAKeA,CACd,GAAA,IAAA,CAAU,CACNH,MAAM,CAAGC,QAAQ,CAACX,kBAAkB,CAApCU,IAAoC,CAAnB,CAAjBA,CACAA,MAAM,CAAGC,QAAQ,CAACI,cAAc,CAAhCL,MAAgC,CAAf,CAAjBA,CAFJ,CAAA,IAGO,CACHA,MAAM,CAAGC,QAAQ,CAACK,qBAAqB,CAACC,aAAa,CAACC,YAAY,CAAlER,eAAqD,CAAd,CAAtB,CAAjBA,CACH,CAXF,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,CAAA,IAAA,GAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,QAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAcCA,MAAM,CAAGC,QAAQ,CAACQ,eAAe,CAAA,QAAA,CAAjCT,EAAiC,CAAhB,CAAjBA,CACAA,MAAM,CAAGC,QAAQ,CAACS,aAAa,CAA/BV,MAA+B,CAAd,CAAjBA,CAfD,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,CAAA,IAAA,GAAA,CAAA,IAAA,KAAA,CAAA,MAAA,CAAA,QAAA,CAAA,IAAA,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,OAAA,CAAA,CAAP,CAAA,CADG,CAAA,CAsBP,MAAO,IAAMW,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAA,OAAA,CAA0C,CACnE,MAAO,CACHpB,IAAI,CAAEC,QAAQ,CADX,cAAA,CAEHC,OAAO,CAAPA,OAFG,CAAP,CADG,CAAA","sourcesContent":["import {Action, ActionCreator, Dispatch} from 'redux';\nimport {ThunkAction} from 'redux-thunk';\nimport {EBizLogicMsg, EDemoMap} from '../../constants';\nimport {\n    CollectBizLogicResultAction,\n    DemoMapState,\n    GetNearbyFilmsReqParams,\n    NearbyFilm,\n    Region,\n    RequestConfig,\n    RequestFailedAction,\n    RequestingAction,\n    RequestSuccessAction,\n    RestoreNearbyFilmsAction,\n    RestoreRegionAction,\n    SysErrorAction\n} from '../../types';\nimport {bunnyAPI} from '../../helpers/bunny-api';\nimport {collectSysError, requestFailed, requesting, requestSuccess} from './sys';\nimport {collectBizLogicResult} from './biz-logic-result';\nimport {bizLogicError} from '../../helpers';\n\nexport const restoreNearbyFilms = (payload: NearbyFilm[]): RestoreNearbyFilmsAction => {\n    return {\n        type: EDemoMap.RESTORE_NEARBY_FILMS,\n        payload\n    };\n};\n\nexport const getNearbyFilms: ActionCreator<ThunkAction<Promise<Action>, DemoMapState, void, RestoreNearbyFilmsAction>> = (reqParams: GetNearbyFilmsReqParams) => {\n    return async (dispatch: Dispatch<RestoreNearbyFilmsAction | SysErrorAction | CollectBizLogicResultAction | RequestingAction | RequestSuccessAction | RequestFailedAction>): Promise<Action> => {\n        let result;\n        const config: RequestConfig = {method: 'GET', url: '/api/nearby-films', params: reqParams};\n        try {\n            result = dispatch(requesting(config));\n            const {data: {data}} = await bunnyAPI.request(config);\n            if (data) {\n                result = dispatch(restoreNearbyFilms(data));\n                result = dispatch(requestSuccess(config));\n            } else {\n                result = dispatch(collectBizLogicResult(bizLogicError(EBizLogicMsg.NO_NEARBY_FILMS)));\n            }\n            return result;\n        } catch (e: any) {\n            result = dispatch(collectSysError(e));\n            result = dispatch(requestFailed(config));\n            return result;\n        }\n    };\n};\n\nexport const restoreRegion = (payload: Region): RestoreRegionAction => {\n    return {\n        type: EDemoMap.RESTORE_REGION,\n        payload\n    };\n};\n\nexport type DemoMapActions = RestoreNearbyFilmsAction | RestoreRegionAction;\n"]},"metadata":{},"sourceType":"module"}