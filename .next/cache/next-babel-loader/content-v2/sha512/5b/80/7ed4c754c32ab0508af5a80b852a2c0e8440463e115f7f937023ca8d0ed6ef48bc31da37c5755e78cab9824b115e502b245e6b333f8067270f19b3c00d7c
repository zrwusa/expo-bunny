{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import axios from'axios';import{authLaborContext}from\"../providers/auth-labor\";import{getApiInstanceConfig}from\"./helpers\";import{checkBunnyAPIProtocol}from\"./api-protocols\";export var bunnyAPI=axios.create(getApiInstanceConfig('bunny'));bunnyAPI.interceptors.request.use(function _callee(config){var _await$authLaborConte,accessToken;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config.headers['Content-Type']='application/json';_context.next=3;return _regeneratorRuntime.awrap(authLaborContext.authFunctions.getPersistenceAuth());case 3:_await$authLaborConte=_context.sent;accessToken=_await$authLaborConte.accessToken;if(accessToken){config.headers['Authorization']=\"Bearer \"+accessToken;}return _context.abrupt(\"return\",config);case 7:case\"end\":return _context.stop();}}},null,null,null,Promise);},function _callee2(error){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",Promise.reject(error));case 1:case\"end\":return _context2.stop();}}},null,null,null,Promise);});bunnyAPI.interceptors.response.use(function(response){checkBunnyAPIProtocol(response.data);return response;},function _callee3(error){var response,request,config,status,data,business_logic,error_code,authFunctions,bunnyRefreshAuth,logOut,_await$bunnyRefreshAu,success,originalRequest;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:response=error.response,request=error.request,config=error.config;if(!response){_context3.next=38;break;}status=response.status,data=response.data;_context3.t0=status;_context3.next=_context3.t0===401?6:_context3.t0===500?32:33;break;case 6:business_logic=data.business_logic;error_code=business_logic.error_code;if(!['01_001_B_002','01_001_B_003','01_001_B_004','01_001_B_005','01_001_B_012'].includes(error_code)){_context3.next=31;break;}authFunctions=authLaborContext.authFunctions;bunnyRefreshAuth=authFunctions.bunnyRefreshAuth,logOut=authFunctions.logOut;_context3.prev=11;_context3.next=14;return _regeneratorRuntime.awrap(bunnyRefreshAuth());case 14:_await$bunnyRefreshAu=_context3.sent;success=_await$bunnyRefreshAu.success;if(success){_context3.next=21;break;}_context3.next=19;return _regeneratorRuntime.awrap(logOut('API'));case 19:_context3.next=24;break;case 21:originalRequest=config;originalRequest._retry=true;return _context3.abrupt(\"return\",bunnyAPI(originalRequest));case 24:_context3.next=31;break;case 26:_context3.prev=26;_context3.t1=_context3[\"catch\"](11);_context3.next=30;return _regeneratorRuntime.awrap(logOut('API'));case 30:throw _context3.t1;case 31:return _context3.abrupt(\"break\",34);case 32:throw error;case 33:return _context3.abrupt(\"break\",34);case 34:checkBunnyAPIProtocol(response.data);return _context3.abrupt(\"return\",response);case 38:if(!request){_context3.next=42;break;}throw error;case 42:throw error;case 43:case\"end\":return _context3.stop();}}},null,null,[[11,26]],Promise);});export default bunnyAPI;","map":null,"metadata":{},"sourceType":"module"}