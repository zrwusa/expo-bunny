{"ast":null,"code":"\"use strict\";var _interopRequireDefault2=require(\"@babel/runtime/helpers/interopRequireDefault\");var _regenerator=_interopRequireDefault2(require(\"@babel/runtime/regenerator\"));var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _router=_interopRequireDefault(require(\"next/router\"));var _onDemandEntriesUtils=require(\"./on-demand-entries-utils\");var _default=function _default(_ref){var assetPrefix;return _regenerator.default.async(function _default$(_context){while(1){switch(_context.prev=_context.next){case 0:assetPrefix=_ref.assetPrefix;_router.default.ready(function(){_router.default.events.on('routeChangeComplete',_onDemandEntriesUtils.setupPing.bind(void 0,assetPrefix,function(){return _router.default.pathname;}));});(0,_onDemandEntriesUtils.setupPing)(assetPrefix,function(){return _router.default.pathname;},_onDemandEntriesUtils.currentPage);if(!process.env.__NEXT_TEST_MODE){document.addEventListener('visibilitychange',function(_event){var state=document.visibilityState;if(state==='visible'){(0,_onDemandEntriesUtils.setupPing)(assetPrefix,function(){return _router.default.pathname;},true);}else{(0,_onDemandEntriesUtils.closePing)();}});window.addEventListener('beforeunload',function(){(0,_onDemandEntriesUtils.closePing)();});}case 4:case\"end\":return _context.stop();}}},null,null,null,Promise);};exports.default=_default;","map":{"version":3,"sources":["../../../client/dev/on-demand-entries-client.js"],"names":["Router","setupPing","currentPage","process","document","_event","state","window"],"mappings":"mTAAA,GAAA,CAAA,OAAA,CAAA,sBAAA,CAAA,OAAA,CAAA,aAAA,CAAA,CAAA,CACA,GAAA,CAAA,qBAAA,CAAA,OAAA,6BAAA,C,aAEe,Q,SAAA,0IAAA,WAAA,MAAA,WAAA,CACbA,OAAAA,CAAAA,OAAAA,CAAAA,KAAAA,CAAa,UAAM,CACjBA,OAAAA,CAAAA,OAAAA,CAAAA,MAAAA,CAAAA,EAAAA,CAAAA,qBAAAA,CAEEC,qBAAAA,CAAAA,SAAAA,CAAAA,IAAAA,CAAAA,IAAAA,EAAAA,CAAAA,WAAAA,CAAkC,iBAAMD,CAAAA,OAAAA,CAAAA,OAAAA,CAF1CA,QAEoC,EAAlCC,CAFFD,EADFA,CAAAA,EAOA,CAAA,EAAA,qBAAA,CAAA,SAAA,EAAA,WAAA,CAAuB,iBAAMA,CAAAA,OAAAA,CAAAA,OAAAA,CAA7B,QAAuB,EAAvB,CAA8CE,qBAAAA,CAA9C,WAAA,EAGA,GAAI,CAACC,OAAO,CAAPA,GAAAA,CAAL,gBAAA,CAAmC,CACjCC,QAAQ,CAARA,gBAAAA,CAAAA,kBAAAA,CAA+CC,SAAAA,MAAD,CAAY,CACxD,GAAMC,CAAAA,KAAK,CAAGF,QAAQ,CAAtB,eAAA,CACA,GAAIE,KAAK,GAAT,SAAA,CAAyB,CACvB,CAAA,EAAA,qBAAA,CAAA,SAAA,EAAA,WAAA,CAAuB,iBAAMN,CAAAA,OAAAA,CAAAA,OAAAA,CAA7B,QAAuB,EAAvB,CAAA,IAAA,EADF,CAAA,IAEO,CACL,CAAA,EAAA,qBAAA,CAAA,SAAA,IAEH,CAPDI,CAAAA,EASAG,MAAM,CAANA,gBAAAA,CAAAA,cAAAA,CAAwC,UAAM,CAC5C,CAAA,EAAA,qBAAA,CAAA,SAAA,IADFA,CAAAA,EAIH,CAzBc,qE","sourcesContent":["import Router from 'next/router'\nimport { setupPing, currentPage, closePing } from './on-demand-entries-utils'\n\nexport default async ({ assetPrefix }) => {\n  Router.ready(() => {\n    Router.events.on(\n      'routeChangeComplete',\n      setupPing.bind(this, assetPrefix, () => Router.pathname)\n    )\n  })\n\n  setupPing(assetPrefix, () => Router.pathname, currentPage)\n\n  // prevent HMR connection from being closed when running tests\n  if (!process.env.__NEXT_TEST_MODE) {\n    document.addEventListener('visibilitychange', (_event) => {\n      const state = document.visibilityState\n      if (state === 'visible') {\n        setupPing(assetPrefix, () => Router.pathname, true)\n      } else {\n        closePing()\n      }\n    })\n\n    window.addEventListener('beforeunload', () => {\n      closePing()\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"script"}